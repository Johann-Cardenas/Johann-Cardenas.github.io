<!DOCTYPE HTML>
<html>
<head>
    <script>
        (function() {
            // Frontier app defaults to dark mode
            var theme = localStorage.getItem('frontier-theme') || 'dark';
            document.documentElement.setAttribute('data-theme', theme);
            // Ensure the global theme-toggle.js respects the app default
            localStorage.setItem('theme-preference', theme);
        })();
    </script>
    <title>Frontier | HPC Intuition Engine</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Social Sharing: Open Graph (for LinkedIn, Facebook, etc.) -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Frontier | HPC Intuition Engine">
    <meta property="og:description" content="Frontier is a high-performance scientific visualization and analysis platform designed for advanced engineering research.">
    <meta property="og:image" content="https://johann-cardenas.github.io/images/e-labs/Frontier_Preview.jpg">
    <meta property="og:url" content="https://johann-cardenas.github.io/e-labs/frontier/index.html">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Frontier | HPC Intuition Engine">
    <meta name="twitter:description" content="Frontier is a high-performance scientific visualization and analysis platform designed for advanced engineering research.">
    <meta name="twitter:image" content="https://johann-cardenas.github.io/images/e-labs/Frontier_Preview.jpg">

    <link rel="stylesheet" href="../../assets/css/main.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        /* ==================== THEME VARIABLES ==================== */
        :root {
            --frontier-primary: #18a9a8;
            --frontier-primary-hover: #14908f;
            --frontier-primary-glow: rgba(24, 169, 168, 0.3);
            --frontier-secondary: #d52349;
            --frontier-secondary-hover: #b91d3f;
            --frontier-accent: #f59e0b;
            --frontier-success: #10b981;
            --frontier-warning: #f59e0b;
            --frontier-danger: #ef4444;
            --frontier-info: #3b82f6;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        [data-theme="light"] {
            --frontier-bg: #ffffff;
            --frontier-bg-alt: #f8fafc;
            --frontier-bg-panel: #f1f5f9;
            --frontier-bg-dark: #0f172a;
            --frontier-text: #1e293b;
            --frontier-text-secondary: #64748b;
            --frontier-text-muted: #94a3b8;
            --frontier-border: #e2e8f0;
            --frontier-border-dark: #cbd5e1;
            --frontier-card-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }

        [data-theme="dark"] {
            --frontier-bg: #111827;
            --frontier-bg-alt: #0f172a;
            --frontier-bg-panel: #1e293b;
            --frontier-bg-dark: #0f172a;
            --frontier-text: #f1f5f9;
            --frontier-text-secondary: #cbd5e1;
            --frontier-text-muted: #94a3b8;
            --frontier-border: #334155;
            --frontier-border-dark: #475569;
            --frontier-card-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
        }

        /* ==================== SMOOTH SCROLL & CUSTOM SCROLLBAR ==================== */
        html {
            scroll-behavior: smooth;
        }

        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--frontier-bg-alt);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--frontier-primary), var(--frontier-primary-hover));
            border-radius: 5px;
            border: 2px solid var(--frontier-bg-alt);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--frontier-primary-hover), var(--frontier-secondary));
        }

        ::-webkit-scrollbar-corner {
            background: var(--frontier-bg-alt);
        }

        /* Firefox scrollbar */
        * {
            scrollbar-width: thin;
            scrollbar-color: var(--frontier-primary) var(--frontier-bg-alt);
        }

        /* ==================== GLOBAL ANIMATIONS ==================== */
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px var(--frontier-primary-glow), 0 0 10px transparent; }
            50% { box-shadow: 0 0 20px var(--frontier-primary-glow), 0 0 40px var(--frontier-primary-glow); }
        }

        @keyframes ripple {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }

        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(24, 169, 168, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 15px rgba(24, 169, 168, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(24, 169, 168, 0); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-15px); }
            60% { transform: translateY(-7px); }
        }

        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* ==================== GLASSMORPHISM UTILITIES ==================== */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .glass-strong {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        /* ==================== ENHANCED HOVER EFFECTS ==================== */
        .hover-lift {
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .hover-glow:hover {
            box-shadow: 0 0 30px var(--frontier-primary-glow);
        }

        /* ==================== LOADING SPINNER ==================== */
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--frontier-primary);
            border-radius: 50%;
            animation: rotate 0.8s linear infinite;
        }

        .spinner-small {
            width: 20px;
            height: 20px;
            border-width: 2px;
        }

        .spinner-dual {
            width: 40px;
            height: 40px;
            border: 3px solid transparent;
            border-top-color: var(--frontier-primary);
            border-bottom-color: var(--frontier-secondary);
            border-radius: 50%;
            animation: rotate 0.8s linear infinite;
        }

        /* ==================== GRADIENT TEXT ==================== */
        .gradient-text {
            background: linear-gradient(135deg, var(--frontier-primary), var(--frontier-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ==================== CARD SHADOWS ==================== */
        .shadow-soft {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .shadow-medium {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .shadow-strong {
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
        }

        /* ==================== FOCUS STATES FOR ACCESSIBILITY ==================== */
        :focus-visible {
            outline: 2px solid var(--frontier-primary);
            outline-offset: 3px;
        }

        button:focus-visible,
        .btn:focus-visible,
        .module-tab:focus-visible {
            outline: 2px solid var(--frontier-primary);
            outline-offset: 3px;
            box-shadow: 0 0 0 4px var(--frontier-primary-glow);
        }

        input:focus-visible,
        select:focus-visible {
            outline: none;
            border-color: var(--frontier-primary);
            box-shadow: 0 0 0 3px var(--frontier-primary-glow);
        }

        /* Skip to content link for screen readers */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--frontier-primary);
            color: white;
            padding: 8px 16px;
            z-index: 100;
            transition: top 0.3s ease;
            border-radius: 0 0 8px 0;
        }

        .skip-link:focus {
            top: 0;
        }

        * {
            box-sizing: border-box;
        }

        html, body {
            margin: 0 !important;
            padding: 0 !important;
        }

        body {
            font-family: 'Source Sans Pro', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* Override main.css wrapper padding */
        #wrapper, #main, .wrapper, main {
            padding-top: 0 !important;
            margin-top: 0 !important;
        }
        #header, section#header { display: none !important; }
        #titleBar { background: transparent !important; }
        #titleBar .toggle { display: none !important; }
        #navPanel { display: none !important; }

        /* ==================== APP CONTAINER ==================== */
        .frontier-app {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem 2rem 2rem;
            background: var(--frontier-bg);
            min-height: 100vh;
        }

        /* ==================== HEADER ==================== */
        .app-header {
            margin-bottom: 2rem;
            background: linear-gradient(135deg, var(--frontier-bg-dark) 0%, #1e3a5f 50%, #0d2847 100%);
            border-radius: 24px;
            color: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .app-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, var(--frontier-primary-glow) 0%, transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(213, 35, 73, 0.2) 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, rgba(24, 169, 168, 0.1) 0%, transparent 60%);
            pointer-events: none;
            animation: headerGlow 8s ease-in-out infinite alternate;
        }

        @keyframes headerGlow {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }

        /* Animated particles in header */
        .app-header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.3), transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.2), transparent),
                radial-gradient(2px 2px at 50px 120px, rgba(255,255,255,0.3), transparent),
                radial-gradient(2px 2px at 100px 20px, rgba(255,255,255,0.2), transparent),
                radial-gradient(2px 2px at 150px 80px, rgba(255,255,255,0.3), transparent),
                radial-gradient(2px 2px at 200px 40px, rgba(255,255,255,0.2), transparent),
                radial-gradient(3px 3px at 250px 100px, var(--frontier-primary), transparent),
                radial-gradient(2px 2px at 300px 50px, rgba(255,255,255,0.3), transparent),
                radial-gradient(2px 2px at 350px 90px, rgba(255,255,255,0.2), transparent),
                radial-gradient(3px 3px at 400px 30px, var(--frontier-primary), transparent);
            background-size: 450px 150px;
            animation: particles 20s linear infinite;
            pointer-events: none;
        }

        @keyframes particles {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(-450px) translateY(0); }
        }

        .header-nav {
            padding: 1rem 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-badges {
            display: flex; align-items: center; gap: 0.5rem;
            margin-left: auto;
        }
        .header-badge {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.15);
            padding: 0.35rem 0.75rem; border-radius: 8px;
            font-size: 0.78rem; font-weight: 600;
            color: rgba(255,255,255,0.75);
            letter-spacing: 0.03em;
        }
        .header-badge i { margin-right: 0.3rem; font-size: 0.72rem; }

        .back-btn {
            background: rgba(24, 169, 168, 0.2);
            border: 1px solid rgba(24, 169, 168, 0.4);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            text-decoration: none;
            font-weight: 500;
        }

        .back-btn:hover {
            background: rgba(24, 169, 168, 0.35);
            border-color: rgba(24, 169, 168, 0.6);
            transform: translateX(-3px);
            box-shadow: 0 4px 15px rgba(24, 169, 168, 0.25);
        }

        .back-btn i {
            transition: transform 0.3s ease;
        }

        .back-btn:hover i {
            transform: translateX(-3px);
        }

        .header-content {
            text-align: center;
            padding: 1.5rem 2rem 1.75rem;
            position: relative;
            z-index: 1;
        }

        .app-header h1 {
            font-size: 3rem;
            margin: 0 0 0.5rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            font-weight: 800;
            color: white !important;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
            animation: slideInUp 0.8s ease;
        }

        .app-header h1 .frontier-icon {
            color: var(--frontier-primary) !important;
            font-size: 2.2rem;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px var(--frontier-primary-glow));
        }

        .app-header h1 .highlight {
            background: linear-gradient(135deg, var(--frontier-primary), var(--frontier-info));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            padding-bottom: 0.05em;
            line-height: 1.15;
            display: inline-block;
        }

        .app-header p {
            font-size: 1.15rem;
            opacity: 0.9;
            margin: 0;
            color: white !important;
            font-weight: 300;
            letter-spacing: 0.5px;
            animation: slideInUp 0.8s ease 0.1s both;
        }

        /* HPC Suggestions Callout */
        .hpc-suggestions {
            margin-top: 1.75rem;
            padding: 1.75rem;
            background: linear-gradient(135deg, rgba(24, 169, 168, 0.12) 0%, rgba(59, 130, 246, 0.12) 100%);
            border: 1px solid rgba(24, 169, 168, 0.35);
            border-radius: 16px;
            display: none;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .hpc-suggestions::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--frontier-primary), var(--frontier-info), var(--frontier-primary));
            background-size: 200% 100%;
            animation: shimmer 3s linear infinite;
        }

        .hpc-suggestions.visible {
            display: block;
            animation: fadeSlideIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .hpc-suggestions-title {
            color: var(--frontier-primary);
            font-weight: 700;
            font-size: 1.15rem;
            margin: 0 0 1.25rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .hpc-suggestions-title i {
            font-size: 1.05rem;
            animation: float 3s ease-in-out infinite;
        }

        .suggestion-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .suggestion-list li {
            padding: 0.85rem 1.25rem;
            margin-bottom: 0.5rem;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            color: white;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            text-align: center;
        }

        .suggestion-list li span {
            max-width: 42em;
            line-height: 1.4;
        }

        .suggestion-list li:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .suggestion-list li:last-child {
            margin-bottom: 0;
        }

        .suggestion-list li i {
            color: var(--frontier-accent);
            flex-shrink: 0;
            font-size: 0.9rem;
            transition: transform 0.3s ease;
        }

        .suggestion-list li:hover i {
            transform: scale(1.08);
        }

        .suggestion-list li.good {
            border-left-color: var(--frontier-success);
        }

        .suggestion-list li.good i {
            color: var(--frontier-success);
        }

        .suggestion-list li.warning {
            border-left-color: var(--frontier-warning);
        }

        .suggestion-list li.warning i {
            color: var(--frontier-warning);
        }

        .suggestion-list li.tip {
            border-left-color: var(--frontier-info);
        }

        .suggestion-list li.tip i {
            color: var(--frontier-info);
        }

        /* ==================== MODULE TABS ==================== */
        .module-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
            animation: slideInUp 0.8s ease 0.2s both;
        }

        .module-tab {
            flex: 1;
            min-width: 280px;
            max-width: 400px;
            padding: 1.5rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            align-items: center;
            gap: 1rem;
            background: var(--frontier-bg-panel);
            border: 2px solid var(--frontier-border);
            position: relative;
            overflow: hidden;
        }

        .module-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .module-tab:hover::before {
            left: 100%;
        }

        .module-tab:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 20px 40px var(--frontier-primary-glow);
            border-color: var(--frontier-primary);
        }

        .module-tab.active {
            border-color: var(--frontier-primary);
            box-shadow: 0 15px 35px var(--frontier-primary-glow);
            background: linear-gradient(135deg, var(--frontier-bg-panel), rgba(24, 169, 168, 0.15));
        }

        .module-tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--frontier-primary), var(--frontier-info));
        }

        .module-tab .icon {
            width: 65px;
            height: 65px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            flex-shrink: 0;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

        .module-tab:hover .icon {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .module-tab:nth-child(1) .icon { 
            background: linear-gradient(135deg, #8b5cf6, #6d28d9); 
            box-shadow: 0 8px 20px rgba(139, 92, 246, 0.3);
        }
        .module-tab:nth-child(2) .icon { 
            background: linear-gradient(135deg, var(--frontier-primary), #0d7377); 
            box-shadow: 0 8px 20px rgba(24, 169, 168, 0.3);
        }
        .module-tab:nth-child(3) .icon { 
            background: linear-gradient(135deg, var(--frontier-secondary), #a01b3a); 
            box-shadow: 0 8px 20px rgba(213, 35, 73, 0.3);
        }
        .module-tab:nth-child(4) .icon { 
            background: linear-gradient(135deg, var(--frontier-accent), #d97706); 
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.3);
        }

        .module-tab .info h3 {
            margin: 0 0 0.35rem 0;
            font-size: 1.2rem;
            color: var(--frontier-text);
            font-weight: 700;
            transition: color 0.3s ease;
        }

        .module-tab:hover .info h3 {
            color: var(--frontier-primary);
        }

        .module-tab .info p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--frontier-text-secondary);
            transition: color 0.3s ease;
        }

        /* ==================== MODULE CONTENT ==================== */
        .module-content {
            display: none;
            opacity: 0;
        }

        .module-content.active {
            display: block;
            opacity: 1;
            animation: moduleReveal 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes moduleReveal {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.98); 
                filter: blur(3px);
            }
            50% {
                filter: blur(0);
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
                filter: blur(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ==================== PANELS ==================== */
        .panel {
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            background: var(--frontier-bg-panel);
            border: 1px solid var(--frontier-border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--frontier-primary), var(--frontier-info), var(--frontier-primary));
            background-size: 200% 100%;
            animation: shimmer 3s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .panel:hover::before {
            opacity: 1;
        }

        .panel h2 {
            margin: 0 0 1.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            color: var(--frontier-text);
            font-weight: 700;
        }

        .panel h2 i {
            color: var(--frontier-primary);
            transition: transform 0.3s ease;
        }

        .panel:hover h2 i {
            transform: scale(1.1);
        }

        /* ==================== CONTROLS ==================== */
        .control-group {
            margin-bottom: 1.75rem;
        }

        .control-group label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.6rem;
            font-weight: 600;
            color: var(--frontier-text);
        }

        .control-group .value {
            background: linear-gradient(135deg, var(--frontier-primary), #0d7377);
            color: white;
            padding: 0.3rem 0.9rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
            box-shadow: 0 4px 10px var(--frontier-primary-glow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .control-group .value:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 15px var(--frontier-primary-glow);
        }

        input[type="range"] {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: var(--frontier-border-dark);
            outline: none;
            -webkit-appearance: none;
            transition: background 0.3s ease;
        }

        input[type="range"]:hover {
            background: var(--frontier-border);
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--frontier-primary), #14908f);
            cursor: pointer;
            box-shadow: 0 4px 15px var(--frontier-primary-glow);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s ease;
            border: 3px solid white;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 20px var(--frontier-primary-glow);
        }

        input[type="range"]:active::-webkit-slider-thumb {
            transform: scale(1.1);
        }

        /* ==================== BUTTONS ==================== */
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 14px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            font-family: inherit;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn i {
            transition: transform 0.3s ease;
        }

        .btn:hover i {
            transform: scale(1.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--frontier-primary), #0d7377);
            color: white;
            box-shadow: 0 8px 25px var(--frontier-primary-glow);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 35px var(--frontier-primary-glow);
        }

        .btn-primary:active:not(:disabled) {
            transform: translateY(-1px) scale(0.98);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--frontier-danger), #dc2626);
            color: white;
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 35px rgba(239, 68, 68, 0.4);
        }

        .btn-secondary {
            background: var(--frontier-border-dark);
            color: var(--frontier-text);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary:hover {
            background: var(--frontier-text-muted);
            transform: translateY(-2px);
        }

        .btn-group {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        /* ==================== MODULE 1: HPC WORKFLOW - FACTORY STYLE ==================== */
        .workflow-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 1024px) {
            .workflow-container {
                grid-template-columns: 340px 1fr;
            }
        }

        /* Factory Visualization */
        .factory-viz {
            background: linear-gradient(180deg, var(--frontier-bg-dark) 0%, #0a1628 100%);
            border-radius: 20px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            min-height: 700px;
            box-shadow: inset 0 2px 20px rgba(0, 0, 0, 0.3);
        }

        .factory-viz::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at 50% 0%, rgba(24, 169, 168, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 100%, rgba(213, 35, 73, 0.05) 0%, transparent 50%);
            pointer-events: none;
        }

        .factory-title {
            color: white;
            font-size: 1.1rem;
            margin: 0 0 1.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }

        .factory-title i {
            color: var(--frontier-primary);
        }

        .factory-desc {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.85rem;
            line-height: 1.6;
            margin: -0.75rem 0 1.5rem;
            max-width: 680px;
            position: relative;
            z-index: 1;
        }
        .factory-desc strong {
            color: var(--frontier-primary);
        }

        /* Job-config panel description */
        .wf-panel-desc {
            color: var(--frontier-text-muted);
            font-size: 0.82rem;
            line-height: 1.55;
            margin: -0.25rem 0 1rem;
        }
        .wf-panel-desc i {
            color: var(--frontier-primary);
        }

        /* Light-mode overrides */
        [data-theme="light"] .factory-desc {
            color: rgba(30, 41, 59, 0.7);
        }
        [data-theme="light"] .factory-desc strong {
            color: #0f766e;
        }

        /* Overall Workflow Progress Bar */
        .wf-progress {
            position: relative;
            z-index: 1;
            margin-bottom: 1.25rem;
            padding: 0 0.25rem;
        }
        .wf-progress-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.4rem;
        }
        .wf-progress-label {
            color: rgba(255, 255, 255, 0.55);
            font-size: 0.78rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        .wf-progress.running .wf-progress-label {
            color: var(--frontier-primary);
        }
        .wf-progress.done .wf-progress-label {
            color: var(--frontier-success);
        }
        .wf-progress.aborted .wf-progress-label {
            color: var(--frontier-danger);
        }
        .wf-progress-pct {
            color: rgba(255, 255, 255, 0.4);
            font-size: 0.72rem;
            font-weight: 600;
            font-variant-numeric: tabular-nums;
            transition: color 0.3s ease;
        }
        .wf-progress.running .wf-progress-pct {
            color: rgba(255, 255, 255, 0.7);
        }
        .wf-progress-track {
            height: 6px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 4px;
            overflow: hidden;
        }
        .wf-progress-fill {
            height: 100%;
            width: 0%;
            border-radius: 4px;
            background: linear-gradient(90deg, var(--frontier-primary), #3b82f6);
            transition: width 0.5s cubic-bezier(0.25, 1, 0.5, 1);
            position: relative;
        }
        .wf-progress-fill::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent);
            animation: shimmer 2s linear infinite;
        }
        .wf-progress.done .wf-progress-fill {
            background: linear-gradient(90deg, var(--frontier-success), #34d399);
        }
        .wf-progress.aborted .wf-progress-fill {
            background: linear-gradient(90deg, var(--frontier-danger), #f87171);
        }
        .wf-progress-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 0.35rem;
        }
        .wf-progress-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.12);
            transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
        }
        .wf-progress-dot.reached {
            background: var(--frontier-primary);
            transform: scale(1.3);
            box-shadow: 0 0 6px var(--frontier-primary-glow);
        }
        .wf-progress.done .wf-progress-dot.reached {
            background: var(--frontier-success);
            box-shadow: 0 0 6px rgba(16, 185, 129, 0.4);
        }
        /* Light-mode */
        [data-theme="light"] .wf-progress-label { color: rgba(30, 41, 59, 0.5); }
        [data-theme="light"] .wf-progress.running .wf-progress-label { color: #0f766e; }
        [data-theme="light"] .wf-progress-pct { color: rgba(30, 41, 59, 0.4); }
        [data-theme="light"] .wf-progress-track { background: rgba(0, 0, 0, 0.08); }
        [data-theme="light"] .wf-progress-dot { background: rgba(0, 0, 0, 0.1); }

        /* Conveyor Belt System */
        .conveyor-system {
            position: relative;
            height: 500px;
            margin-bottom: 1.5rem;
        }

        .conveyor-station {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .station-icon {
            width: 75px;
            height: 75px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.9rem;
            color: white;
            position: relative;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 2;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .station-icon.waiting {
            background: linear-gradient(135deg, #475569, #334155);
        }

        .station-icon.active {
            animation: stationPulse 1s ease infinite;
            box-shadow: 0 0 30px var(--frontier-primary-glow);
        }

        .station-icon.completed {
            background: linear-gradient(135deg, var(--frontier-success), #059669) !important;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        @keyframes stationPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px var(--frontier-primary-glow); }
            50% { transform: scale(1.08); box-shadow: 0 0 35px var(--frontier-primary-glow); }
        }

        .station-label {
            color: white;
            font-size: 0.9rem;
            margin-top: 0.4rem;
            margin-bottom: 0;
            text-align: center;
            font-weight: 600;
            max-width: 100px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            line-height: 1.2;
        }

        .station-status {
            color: var(--frontier-text-muted);
            font-size: 0.7rem;
            margin-top: 0.15rem;
            transition: all 0.3s ease;
            line-height: 1;
        }

        .station-status.active {
            color: var(--frontier-primary);
            animation: blink 1s ease infinite;
        }

        /* Conveyor Belts (SVG paths) */
        .conveyor-paths {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .conveyor-path {
            fill: none;
            stroke: #334155;
            stroke-width: 5;
            stroke-linecap: round;
        }

        .conveyor-path-active {
            fill: none;
            stroke: var(--frontier-primary);
            stroke-width: 5;
            stroke-linecap: round;
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
        }

        /* Job Package */
        .job-package {
            position: absolute;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--frontier-primary), #0d7377);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1rem;
            box-shadow: 
                0 8px 25px rgba(24, 169, 168, 0.5),
                0 0 40px rgba(24, 169, 168, 0.3);
            z-index: 10;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .job-package.visible {
            opacity: 1;
            animation: packageGlow 1.5s ease infinite;
        }

        @keyframes packageGlow {
            0%, 100% { box-shadow: 0 8px 25px rgba(24, 169, 168, 0.5), 0 0 40px rgba(24, 169, 168, 0.3); }
            50% { box-shadow: 0 8px 35px rgba(24, 169, 168, 0.7), 0 0 60px rgba(24, 169, 168, 0.5); }
        }

        .job-package::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            background: linear-gradient(135deg, rgba(255,255,255,0.3), transparent);
            pointer-events: none;
        }

        .job-package::after {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;
            border-radius: 15px;
            background: inherit;
            filter: blur(15px);
            opacity: 0.4;
            z-index: -1;
        }

        /* Resource Meters */
        .resource-meters {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.6rem;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 14px;
            padding: 0.85rem;
            margin-top: 0.5rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .resource-meter {
            display: flex;
            align-items: center;
            gap: 0.7rem;
            background: rgba(255,255,255,0.06);
            border-radius: 12px;
            padding: 0.7rem 0.85rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .resource-meter:hover {
            background: rgba(255,255,255,0.1);
            border-color: rgba(255, 255, 255, 0.12);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }

        .meter-icon {
            flex-shrink: 0;
            width: 46px;
            height: 46px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.35rem;
            background: rgba(255, 255, 255, 0.08);
            transition: transform 0.3s ease, background 0.3s ease;
        }

        .resource-meter:hover .meter-icon {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.12);
        }

        .meter-content {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .meter-value {
            color: white;
            font-size: 1.15rem;
            font-weight: 700;
            line-height: 1.2;
            letter-spacing: -0.02em;
        }

        .meter-label {
            color: var(--frontier-text-muted);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            margin-top: 0.15rem;
        }

        .meter-content .meter-bar {
            align-self: stretch;
            width: 100%;
        }
        .meter-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 0.35rem;
            overflow: hidden;
        }

        .meter-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
        }

        .meter-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s linear infinite;
        }

        /* ---- Workflow hover-reveal info hints ---- */

        /* Info icon next to slider labels */
        .wf-info-icon {
            font-size: 0.7rem;
            opacity: 0.4;
            margin-left: 0.3rem;
            transition: opacity 0.3s ease, color 0.3s ease, transform 0.3s ease;
            cursor: help;
            display: inline-block;
        }
        .wf-info-icon:hover,
        .control-group.wf-info-active .wf-info-icon,
        .image-selection.wf-info-active .wf-info-icon,
        .why-gpu.wf-info-active .wf-info-icon {
            opacity: 1;
            color: var(--frontier-primary);
            transform: scale(1.2);
        }

        /* Expandable info text below slider labels */
        .wf-info-text {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.4s cubic-bezier(0.25, 1, 0.5, 1),
                        opacity 0.35s ease,
                        margin 0.3s ease;
            font-size: 0.78rem;
            color: var(--frontier-text-muted);
            line-height: 1.5;
            margin-top: 0;
            padding-left: 0.15rem;
        }
        /* Reveal on icon hover (desktop) â€” :has() targets only the icon */
        .control-group:has(.wf-info-icon:hover) .wf-info-text,
        .image-selection:has(.wf-info-icon:hover) .wf-info-text,
        .why-gpu:has(.wf-info-icon:hover) .wf-info-text,
        /* Reveal on tap/click toggle (mobile + desktop fallback) */
        .control-group.wf-info-active .wf-info-text,
        .image-selection.wf-info-active .wf-info-text,
        .why-gpu.wf-info-active .wf-info-text {
            max-height: 120px;
            opacity: 1;
            margin-top: 0.35rem;
        }

        /* Stat-card hover hint (Runtime, Efficiency, SU Cost) */
        .stat-hint {
            font-size: 0.72rem;
            color: var(--frontier-text-muted);
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.4s ease, opacity 0.3s ease, margin 0.3s ease;
            margin-top: 0;
            line-height: 1.35;
        }
        .stat-card:hover .stat-hint {
            max-height: 40px;
            opacity: 1;
            margin-top: 0.3rem;
        }

        /* Resource-meter hover hint (Cores, Memory, I/O, Network) */
        .meter-hint {
            font-size: 0.68rem;
            color: rgba(255, 255, 255, 0.45);
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.4s ease, opacity 0.3s ease, margin 0.3s ease;
            margin-top: 0;
            line-height: 1.35;
            text-align: center;
        }
        .resource-meter:hover .meter-hint {
            max-height: 35px;
            opacity: 1;
            margin-top: 0.3rem;
        }

        /* Metric-card hover hint (Scaling module) */
        .metric-hint {
            font-size: 0.68rem;
            color: rgba(255, 255, 255, 0.45);
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.4s ease, opacity 0.3s ease, margin 0.3s ease;
            margin-top: 0;
            line-height: 1.35;
        }
        .metric-card:hover .metric-hint {
            max-height: 40px;
            opacity: 1;
            margin-top: 0.3rem;
        }

        /* Efficiency display hover hint */
        .efficiency-hint {
            font-size: 0.72rem;
            color: rgba(255, 255, 255, 0.4);
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.4s ease, opacity 0.3s ease, margin 0.3s ease;
            margin-top: 0;
            line-height: 1.45;
        }
        .efficiency-display:hover .efficiency-hint {
            max-height: 45px;
            opacity: 1;
            margin-top: 0.5rem;
        }

        /* Light-mode overrides for scaling hints */
        [data-theme="light"] .metric-hint { color: rgba(30, 41, 59, 0.55); }
        [data-theme="light"] .efficiency-hint { color: rgba(30, 41, 59, 0.55); }

        /* Pipeline station tooltip */
        .station-tooltip {
            position: absolute;
            top: calc(100% + 0.4rem);
            left: 50%;
            transform: translateX(-50%) translateY(4px);
            background: rgba(15, 23, 42, 0.95);
            color: #e2e8f0;
            font-size: 0.72rem;
            line-height: 1.4;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
            z-index: 20;
            border: 1px solid rgba(24, 169, 168, 0.25);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
            max-width: 200px;
            white-space: normal;
            text-align: center;
        }
        .station-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-bottom-color: rgba(15, 23, 42, 0.95);
        }
        .conveyor-station:hover .station-tooltip {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Light-mode overrides for workflow hints */
        [data-theme="light"] .wf-info-text {
            color: #64748b;
        }
        [data-theme="light"] .stat-hint {
            color: #64748b;
        }
        [data-theme="light"] .station-tooltip {
            background: rgba(255, 255, 255, 0.97);
            color: #334155;
            border-color: rgba(24, 169, 168, 0.3);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
        }
        [data-theme="light"] .station-tooltip::before {
            border-bottom-color: rgba(255, 255, 255, 0.97);
        }

        /* Left panel: terminal grows with content; no page scroll steal */
        .workflow-container > .panel:first-child .terminal {
            display: flex;
            flex-direction: column;
        }
        .workflow-container > .panel:first-child .terminal-body {
            flex: 0 0 auto;
            height: auto;
        }

        /* Terminal Output */
        .terminal {
            border-radius: 16px;
            overflow: hidden;
            font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
            font-size: 0.82rem;
            background: #0a0f1a;
            margin-top: 1.5rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .terminal-header {
            background: linear-gradient(135deg, #1e293b, #334155);
            padding: 0.85rem 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }

        .terminal-header .dot {
            width: 13px;
            height: 13px;
            border-radius: 50%;
            transition: transform 0.2s ease;
        }

        .terminal-header .dot:hover {
            transform: scale(1.2);
        }

        .terminal-header .dot.red { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .terminal-header .dot.yellow { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .terminal-header .dot.green { background: linear-gradient(135deg, #10b981, #059669); }

        .terminal-header span {
            margin-left: auto;
            color: #94a3b8;
            font-size: 0.75rem;
            font-family: inherit;
        }

        .terminal-body {
            padding: 1.25rem;
            min-height: 10rem;
            max-height: 520px;
            overflow-y: auto;
            color: #10b981;
            scrollbar-width: thin;
            scrollbar-color: var(--frontier-primary) transparent;
        }

        .terminal-body::-webkit-scrollbar {
            width: 6px;
        }

        .terminal-body::-webkit-scrollbar-thumb {
            background: var(--frontier-primary);
            border-radius: 3px;
        }

        .terminal-line {
            margin-bottom: 0.35rem;
            opacity: 0;
            animation: terminalFadeIn 0.4s forwards;
            line-height: 1.5;
        }

        @keyframes terminalFadeIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .terminal-line .prompt { color: var(--frontier-primary); font-weight: 600; }
        .terminal-line .comment { color: #64748b; font-style: italic; }
        .terminal-line .success { color: var(--frontier-success); }
        .terminal-line .warning { color: var(--frontier-warning); }
        .terminal-line .error { color: var(--frontier-danger); }

        /* Typing cursor effect */
        .terminal-line.typing::after {
            content: 'â–‹';
            animation: blink 0.8s step-end infinite;
            color: var(--frontier-primary);
        }

        /* Workflow metrics block: Runtime/Efficiency/SU Cost above Cores/Memory/I-O/Network */
        .workflow-metrics {
            margin-top: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.65rem;
        }

        .workflow-metrics .stats-grid {
            margin-top: 0;
            grid-template-columns: repeat(3, 1fr);
        }

        .workflow-metrics .resource-meters {
            margin-top: 0;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stat-card {
            padding: 0.85rem 0.75rem;
            border-radius: 14px;
            text-align: center;
            background: linear-gradient(180deg, var(--frontier-bg-alt) 0%, rgba(24, 169, 168, 0.03) 100%);
            border: 1px solid var(--frontier-border);
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--frontier-primary), var(--frontier-secondary));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            border-color: var(--frontier-primary-muted);
            box-shadow: 0 10px 30px rgba(24, 169, 168, 0.15);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-card .stat-icon {
            font-size: 1.5rem;
            margin-bottom: 0.35rem;
            display: inline-block;
            transition: transform 0.3s ease;
        }

        .stat-card:hover .stat-icon {
            transform: scale(1.1);
        }

        .stat-card .stat-value {
            font-size: 1.35rem;
            font-weight: 700;
            color: var(--frontier-text);
            margin-bottom: 0.2rem;
            background: linear-gradient(135deg, var(--frontier-text) 0%, var(--frontier-primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-card .stat-label {
            font-size: 0.7rem;
            color: var(--frontier-text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        /* Stat Card Variations */
        .stat-card.success .stat-value {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-card.warning .stat-value {
            background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-card.danger .stat-value {
            background: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ==================== MODULE 2: SCALING - VISUAL WORKERS ==================== */
        .scaling-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 1024px) {
            .scaling-container {
                grid-template-columns: 360px 1fr;
            }
        }

        /* Worker Visualization */
        .worker-visualization {
            background: linear-gradient(180deg, var(--frontier-bg-dark) 0%, #0a1628 100%);
            border-radius: 20px;
            padding: 2rem;
            min-height: 740px;
            box-shadow: inset 0 2px 20px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .worker-visualization::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at 50% 0%, rgba(213, 35, 73, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 100%, rgba(24, 169, 168, 0.05) 0%, transparent 50%);
            pointer-events: none;
        }

        .worker-viz-title {
            color: white;
            font-size: 1.1rem;
            margin: 0 0 1.5rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-weight: 600;
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .worker-viz-title i {
            color: var(--frontier-secondary);
        }

        .work-pile {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            padding: 1.25rem;
            background: rgba(255,255,255,0.06);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .work-pile:hover {
            background: rgba(255,255,255,0.1);
            border-color: var(--frontier-warning);
            transform: translateX(5px);
        }

        .pile-icon {
            font-size: 3.5rem;
            color: var(--frontier-warning);
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 15px rgba(245, 158, 11, 0.4));
        }

        .pile-info h4 {
            color: white;
            margin: 0 0 0.35rem 0;
            font-size: 1.15rem;
            font-weight: 700;
        }

        .pile-info p {
            color: var(--frontier-text-muted);
            margin: 0;
            font-size: 0.9rem;
        }

        .pile-count {
            margin-left: auto;
            background: linear-gradient(135deg, var(--frontier-warning), #d97706);
            color: #1a1a1a;
            padding: 0.6rem 1.25rem;
            border-radius: 25px;
            font-weight: 800;
            font-size: 1.3rem;
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
            transition: transform 0.3s ease;
        }

        .pile-count:hover {
            transform: scale(1.1);
        }

        /* Workers Grid */
        .workers-container {
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .workers-label {
            color: var(--frontier-text-muted);
            font-size: 0.9rem;
            margin-bottom: 0.85rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 500;
        }

        .workers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
            gap: 10px;
            max-height: 220px;
            overflow-y: auto;
            padding: 0.75rem;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            scrollbar-width: thin;
            scrollbar-color: var(--frontier-primary) transparent;
        }

        .workers-grid::-webkit-scrollbar {
            width: 6px;
        }

        .workers-grid::-webkit-scrollbar-thumb {
            background: var(--frontier-primary);
            border-radius: 3px;
        }

        .worker {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            cursor: default;
        }

        .worker.idle {
            background: linear-gradient(135deg, #334155, #2d3a4d);
            color: #64748b;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .worker.idle:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, #475569, #3f4f61);
        }

        .worker.working {
            background: linear-gradient(135deg, var(--frontier-primary), #0d7377);
            color: white;
            animation: workerBusy 0.6s ease infinite;
            box-shadow: 0 5px 20px rgba(24, 169, 168, 0.5);
        }

        .worker.working::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            border: 2px solid var(--frontier-primary);
            animation: ripple 1.5s ease-out infinite;
        }

        .worker.overhead {
            background: linear-gradient(135deg, var(--frontier-danger), #dc2626);
            color: white;
            opacity: 0.7;
            animation: pulse 1s ease infinite;
        }

        @keyframes workerBusy {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.08) rotate(-2deg); }
            75% { transform: scale(1.08) rotate(2deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 0.5; }
        }

        /* Results Section */
        .results-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .results-title {
            color: var(--frontier-primary);
            font-size: 1rem;
            margin: 0 0 1rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        /* Scaling Metrics Display */
        .scaling-metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
        }

        @media (max-width: 768px) {
            .scaling-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .metric-card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 1.25rem;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: 1px solid transparent;
        }

        .metric-card:hover {
            transform: translateY(-5px) scale(1.02);
            background: rgba(255,255,255,0.1);
            border-color: var(--frontier-primary-glow);
        }

        .metric-card .metric-icon {
            font-size: 1.6rem;
            margin-bottom: 0.6rem;
            transition: transform 0.3s ease;
        }

        .metric-card:hover .metric-icon {
            transform: scale(1.2);
        }

        .metric-card .metric-value {
            font-size: 2rem;
            font-weight: 800;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .metric-card .metric-label {
            font-size: 0.75rem;
            color: var(--frontier-text-muted);
            text-transform: uppercase;
            margin-top: 0.35rem;
            letter-spacing: 0.5px;
        }

        .metric-card.highlight .metric-value { color: var(--frontier-primary); text-shadow: 0 0 20px var(--frontier-primary-glow); }
        .metric-card.warning .metric-value { color: var(--frontier-warning); text-shadow: 0 0 20px rgba(245, 158, 11, 0.4); }
        .metric-card.success .metric-value { color: var(--frontier-success); text-shadow: 0 0 20px rgba(16, 185, 129, 0.4); }
        .metric-card.danger .metric-value { color: var(--frontier-danger); text-shadow: 0 0 20px rgba(239, 68, 68, 0.4); }

        /* Efficiency Bar */
        .efficiency-display {
            margin-top: 1.5rem;
            padding: 1.25rem;
            background: rgba(255,255,255,0.06);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .efficiency-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.85rem;
        }

        .efficiency-header span {
            color: var(--frontier-text-muted);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .efficiency-value {
            color: white;
            font-weight: 800;
            font-size: 1.2rem;
        }

        .efficiency-bar {
            height: 24px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .efficiency-fill {
            height: 100%;
            border-radius: 12px;
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }

        .efficiency-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shimmer 2s linear infinite;
        }

        .efficiency-fill.good { background: linear-gradient(90deg, var(--frontier-success), #14b8a6, var(--frontier-success)); background-size: 200% 100%; }
        .efficiency-fill.medium { background: linear-gradient(90deg, var(--frontier-warning), #fbbf24, var(--frontier-warning)); background-size: 200% 100%; }
        .efficiency-fill.poor { background: linear-gradient(90deg, var(--frontier-danger), #f87171, var(--frontier-danger)); background-size: 200% 100%; }

        .efficiency-zones {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
        }

        .efficiency-zone {
            flex: 1;
            border-right: 1px dashed rgba(255,255,255,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            color: rgba(255,255,255,0.4);
        }

        /* Serial/Parallel Workflow Visualization */
        .workflow-flow {
            margin-top: 1.5rem;
            padding: 1.75rem;
            background: rgba(0, 0, 0, 0.35);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .workflow-flow-title {
            color: white;
            font-size: 1rem;
            margin: 0 0 1.25rem 0;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-weight: 700;
        }

        .workflow-flow-title i {
            color: var(--frontier-info);
        }

        .flow-diagram {
            display: flex;
            gap: 1.25rem;
            align-items: stretch;
            min-height: 160px;
        }

        .flow-section {
            flex: 1;
            padding: 1.25rem;
            border-radius: 14px;
            position: relative;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .flow-section:hover {
            transform: scale(1.02);
        }

        .flow-section.serial {
            background: rgba(239, 68, 68, 0.12);
            border: 2px solid rgba(239, 68, 68, 0.4);
            flex: 0 0 auto;
            min-width: 130px;
            box-shadow: 0 5px 20px rgba(239, 68, 68, 0.15);
        }

        .flow-section.parallel {
            background: rgba(16, 185, 129, 0.12);
            border: 2px solid rgba(16, 185, 129, 0.4);
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.15);
        }

        .flow-section-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            font-weight: 700;
            margin-bottom: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            letter-spacing: 0.5px;
        }

        .flow-section.serial .flow-section-label {
            color: var(--frontier-danger);
        }

        .flow-section.parallel .flow-section-label {
            color: var(--frontier-success);
        }

        .flow-tasks {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
            justify-content: center;
        }

        .flow-task {
            height: 10px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .flow-task.serial-task {
            background: var(--frontier-danger);
            width: 100%;
        }

        .flow-task.serial-task.processing {
            animation: serialPulse 0.5s ease infinite;
        }

        @keyframes serialPulse {
            0%, 100% { opacity: 1; transform: scaleX(1); }
            50% { opacity: 0.7; transform: scaleX(0.95); }
        }

        .parallel-lanes {
            display: grid;
            gap: 6px;
            flex: 1;
        }

        .parallel-lane {
            display: flex;
            gap: 3px;
            align-items: center;
        }

        .parallel-task {
            height: 10px;
            flex: 1;
            border-radius: 3px;
            background: #334155;
            transition: all 0.3s ease;
        }

        .parallel-task.active {
            background: var(--frontier-success);
        }

        .parallel-task.processing {
            background: var(--frontier-success);
            animation: parallelPulse 0.4s ease infinite;
        }

        @keyframes parallelPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .flow-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            flex-shrink: 0;
        }

        .flow-arrow i {
            color: var(--frontier-text-muted);
            font-size: 1.5rem;
            animation: arrowPulse 1.5s ease infinite;
        }

        @keyframes arrowPulse {
            0%, 100% { opacity: 0.4; transform: translateX(0); }
            50% { opacity: 1; transform: translateX(5px); }
        }

        .flow-legend {
            display: flex;
            gap: 1.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--frontier-text-muted);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .legend-color.serial { background: var(--frontier-danger); }
        .legend-color.parallel { background: var(--frontier-success); }
        .legend-color.waiting { background: #334155; }

        /* Insight Card */
        .insight-card {
            margin-top: 1.75rem;
            padding: 1.5rem;
            border-radius: 16px;
            display: flex;
            align-items: flex-start;
            gap: 1.25rem;
            background: linear-gradient(135deg, rgba(24, 169, 168, 0.12) 0%, rgba(59, 130, 246, 0.08) 100%);
            border: 1px solid rgba(24, 169, 168, 0.35);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .insight-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--frontier-primary), var(--frontier-info));
        }

        .insight-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(24, 169, 168, 0.15);
            background: linear-gradient(135deg, rgba(24, 169, 168, 0.18) 0%, rgba(59, 130, 246, 0.12) 100%);
        }

        .insight-card i {
            font-size: 1.75rem;
            color: var(--frontier-primary);
            flex-shrink: 0;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 8px var(--frontier-primary-glow));
        }

        .insight-card p {
            margin: 0;
            font-size: 1rem;
            line-height: 1.7;
            color: var(--frontier-text);
        }

        .insight-card strong {
            color: var(--frontier-primary);
        }

        /* Amdahl Limit Visual */
        .amdahl-visual {
            margin-top: 1.75rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.12) 0%, rgba(239, 68, 68, 0.06) 100%);
            border: 1px solid rgba(239, 68, 68, 0.35);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .amdahl-visual:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(239, 68, 68, 0.15);
        }

        .amdahl-title {
            color: var(--frontier-danger);
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-size: 1rem;
        }

        .amdahl-title i {
            animation: pulse 2s ease infinite;
        }

        .amdahl-bar {
            height: 35px;
            border-radius: 10px;
            display: flex;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .amdahl-parallel {
            background: var(--frontier-success);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
            transition: width 0.5s ease;
        }

        .amdahl-serial {
            background: var(--frontier-danger);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .amdahl-explanation {
            color: var(--frontier-text-secondary);
            font-size: 0.85rem;
            margin-top: 0.75rem;
            line-height: 1.5;
        }

        /* ==================== MODULE 3: CPU vs GPU ==================== */
        .render-viz-title {
            color: var(--frontier-text);
            font-size: 1.1rem;
            margin: 0 0 1.5rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-weight: 600;
            position: relative;
            z-index: 1;
            text-align: center;
        }
        .render-viz-title i {
            color: var(--frontier-primary);
        }

        .cpugpu-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 1024px) {
            .cpugpu-container {
                grid-template-columns: 360px 1fr;
            }
        }

        /* Image Selection */
        .image-selection {
            margin-bottom: 1.75rem;
        }

        .image-selection-label {
            color: var(--frontier-text);
            font-weight: 700;
            margin-bottom: 1rem;
            display: block;
            font-size: 1rem;
        }

        .image-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.85rem;
        }

        .image-option {
            aspect-ratio: 1;
            border-radius: 14px;
            border: 3px solid var(--frontier-border);
            cursor: pointer;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: var(--frontier-bg-alt);
            padding: 0.6rem;
        }

        .image-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, transparent 0%, rgba(24, 169, 168, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .image-option:hover::before {
            opacity: 1;
        }

        .image-option:hover {
            border-color: var(--frontier-primary);
            transform: translateY(-4px) scale(1.03);
            box-shadow: 0 10px 30px var(--frontier-primary-glow);
        }

        .image-option.selected {
            border-color: var(--frontier-primary);
            box-shadow: 0 0 25px var(--frontier-primary-glow);
            background: linear-gradient(135deg, var(--frontier-bg-alt), rgba(24, 169, 168, 0.1));
        }

        .image-option.selected::after {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 6px;
            right: 6px;
            width: 20px;
            height: 20px;
            background: var(--frontier-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            color: white;
            animation: scaleIn 0.3s ease;
        }

        .image-option i {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            color: var(--frontier-text-secondary);
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .image-option:hover i {
            transform: scale(1.15);
            color: var(--frontier-primary);
        }

        .image-option.selected i {
            color: var(--frontier-primary);
            filter: drop-shadow(0 0 8px var(--frontier-primary-glow));
        }

        .image-option span {
            font-size: 0.75rem;
            color: var(--frontier-text-muted);
            text-align: center;
            font-weight: 500;
            position: relative;
            z-index: 1;
            transition: color 0.3s ease;
        }

        .image-option:hover span,
        .image-option.selected span {
            color: var(--frontier-text);
        }

        /* Render Comparison */
        .render-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.75rem;
        }

        @media (max-width: 768px) {
            .render-comparison {
                grid-template-columns: 1fr;
            }
        }

        .render-panel {
            border-radius: 20px;
            overflow: hidden;
            background: var(--frontier-bg-alt);
            border: 1px solid var(--frontier-border);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
            transition: all 0.4s ease;
        }

        .render-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.25);
        }

        .render-header {
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            font-weight: 700;
            font-size: 1.05rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .render-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shimmer 3s linear infinite;
        }

        .render-header i {
            font-size: 1.1rem;
        }

        .render-panel.cpu .render-header {
            background: linear-gradient(135deg, var(--frontier-secondary), #a01b3a, #8b1530);
        }

        .render-panel.gpu .render-header {
            background: linear-gradient(135deg, var(--frontier-success), #059669, #047857);
        }

        .render-canvas-container {
            position: relative;
            aspect-ratio: 1;
            background: linear-gradient(135deg, #0a0f1a 0%, #0d1525 100%);
            overflow: hidden;
        }

        .render-canvas {
            width: 100%;
            height: 100%;
            display: block;
            image-rendering: pixelated;
        }

        .render-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.75);
            color: white;
            backdrop-filter: blur(5px);
        }

        .render-overlay.hidden {
            display: none;
        }

        .render-overlay i {
            font-size: 4rem;
            margin-bottom: 1.25rem;
            opacity: 0.6;
            animation: float 3s ease-in-out infinite;
        }

        .render-overlay span {
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* Render Progress */
        .render-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: rgba(0, 0, 0, 0.5);
        }

        .render-progress-fill {
            height: 100%;
            width: 0%;
            transition: width 0.1s linear;
        }

        .render-panel.cpu .render-progress-fill {
            background: linear-gradient(90deg, var(--frontier-secondary), #ff6b9d);
        }

        .render-panel.gpu .render-progress-fill {
            background: linear-gradient(90deg, var(--frontier-success), #6ee7b7);
        }

        .render-stats {
            padding: 0.9rem 1rem;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem 0.85rem;
            background: var(--frontier-bg-panel);
        }

        .render-stat {
            text-align: center;
            padding: 0.35rem 0.25rem;
            transition: all 0.3s ease;
            border-radius: 8px;
        }

        .render-stat:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .render-stat .stat-value {
            font-size: 1.05rem;
            font-weight: 700;
            line-height: 1.2;
            letter-spacing: -0.02em;
            margin-bottom: 0.15rem;
        }

        .render-stat .stat-label {
            font-size: 0.7rem;
            color: var(--frontier-text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            line-height: 1.25;
        }

        .render-panel.cpu .render-stat .stat-value { color: var(--frontier-secondary); }
        .render-panel.gpu .render-stat .stat-value { color: var(--frontier-success); }

        /* Progress indicators for render */
        .render-progress {
            height: 4px;
            background: rgba(255,255,255,0.1);
        }

        .render-progress-fill {
            height: 100%;
            transition: width 0.1s linear;
        }

        .render-panel.cpu .render-progress-fill { background: var(--frontier-secondary); }
        .render-panel.gpu .render-progress-fill { background: var(--frontier-success); }

        /* Speed Comparison: two cards side by side */
        .speed-comparison {
            margin-top: 1.5rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.25rem;
        }

        .speed-card {
            padding: 1.5rem 1.25rem;
            border-radius: 16px;
            text-align: center;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(24, 169, 168, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            overflow: visible;
        }

        .speed-card h3 {
            margin: 0 0 1rem 0;
            font-size: 1rem;
            color: var(--frontier-text);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .speedup-value,
        .speed-card .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.15;
            background: linear-gradient(135deg, var(--frontier-success), var(--frontier-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
        }

        .speedup-label,
        .speed-card .metric-label {
            font-size: 0.9rem;
            color: var(--frontier-text-secondary);
            margin-top: 0.35rem;
            line-height: 1.3;
        }

        /* ==================== ANIMATION COMPARISON SECTION ==================== */
        .animation-comparison-section {
            margin-top: 2rem;
        }

        .animation-comparison-section h2 {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .animation-comparison-section h2 i {
            color: var(--frontier-primary);
        }

        .animation-scenario {
            background: linear-gradient(180deg, var(--frontier-bg-dark) 0%, #0a1628 100%);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .animation-scenario::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--frontier-primary), var(--frontier-secondary), var(--frontier-accent));
        }

        .animation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .animation-header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .animation-header-controls .animation-buttons {
            margin-top: 0;
        }

        .animation-header-controls .btn {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .animation-title {
            color: white;
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .animation-title i {
            color: var(--frontier-accent);
        }

        .frame-count-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .frame-count-selector label {
            color: var(--frontier-text-muted);
            font-size: 0.9rem;
        }

        .frame-count-selector select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .frame-count-selector select:hover {
            border-color: var(--frontier-primary);
        }

        .frame-count-selector select option {
            background: var(--frontier-bg-dark);
            color: white;
        }

        /* Filmstrip Timeline */
        .filmstrip-container {
            position: relative;
            margin-bottom: 2rem;
        }

        .filmstrip-label {
            color: white;
            font-weight: 600;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filmstrip-label i {
            font-size: 1.1rem;
        }

        .filmstrip-label.cpu i { color: var(--frontier-secondary); }
        .filmstrip-label.gpu i { color: var(--frontier-success); }

        .filmstrip {
            display: flex;
            gap: 4px;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            overflow-x: auto;
            position: relative;
        }

        .filmstrip::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: repeating-linear-gradient(
                90deg,
                rgba(255,255,255,0.3) 0px,
                rgba(255,255,255,0.3) 8px,
                transparent 8px,
                transparent 16px
            );
            border-radius: 12px 12px 0 0;
        }

        .filmstrip::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: repeating-linear-gradient(
                90deg,
                rgba(255,255,255,0.3) 0px,
                rgba(255,255,255,0.3) 8px,
                transparent 8px,
                transparent 16px
            );
            border-radius: 0 0 12px 12px;
        }

        .frame {
            width: 50px;
            height: 50px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
            transition: all 0.3s ease;
            flex-shrink: 0;
            position: relative;
        }

        .frame.rendering {
            border-color: var(--frontier-accent);
            background: rgba(245, 158, 11, 0.3);
            color: var(--frontier-accent);
            animation: frameRender 0.5s ease infinite;
        }

        .frame.complete {
            border-color: var(--frontier-success);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.4), rgba(16, 185, 129, 0.2));
            color: var(--frontier-success);
        }

        .frame.complete::after {
            content: 'âœ“';
            position: absolute;
            font-size: 1rem;
        }

        .frame.complete span {
            display: none;
        }

        @keyframes frameRender {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px rgba(245, 158, 11, 0.5); }
            50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(245, 158, 11, 0.8); }
        }

        /* Animation Preview Row */
        .animation-preview-row {
            margin-bottom: 1.5rem;
        }

        .animation-preview-card {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1.25rem 1.75rem;
            background: linear-gradient(135deg, rgba(24, 169, 168, 0.15), rgba(213, 35, 73, 0.1));
            border-radius: 16px;
            border: 1px solid rgba(24, 169, 168, 0.3);
            flex-wrap: wrap;
            justify-content: center;
        }

        .preview-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--frontier-primary), var(--frontier-secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            color: white;
            flex-shrink: 0;
            animation: float 3s ease-in-out infinite;
        }

        .preview-info {
            flex: 1;
            min-width: 200px;
        }

        .preview-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--frontier-text);
            margin-bottom: 0.25rem;
        }

        .preview-title span {
            color: var(--frontier-primary);
        }

        .preview-desc {
            font-size: 0.9rem;
            color: var(--frontier-text-muted);
        }

        .preview-arrow {
            font-size: 1.5rem;
            color: var(--frontier-primary);
            animation: slideRight 1.5s ease-in-out infinite;
        }

        @keyframes slideRight {
            0%, 100% { transform: translateX(0); opacity: 0.5; }
            50% { transform: translateX(10px); opacity: 1; }
        }

        .preview-output {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid rgba(245, 158, 11, 0.4);
            border-radius: 12px;
            color: var(--frontier-accent);
            font-weight: 600;
            font-size: 1rem;
        }

        .preview-output i {
            font-size: 1.3rem;
        }

        @media (max-width: 768px) {
            .animation-preview-card {
                flex-direction: column;
                text-align: center;
            }

            .preview-arrow {
                transform: rotate(90deg);
            }

            @keyframes slideRight {
                0%, 100% { transform: rotate(90deg) translateX(0); opacity: 0.5; }
                50% { transform: rotate(90deg) translateX(10px); opacity: 1; }
            }
        }

        /* Animation Stats Grid */
        .animation-stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .animation-stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .animation-stat-card:hover {
            transform: translateY(-3px);
            border-color: var(--frontier-primary-glow);
        }

        .animation-stat-card.cpu {
            border-left: 4px solid var(--frontier-secondary);
        }

        .animation-stat-card.gpu {
            border-left: 4px solid var(--frontier-success);
        }

        .animation-stat-card.highlight {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(24, 169, 168, 0.15));
            border: 2px solid rgba(16, 185, 129, 0.4);
        }

        .animation-stat-card .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.75rem;
        }

        .animation-stat-card.cpu .stat-icon { color: var(--frontier-secondary); }
        .animation-stat-card.gpu .stat-icon { color: var(--frontier-success); }
        .animation-stat-card.highlight .stat-icon { color: var(--frontier-accent); }

        .animation-stat-card .stat-value {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.25rem;
            word-break: break-word;
            overflow-wrap: break-word;
        }

        .animation-stat-card.cpu .stat-value { color: var(--frontier-secondary); }
        .animation-stat-card.gpu .stat-value { color: var(--frontier-success); }
        .animation-stat-card.highlight .stat-value {
            background: linear-gradient(135deg, var(--frontier-success), var(--frontier-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2rem;
        }

        .animation-stat-card .stat-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Timeline Visualization */
        .timeline-viz {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 16px;
        }

        .timeline-viz h4 {
            color: white;
            margin: 0 0 1rem 0;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .timeline-viz h4 i {
            color: var(--frontier-primary);
        }

        .timeline-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .timeline-label {
            width: 60px;
            font-weight: 600;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .timeline-label.cpu { color: var(--frontier-secondary); }
        .timeline-label.gpu { color: var(--frontier-success); }

        .timeline-bar-container {
            flex: 1;
            height: 35px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .timeline-bar {
            height: 100%;
            border-radius: 8px;
            display: flex;
            align-items: center;
            padding-left: 10px;
            font-size: 0.8rem;
            font-weight: 600;
            color: white;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .timeline-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.2) 50%, transparent 100%);
            animation: shimmer 2s linear infinite;
        }

        .timeline-bar.cpu {
            background: linear-gradient(90deg, var(--frontier-secondary), #ff6b9d);
        }

        .timeline-bar.gpu {
            background: linear-gradient(90deg, var(--frontier-success), #6ee7b7);
        }

        .animation-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        /* Responsive Animation Section */
        @media (max-width: 768px) {
            .animation-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .animation-header-controls {
                width: 100%;
                justify-content: space-between;
            }

            .frame {
                width: 40px;
                height: 40px;
                font-size: 0.6rem;
            }

            .animation-stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .animation-stat-card .stat-value {
                font-size: 1.5rem;
            }

            .animation-stat-card.highlight .stat-value {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .animation-header-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 0.75rem;
            }

            .animation-header-controls .animation-buttons {
                justify-content: center;
            }

            .animation-stats-grid {
                grid-template-columns: 1fr;
            }

            .frame {
                width: 35px;
                height: 35px;
            }

            .timeline-label {
                width: 45px;
                font-size: 0.8rem;
            }
        }

        /* Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.2);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Why GPU section */
        .why-gpu {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 12px;
            background: var(--frontier-bg-alt);
            border: 1px solid var(--frontier-border);
        }

        .why-gpu h4 {
            margin: 0 0 1rem 0;
            color: var(--frontier-text);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .processor-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .processor-card {
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
        }

        .processor-card.cpu-card {
            background: rgba(213, 35, 73, 0.1);
            border: 1px solid rgba(213, 35, 73, 0.3);
        }

        .processor-card.gpu-card {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .processor-card h5 {
            margin: 0 0 0.75rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .processor-card.cpu-card h5 { color: var(--frontier-secondary); }
        .processor-card.gpu-card h5 { color: var(--frontier-success); }

        .core-viz {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
            margin-bottom: 0.75rem;
        }

        .core {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .cpu-card .core {
            background: var(--frontier-secondary);
            width: 30px;
            height: 30px;
        }

        .gpu-card .core {
            background: var(--frontier-success);
            width: 8px;
            height: 8px;
        }

        .processor-card p {
            margin: 0;
            font-size: 0.8rem;
            color: var(--frontier-text-muted);
        }

        /* ==================== RESPONSIVE DESIGN ==================== */
        
        /* Tablet Portrait */
        @media (max-width: 1024px) {
            .workflow-container,
            .scaling-container,
            .cpugpu-container,
            .rightsizing-container {
                grid-template-columns: 1fr;
            }

            .factory-viz,
            .worker-visualization {
                min-height: auto;
            }
        }

        /* Mobile Large */
        @media (max-width: 768px) {
            .frontier-app {
                padding: 0.75rem;
                padding-top: 2.25rem;
            }

            /* Header Mobile */
            .app-header {
                border-radius: 16px;
            }

            .app-header h1 {
                font-size: 1.8rem;
                gap: 0.6rem;
            }

            .app-header h1 i {
                font-size: 1.6rem;
            }

            .app-header p {
                font-size: 1rem;
            }

            .header-content {
                padding: 1.5rem 1.25rem 1.75rem;
            }

            /* Collapse header-nav bar; float back-btn into the titleBar row */
            .header-nav {
                padding: 0; height: 0; overflow: visible;
                background: none; border: none; backdrop-filter: none;
            }

            .header-badges { display: none; }

            /* back-btn is moved into #titleBar by JS on mobile */
            .header-nav .back-btn { display: none !important; }
            #titleBar .back-btn {
                position: absolute !important; top: 5px !important; left: 10px !important; right: auto !important;
                font-size: 0.8rem !important; padding: 0.4rem 0.85rem !important;
                background: rgba(20, 184, 166, 0.25) !important;
                border: 1px solid rgba(20, 184, 166, 0.45) !important;
                backdrop-filter: blur(10px); border-radius: 8px !important;
                color: white !important; width: auto !important;
                display: inline-flex !important; align-items: center !important; gap: 0.4rem !important;
                height: auto !important; line-height: normal !important;
                text-decoration: none !important; font-weight: 500 !important;
                white-space: nowrap !important;
            }
            #titleBar .back-btn i { font-size: 0.72rem; }
            #titleBar .back-btn:hover { transform: none !important; box-shadow: none !important; }

            /* Module Tabs Mobile */
            .module-tabs {
                gap: 0.75rem;
            }

            .module-tab {
                min-width: 100%;
                padding: 1.25rem;
                border-radius: 14px;
            }

            .module-tab .icon {
                width: 55px;
                height: 55px;
                font-size: 1.5rem;
            }

            .module-tab .info h3 {
                font-size: 1.05rem;
            }

            .module-tab .info p {
                font-size: 0.85rem;
            }

            /* Panels Mobile */
            .panel {
                padding: 1.25rem;
                border-radius: 14px;
                overflow: hidden;
                max-width: 100%;
            }

            .panel h2 {
                font-size: 1.2rem;
            }

            /* Controls Mobile */
            .control-group .value {
                padding: 0.2rem 0.6rem;
                font-size: 0.8rem;
            }

            input[type="range"]::-webkit-slider-thumb {
                width: 22px;
                height: 22px;
            }

            /* Buttons Mobile */
            .btn {
                padding: 0.85rem 1.5rem;
                font-size: 1rem;
                border-radius: 12px;
                width: 100%;
            }

            .btn-group {
                flex-direction: column;
            }

            /* Factory Viz Mobile */
                        @media (min-width: 769px) and (max-width: 1023px) {
                                                                                            .render-comparison-section {
                                                                                                display: flex !important;
                                                                                                flex-direction: row !important;
                                                                                                gap: 2.5rem;
                                                                                                align-items: flex-start;
                                                                                            }
                                                                                            .render-comparison-panel {
                                                                                                flex: 1 1 0;
                                                                                                min-width: 0;
                                                                                            }
                                                                            #factory-viz, #factory-viz * {
                                                                                font-size: 2.2rem !important;
                                                                                line-height: 1.18 !important;
                                                                            }
                                                            .conveyor-station {
                                                                font-size: 2.8rem !important;
                                                                margin: 1.5rem 0 !important;
                                                                max-width: 420px !important;
                                                            }
                                                            .station-icon {
                                                                width: 150px !important;
                                                                height: 150px !important;
                                                                font-size: 5rem !important;
                                                            }
                                                            .station-label {
                                                                font-size: 2.8rem !important;
                                                                margin-top: 1.1rem !important;
                                                                font-weight: 900 !important;
                                                                letter-spacing: 0.01em !important;
                                                            }
                                                            .station-status {
                                                                font-size: 2.1rem !important;
                                                                margin-top: 0.38rem !important;
                                                            }
                                            .resource-meters {
                                                font-size: 1.7rem;
                                            }
                                            .resource-meter {
                                                font-size: 1.4rem;
                                                padding: 2.1rem 1.2rem 2.1rem 1.2rem;
                                            }
                                            .meter-icon {
                                                font-size: 3.3rem;
                                                margin-bottom: 1.1rem;
                                            }
                                            .meter-value {
                                                font-size: 3.7rem;
                                                font-weight: 800;
                                                margin-bottom: 0.35rem;
                                            }
                                            .meter-label {
                                                font-size: 1.55rem;
                                                font-weight: 700;
                                            }
                            .job-package {
                                position: absolute;
                                left: unset;
                                top: unset;
                                width: 55px;
                                height: 55px;
                                margin: 0;
                                display: flex;
                                justify-content: center;
                                align-items: center;
                                background: rgba(24, 169, 168, 0.15);
                                box-shadow: 0 0 16px 4px rgba(24, 169, 168, 0.18);
                                filter: none;
                                z-index: 10;
                                transition: none;
                            }
                            .conveyor-system {
                                position: relative;
                                display: flex;
                                flex-direction: row;
                                flex-wrap: wrap;
                                justify-content: center;
                                align-items: flex-start;
                                width: 100%;
                                margin: 0 auto;
                            }
                            .conveyor-station {
                                font-size: 2.1rem;
                                margin: 1.3rem 0;
                                max-width: 370px;
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                            }
                            .station-icon {
                                width: 120px;
                                height: 120px;
                                font-size: 3.7rem;
                            }
                            .station-label {
                                font-size: 2.2rem;
                                margin-top: 0.7rem;
                                font-weight: 900;
                                letter-spacing: 0.01em;
                            }
                            .station-status {
                                font-size: 1.6rem;
                                margin-top: 0.28rem;
                            }
                            .resource-meters {
                                font-size: 1.15rem;
                            }
                            .meter-value {
                                font-size: 2.1rem;
                            }
                            .meter-label {
                                font-size: 1.1rem;
                            }
                            .factory-viz {
                                max-width: 1100px;
                                margin: 0 auto;
                            }
                        }
            .factory-viz {
                padding: 1.25rem;
                border-radius: 14px;
            }

                @media (max-width: 768px) {
                    .conveyor-system {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        height: auto !important;
                        min-height: 0 !important;
                        padding: 0.5rem 0;
                        position: relative;
                    }
                    .conveyor-station {
                        position: static !important;
                        margin: 1.2rem 0;
                        width: 100%;
                        max-width: 220px;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        z-index: 1;
                    }
                    .factory-viz {
                        padding-top: 0.5rem;
                    }
                    .factory-title {
                        margin-bottom: 0.5rem;
                    }
                    .factory-highlight {
                        border-radius: 16px;
                        margin-top: 0;
                        margin-bottom: 0;
                        padding: 0.5rem 0;
                        background: rgba(120,130,150,0.18);
                        z-index: 0;
                    }
                    .conveyor-paths {
                        display: none !important;
                    }
                    .station-icon {
                        width: 48px;
                        height: 48px;
                        font-size: 1.2rem;
                    }
                    .station-label {
                        font-size: 0.9rem;
                        margin-top: 0.2rem;
                    }
                    .station-status {
                        font-size: 0.8rem;
                        margin-top: 0.1rem;
                    }
                        .job-package {
                            position: absolute !important;
                            left: -60px !important;
                            width: 40px !important;
                            height: 40px !important;
                            margin: 0 !important;
                            display: flex;
                            justify-content: center;
                            align-items: center;
                            background: transparent !important;
                            box-shadow: none !important;
                            filter: none !important;
                            z-index: 10;
                            transition: top 0.4s cubic-bezier(.4,0,.2,1);
                        }
                        .conveyor-system {
                            position: relative;
                        }
                        }
                }

            .conveyor-system {
                height: 400px;
            }

            .station-icon {
                width: 55px;
                height: 55px;
                font-size: 1.4rem;
            }

            .station-label {
                font-size: 0.75rem;
                max-width: 70px;
                margin-top: 0.3rem;
            }

            .station-status {
                font-size: 0.65rem;
                margin-top: 0.1rem;
            }

            .job-package {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }

            /* Resource Meters Mobile */
            .resource-meters {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
                padding: 0.85rem;
            }

            .resource-meter {
                padding: 0.75rem;
            }

            .meter-icon {
                width: 38px;
                height: 38px;
                font-size: 1.05rem;
            }

            .meter-value {
                font-size: 0.9rem;
            }

            .meter-label {
                font-size: 0.6rem;
            }

            /* Terminal Mobile */
            .terminal {
                border-radius: 12px;
            }

            .terminal-body {
                max-height: 160px;
                font-size: 0.75rem;
                padding: 1rem;
            }

            /* Worker Visualization Mobile */
            .worker-visualization {
                padding: 1.25rem;
                border-radius: 14px;
            }

            .work-pile {
                padding: 1rem;
                gap: 1rem;
            }

            .pile-icon {
                font-size: 2.5rem;
            }

            .pile-info h4 {
                font-size: 1rem;
            }

            .pile-count {
                padding: 0.4rem 0.9rem;
                font-size: 1.1rem;
            }

            .workers-grid {
                max-height: 160px;
                gap: 6px;
            }

            .worker {
                width: 38px;
                height: 38px;
                font-size: 1.1rem;
            }

            /* Workflow Flow Mobile */
            .workflow-flow {
                padding: 1.25rem;
            }

            .flow-diagram {
                flex-direction: column;
                gap: 0.75rem;
                min-height: auto;
            }

            .flow-arrow {
                transform: rotate(90deg);
                width: 100%;
                height: 35px;
            }

            .flow-section.serial {
                min-width: auto;
            }

            .flow-section {
                padding: 1rem;
            }

            .flow-legend {
                flex-direction: column;
                gap: 0.6rem;
            }

            /* Metrics Mobile */
            .scaling-metrics {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.6rem;
            }

            .metric-card {
                padding: 1rem;
            }

            .metric-card .metric-value {
                font-size: 1.5rem;
            }

            .metric-card .metric-icon {
                font-size: 1.3rem;
            }

            /* Efficiency Bar Mobile */
            .efficiency-bar {
                height: 20px;
            }

            /* Workflow & scaling hints mobile â€” hidden by default, tap icon to toggle */
            .wf-info-text { font-size: 0.72rem; }
            .station-tooltip { display: none; }
            .stat-hint { font-size: 0.68rem; }
            .meter-hint { font-size: 0.62rem; }
            .metric-hint { font-size: 0.62rem; }
            .efficiency-hint { font-size: 0.68rem; }

            /* HPC Suggestions Mobile */
            .hpc-suggestions {
                padding: 1rem;
                margin-top: 1rem;
            }

            .hpc-suggestions-title {
                font-size: 0.9rem;
            }

            .suggestion-list li {
                font-size: 0.82rem;
                padding: 0.6rem 0;
            }

            /* Image Options Grid Mobile */
            .image-options {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.5rem;
            }

            .image-option {
                padding: 0.4rem;
                border-radius: 10px;
            }

            .image-option i {
                font-size: 1.5rem;
                margin-bottom: 0.3rem;
            }

            .image-option span {
                font-size: 0.65rem;
            }

            .image-option.selected::after {
                width: 16px;
                height: 16px;
                font-size: 0.5rem;
                top: 4px;
                right: 4px;
            }

            /* Render Comparison Mobile */
            .render-comparison {
                grid-template-columns: 1fr;
                gap: 1.25rem;
            }

            .render-panel {
                border-radius: 14px;
            }

            .render-header {
                padding: 1rem;
                font-size: 1rem;
            }

            .render-stats {
                grid-template-columns: repeat(2, 1fr);
                padding: 1rem;
            }

            .render-stat:last-child {
                grid-column: span 2;
            }

            /* Processor Cards Mobile */
            .processor-comparison {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .processor-card {
                padding: 1.25rem;
            }

            /* Insight Cards Mobile */
            .insight-card {
                padding: 1rem;
                gap: 0.75rem;
            }

            .insight-card i {
                font-size: 1.25rem;
            }

            .insight-card p {
                font-size: 0.9rem;
            }

            /* Amdahl Visual Mobile */
            .amdahl-bar {
                height: 24px;
            }

            /* Stats Grid Mobile */
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }

            .stat-card {
                padding: 0.85rem;
            }

            .stat-card .stat-value {
                font-size: 1.2rem;
            }
        }

        /* Mobile Small */
        @media (max-width: 480px) {
            .frontier-app {
                padding: 0.5rem;
                padding-top: 2.25rem;
            }

            .app-header h1 {
                font-size: 1.5rem;
            }

            .app-header h1 i {
                font-size: 1.3rem;
            }

            .app-header p {
                font-size: 0.9rem;
            }

            .header-content {
                padding: 1.5rem 1rem 2rem;
            }

            .module-tab {
                padding: 1rem;
            }

            .module-tab .icon {
                width: 48px;
                height: 48px;
                font-size: 1.3rem;
            }

            .image-options {
                grid-template-columns: repeat(3, 1fr);
            }

            .image-option i {
                font-size: 1.25rem;
            }

            .scaling-metrics {
                grid-template-columns: 1fr;
            }

            .resource-meters {
                grid-template-columns: 1fr;
            }

            .conveyor-system {
                height: 350px;
            }

            .station-icon {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }

            .station-label {
                font-size: 0.7rem;
                max-width: 60px;
                margin-top: 0.25rem;
            }

            .station-status {
                font-size: 0.6rem;
                margin-top: 0.08rem;
            }

            .workers-grid {
                grid-template-columns: repeat(5, 1fr);
            }

            .worker {
                width: 35px;
                height: 35px;
                font-size: 0.95rem;
            }

            .terminal-body {
                font-size: 0.7rem;
            }

            /* Touch-friendly tap targets */
            .btn {
                min-height: 48px;
            }

            .module-tab {
                min-height: 80px;
            }
        }

        /* ==================== DESKTOP: HPC Job Pipeline diagram focus ==================== */
        @media (min-width: 1024px) {
            /* Center the diagram panel and content */
            .workflow-container .panel:has(.factory-viz) {
                display: flex;
                justify-content: center;
                padding: 0;
                overflow: visible;
            }
            .factory-viz {
                max-width: 1200px;
                width: 100%;
                margin-left: auto;
                margin-right: auto;
                padding: 2.5rem 2rem;
            }
            .factory-title {
                font-size: 1.65rem;
                text-align: center;
                margin-bottom: 2rem;
                justify-content: center;
                font-weight: 700;
            }
            .factory-title i {
                font-size: 1.45rem;
            }
            .factory-desc {
                text-align: center;
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 2rem;
                font-size: 0.92rem;
            }
            .worker-viz-title {
                font-size: 1.65rem;
                margin-bottom: 2rem;
                font-weight: 700;
            }
            .worker-viz-title i {
                font-size: 1.45rem;
            }
            .worker-visualization .factory-desc {
                margin-bottom: 1.75rem;
            }
            .rs-intro-panel h2 {
                font-size: 1.85rem;
                margin-bottom: 1.5rem;
            }
            .rs-intro-panel p {
                font-size: 0.92rem;
            }
            .wf-progress {
                max-width: 800px;
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 1.75rem;
            }
            /* Center the conveyor diagram; match SVG viewBox width so path math aligns */
            .conveyor-system {
                width: 800px;
                max-width: 100%;
                margin-left: auto;
                margin-right: auto;
                height: 520px;
                margin-bottom: 0.5rem;
            }
            .conveyor-station {
                position: absolute;
            }
            .station-icon {
                width: 88px;
                height: 88px;
                font-size: 2.25rem;
            }
            .station-label {
                font-size: 1.2rem;
                margin-top: 0.5rem;
                max-width: 100px;
                font-weight: 600;
            }
            .station-status {
                font-size: 1rem;
                margin-top: 0.25rem;
            }
            /* Tighter gap between pipeline and resource meters */
            .factory-viz .resource-meters {
                margin-top: 0.4rem;
                padding: 1.5rem;
                gap: 1.25rem;
            }
            .factory-viz .meter-icon {
                width: 62px;
                height: 62px;
                font-size: 1.95rem;
            }
            .factory-viz .meter-label {
                font-size: 0.8rem;
            }
            .factory-viz .meter-value {
                font-size: 1.85rem;
            }
            /* Optimization Insights: best shape on desktop */
            .factory-viz .hpc-suggestions-title {
                font-size: 1.2rem;
            }
            .factory-viz .hpc-suggestions-title i {
                font-size: 1.1rem;
            }
            .factory-viz .suggestion-list li {
                font-size: 1rem;
                padding: 0.9rem 1.5rem;
            }
            .factory-viz .suggestion-list li i {
                font-size: 0.95rem;
            }

            /* Scaling module desktop: Serial and Parallel blocks side by side */
            #module-scaling .flow-diagram {
                flex-direction: row;
                align-items: stretch;
                gap: 1.25rem;
                min-height: 200px;
            }
            #module-scaling .flow-arrow {
                transform: none;
                width: 44px;
                flex-shrink: 0;
            }
            #module-scaling .flow-section {
                flex: 1;
                min-width: 0;
            }
            #module-scaling .flow-section.serial {
                min-width: 140px;
                flex: 0 1 28%;
            }
            #module-scaling .flow-section.parallel {
                flex: 1 1 auto;
            }

            /* CPU vs GPU module desktop */
            .render-viz-title {
                font-size: 1.65rem;
                text-align: center;
                margin-bottom: 2rem;
                justify-content: center;
                font-weight: 700;
            }
            .render-viz-title i {
                font-size: 1.45rem;
            }
            .render-viz-panel .factory-desc {
                text-align: center;
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 2rem;
                font-size: 0.92rem;
            }
            #module-cpugpu .render-comparison {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1.25rem;
                align-items: start;
            }
            #module-cpugpu .render-panel {
                min-width: 0;
            }
            #module-cpugpu .render-header {
                padding: 0.9rem 1.15rem;
                font-size: 1.15rem;
            }
            #module-cpugpu .render-header i {
                font-size: 1.2rem;
            }
            #module-cpugpu .render-stats {
                padding: 1rem 1.2rem;
                gap: 0.6rem 1rem;
            }
            #module-cpugpu .render-stat .stat-value {
                font-size: 1.35rem;
                margin-bottom: 0.2rem;
            }
            #module-cpugpu .render-stat .stat-label {
                font-size: 0.82rem;
            }
            /* GPU Advantage & Time Savings cards: larger fonts, tighter gaps */
            #module-cpugpu .speed-comparison {
                margin-top: 1.25rem;
                gap: 1.25rem;
            }
            #module-cpugpu .speed-card {
                padding: 1.35rem 1.4rem;
            }
            #module-cpugpu .speed-card h3 {
                font-size: 1.12rem;
                margin-bottom: 0.75rem;
            }
            #module-cpugpu .speed-card h3 i {
                font-size: 1.1rem;
            }
            #module-cpugpu .speedup-value,
            #module-cpugpu .speed-card .metric-value {
                font-size: 2.85rem;
            }
            #module-cpugpu .speedup-label,
            #module-cpugpu .speed-card .metric-label {
                font-size: 1rem;
                margin-top: 0.3rem;
            }
        }

        /* ==================== MODULE 4: RIGHTSIZING ==================== */

        .rightsizing-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* Intro panel */
        .rs-intro-panel {
            text-align: center;
            padding: 1.5rem 2rem 1.25rem;
            margin-bottom: -0.25rem;
        }

        .rs-intro-panel h2 {
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1.25rem;
        }

        .rs-intro-panel p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.88rem;
            max-width: 720px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .rs-intro-panel p strong {
            color: var(--frontier-primary);
        }

        /* Resource boxes row */
        .rs-boxes-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .rs-box {
            border-radius: 20px;
            padding: 1.25rem;
            background: var(--frontier-bg-panel);
            border: 2px solid var(--frontier-border);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
                        box-shadow 0.3s ease,
                        border-color 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .rs-box::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--frontier-primary), var(--frontier-info), var(--frontier-primary));
            background-size: 200% 100%;
            animation: shimmer 3s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .rs-box:hover::before {
            opacity: 1;
        }

        .rs-box-laptop .rs-box-icon-wrap {
            background: linear-gradient(135deg, var(--frontier-primary), #0d7377);
            box-shadow: 0 8px 20px rgba(24, 169, 168, 0.3);
        }
        .rs-box-workstation .rs-box-icon-wrap {
            background: linear-gradient(135deg, var(--frontier-secondary), #a01b3a);
            box-shadow: 0 8px 20px rgba(213, 35, 73, 0.3);
        }
        .rs-box-cluster .rs-box-icon-wrap {
            background: linear-gradient(135deg, var(--frontier-accent), #d97706);
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.3);
        }

        .rs-box-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .rs-box-icon-wrap {
            width: 42px;
            height: 42px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: white;
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }

        .rs-box:hover .rs-box-icon-wrap {
            transform: scale(1.1) rotate(5deg);
        }

        .rs-box-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--frontier-text);
            letter-spacing: 0.02em;
        }

        .rs-box-description {
            font-size: 0.92rem;
            color: var(--frontier-text-secondary);
            margin-bottom: 0.5rem;
            line-height: 1.45;
        }

        .rs-box-capacity {
            display: flex;
            flex-wrap: wrap;
            gap: 0.3rem;
            margin-bottom: 0.65rem;
        }

        .rs-box-capacity .rs-cap-badge {
            font-size: 0.82rem;
            padding: 0.24rem 0.65rem;
            border-radius: 999px;
            background: rgba(24, 169, 168, 0.1);
            border: 1px solid rgba(24, 169, 168, 0.25);
            color: var(--frontier-primary);
            font-weight: 600;
        }

        /* Drop area */
        .rs-box-droparea {
            min-height: 110px;
            padding: 0.5rem;
            border-radius: 14px;
            border: 2px dashed var(--frontier-border);
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            align-content: flex-start;
            transition: border-color 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

        .rs-box-droparea.rs-drop-hover {
            border-color: var(--frontier-primary);
            background: rgba(24, 169, 168, 0.06);
            box-shadow: inset 0 0 20px rgba(24, 169, 168, 0.08);
        }

        .rs-box-droparea-placeholder {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: var(--frontier-text-muted);
            font-size: 0.78rem;
            pointer-events: none;
            opacity: 0.6;
            text-align: center;
        }

        .rs-box-droparea-placeholder i {
            display: block;
            font-size: 1.3rem;
            margin-bottom: 0.3rem;
            opacity: 0.5;
        }

        /* Box react animations */
        @keyframes rs-accept-pulse {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.6); }
            100% { box-shadow: 0 0 0 14px rgba(16, 185, 129, 0); }
        }

        @keyframes rs-reject-shake {
            10%, 90% { transform: translateX(-2px); }
            20%, 80% { transform: translateX(3px); }
            30%, 50%, 70% { transform: translateX(-5px); }
            40%, 60% { transform: translateX(5px); }
        }

        .rs-box.rs-accept-anim {
            border-color: var(--frontier-success) !important;
            animation: rs-accept-pulse 0.55s ease-out;
        }

        .rs-box.rs-reject-anim {
            border-color: var(--frontier-danger) !important;
            animation: rs-reject-shake 0.35s ease-out;
        }

        .rs-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            border-color: var(--frontier-primary);
        }

        /* Task cards */
        .rs-card {
            width: 170px;
            padding: 0.75rem 0.7rem 0.7rem;
            border-radius: 16px;
            background: var(--frontier-bg-panel);
            border: 2px solid var(--frontier-border);
            box-shadow: var(--frontier-card-shadow);
            cursor: grab;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
                        box-shadow 0.3s ease,
                        border-color 0.3s ease,
                        opacity 0.25s ease;
            position: relative;
            user-select: none;
            -webkit-user-select: none;
            overflow: hidden;
            text-align: center;
        }

        /* Colored top accent strip */
        .rs-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            border-radius: 16px 16px 0 0;
            background: linear-gradient(90deg, var(--frontier-primary), #3b82f6, #8b5cf6);
            transition: height 0.3s ease;
        }

        .rs-card:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 14px 32px rgba(0, 0, 0, 0.2);
            border-color: var(--frontier-primary);
        }

        .rs-card:hover::before {
            height: 4px;
        }

        /* Task icon */
        .rs-card-icon-wrap {
            width: 44px;
            height: 44px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.5rem;
            font-size: 1.15rem;
            color: white;
            position: relative;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s ease;
        }

        .rs-card:hover .rs-card-icon-wrap {
            transform: scale(1.12) rotate(-5deg);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
        }

        /* Unified icon background â€” vibrant gradient, no tier hints */
        .rs-card .rs-card-icon-wrap {
            background: linear-gradient(135deg, var(--frontier-primary), #3b82f6, #7c3aed);
            box-shadow: 0 4px 14px rgba(59, 130, 246, 0.35);
        }

        /* Subtle icon float animation */
        @keyframes rs-icon-float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }

        .rs-card:hover .rs-card-icon-wrap i {
            animation: rs-icon-float 1.2s ease-in-out infinite;
        }

        .rs-card-title {
            font-size: 0.92rem;
            font-weight: 700;
            color: var(--frontier-text);
            margin-bottom: 0.25rem;
            line-height: 1.3;
        }

        .rs-card-desc {
            font-size: 0.82rem;
            color: var(--frontier-text-secondary);
            line-height: 1.4;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            margin: 0;
            transition: max-height 0.35s ease, opacity 0.3s ease, margin 0.3s ease;
        }

        .rs-card:hover .rs-card-desc {
            max-height: 60px;
            opacity: 1;
            margin-bottom: 0.45rem;
        }

        /* Compact requirement badges */
        .rs-card-reqs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            justify-content: center;
            align-items: center;
        }

        .rs-req-badge {
            font-size: 0.78rem;
            padding: 0.2rem 0.55rem;
            border-radius: 999px;
            background: var(--frontier-bg-alt);
            border: 1px solid var(--frontier-border);
            color: var(--frontier-text-secondary);
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }

        .rs-req-badge i {
            font-size: 0.66rem;
            opacity: 0.7;
        }

        /* Tooltip on cards (shown after check) */
        .rs-card-tooltip {
            margin-top: 0.4rem;
            font-size: 0.74rem;
            color: var(--frontier-danger);
            line-height: 1.4;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.35s ease, opacity 0.35s ease, margin 0.35s ease;
            text-align: left;
        }

        .rs-card.rs-incorrect .rs-card-tooltip {
            max-height: 80px;
            opacity: 1;
        }

        /* Dragging state */
        .rs-card.rs-origin-dragging {
            opacity: 0.3;
            transform: scale(0.95);
            pointer-events: none;
        }

        .rs-card-ghost {
            position: fixed;
            z-index: 10000;
            pointer-events: none;
            opacity: 0.92;
            transform-origin: center center;
            transition: none;
            filter: drop-shadow(0 12px 24px rgba(0,0,0,0.3));
        }

        /* Cursor styles */
        body.rs-grabbing,
        body.rs-grabbing * {
            cursor: grabbing !important;
        }

        /* Correct / incorrect animations */
        .rs-card.rs-correct {
            border-color: var(--frontier-success) !important;
            box-shadow: 0 0 18px rgba(16, 185, 129, 0.5);
        }

        .rs-card.rs-incorrect {
            border-color: var(--frontier-danger) !important;
            box-shadow: 0 0 18px rgba(239, 68, 68, 0.5);
        }

        @keyframes rs-card-shake {
            10%, 90% { transform: translateX(-2px); }
            20%, 80% { transform: translateX(3px); }
            30%, 50%, 70% { transform: translateX(-4px); }
            40%, 60% { transform: translateX(4px); }
        }

        .rs-card.rs-shake-anim {
            animation: rs-card-shake 0.5s ease-out;
        }

        @keyframes rs-card-sparkle {
            0%, 100% { box-shadow: 0 0 18px rgba(16, 185, 129, 0.5); }
            50% { box-shadow: 0 0 28px rgba(16, 185, 129, 0.8), 0 0 50px rgba(16, 185, 129, 0.3); }
        }

        .rs-card.rs-correct {
            animation: rs-card-sparkle 1.2s ease-in-out 2;
        }

        @keyframes rs-hint-pulse {
            0% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7); }
            100% { box-shadow: 0 0 0 14px rgba(245, 158, 11, 0); }
        }

        .rs-card.rs-hint-pulse {
            animation: rs-hint-pulse 0.9s ease-out;
        }

        @keyframes rs-bounce-back {
            0%   { transform: translateY(0); }
            40%  { transform: translateY(-6px); }
            100% { transform: translateY(0); }
        }

        .rs-card.rs-bounce-back {
            animation: rs-bounce-back 0.3s ease-out;
        }

        /* Deck */
        .rs-deck-panel {
            text-align: center;
        }

        .rs-deck-panel h2 {
            justify-content: center;
            font-size: 1.3rem;
        }

        .rs-task-deck {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            padding: 0.5rem 0;
        }

        /* Controls row */
        .rs-controls-row {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .rs-btn {
            padding: 0.65rem 1.5rem;
            border-radius: 12px;
            border: 2px solid var(--frontier-border);
            background: var(--frontier-bg-panel);
            color: var(--frontier-text);
            font-size: 0.92rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .rs-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .rs-btn i {
            font-size: 0.85rem;
        }

        .rs-btn-check {
            background: linear-gradient(135deg, var(--frontier-primary), var(--frontier-primary-hover));
            border-color: var(--frontier-primary);
            color: white;
        }

        .rs-btn-check:hover {
            box-shadow: 0 8px 25px rgba(24, 169, 168, 0.4);
        }

        .rs-btn-reset {
            border-color: var(--frontier-danger);
            color: var(--frontier-danger);
        }

        .rs-btn-reset:hover {
            background: rgba(239, 68, 68, 0.1);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.2);
        }

        .rs-btn-hint {
            border-color: var(--frontier-accent);
            color: var(--frontier-accent);
        }

        .rs-btn-hint:hover {
            background: rgba(245, 158, 11, 0.1);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.2);
        }

        .rs-btn-explain {
            border-color: var(--frontier-info);
            color: var(--frontier-info);
        }

        .rs-btn-explain:hover {
            background: rgba(59, 130, 246, 0.1);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
        }

        /* ---- Light-mode contrast overrides for Rightsizing ---- */
        [data-theme="light"] .rs-btn-check {
            color: white;
        }

        [data-theme="light"] .rs-btn-reset,
        [data-theme="light"] .rs-btn-hint,
        [data-theme="light"] .rs-btn-explain {
            color: #ffffff;
            background: #475569;
            border-color: #475569;
        }
        [data-theme="light"] .rs-btn-reset:hover,
        [data-theme="light"] .rs-btn-hint:hover,
        [data-theme="light"] .rs-btn-explain:hover {
            background: #334155;
            border-color: #334155;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
        }

        /* Boxes & cards â€” stronger secondary text in light mode */
        [data-theme="light"] .rs-box-description {
            color: #475569;
        }

        [data-theme="light"] .rs-card-desc {
            color: #475569;
        }

        [data-theme="light"] .rs-req-badge {
            color: #475569;
            border-color: #cbd5e1;
            background: #f1f5f9;
        }

        [data-theme="light"] .rs-req-badge i {
            opacity: 0.8;
        }

        /* Capacity badges â€” darker teal for light mode */
        [data-theme="light"] .rs-box-capacity .rs-cap-badge {
            color: #0f766e;
            background: rgba(15, 118, 110, 0.08);
            border-color: rgba(15, 118, 110, 0.3);
        }

        /* Drop area in light mode */
        [data-theme="light"] .rs-box-droparea {
            border-color: #cbd5e1;
            background: rgba(241, 245, 249, 0.5);
        }

        [data-theme="light"] .rs-box-droparea-placeholder {
            color: #64748b;
        }

        /* Feedback text in light mode */
        [data-theme="light"] .rs-concept-text,
        [data-theme="light"] .rs-hint-text,
        [data-theme="light"] .rs-score-label {
            color: #475569;
        }

        [data-theme="light"] .rs-hint-text strong {
            color: #92400e;
        }

        [data-theme="light"] .rs-explain-reason {
            color: #475569;
        }

        [data-theme="light"] .rs-explain-resource {
            color: #0f766e;
        }

        [data-theme="light"] .rs-intro-panel p {
            color: rgba(30, 41, 59, 0.7);
        }
        [data-theme="light"] .rs-intro-panel p strong {
            color: #0f766e;
        }

        /* Tooltip contrast in light mode */
        [data-theme="light"] .rs-card-tooltip {
            color: #b91c1c;
        }

        /* Feedback area */
        .rs-feedback-panel {
            min-height: 2rem;
        }

        .rs-feedback-panel:empty {
            display: none;
        }

        .rs-feedback-inner {
            padding: 1.25rem 1.5rem;
        }

        .rs-score-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .rs-score-number {
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--frontier-primary), var(--frontier-info));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .rs-score-label {
            font-size: 0.95rem;
            color: var(--frontier-text-secondary);
        }

        .rs-score-bar {
            width: 100%;
            max-width: 300px;
            height: 8px;
            background: var(--frontier-border);
            border-radius: 999px;
            overflow: hidden;
        }

        .rs-score-fill {
            height: 100%;
            border-radius: 999px;
            background: linear-gradient(90deg, var(--frontier-primary), var(--frontier-success));
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .rs-concept-text {
            text-align: center;
            font-size: 0.95rem;
            color: var(--frontier-text-secondary);
            margin-top: 0.75rem;
            line-height: 1.55;
        }

        .rs-concept-text i {
            color: var(--frontier-accent);
            margin-right: 0.35rem;
        }

        .rs-hint-text {
            font-size: 0.95rem;
            color: var(--frontier-text-secondary);
            text-align: center;
            line-height: 1.55;
        }

        .rs-hint-text strong {
            color: var(--frontier-accent);
        }

        .rs-hint-text em {
            color: var(--frontier-text);
        }

        .rs-explain-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 0.75rem;
        }

        .rs-explain-item {
            padding: 0.75rem 1rem;
            border-radius: 12px;
            background: var(--frontier-bg-alt);
            border: 1px solid var(--frontier-border);
            transition: transform 0.2s ease;
        }

        .rs-explain-item:hover {
            transform: translateY(-2px);
        }

        .rs-explain-task {
            font-weight: 700;
            font-size: 0.88rem;
            color: var(--frontier-text);
            margin-bottom: 0.15rem;
        }

        .rs-explain-resource {
            font-size: 0.82rem;
            color: var(--frontier-primary);
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .rs-explain-reason {
            font-size: 0.78rem;
            color: var(--frontier-text-secondary);
            line-height: 1.45;
        }

        /* Cards inside drop area â€” compact chip style */
        .rs-box-droparea .rs-card {
            width: auto;
            max-width: 100%;
            padding: 0.3rem 0.55rem 0.35rem;
            display: inline-flex;
            flex-direction: row;
            align-items: center;
            gap: 0.4rem;
            text-align: left;
            border-radius: 10px;
        }

        .rs-box-droparea .rs-card::before {
            display: none;
        }

        .rs-box-droparea .rs-card-icon-wrap {
            width: 28px;
            height: 28px;
            min-width: 28px;
            border-radius: 8px;
            font-size: 0.75rem;
            margin: 0;
        }

        .rs-box-droparea .rs-card-title {
            font-size: 0.78rem;
            margin-bottom: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .rs-box-droparea .rs-card-desc,
        .rs-box-droparea .rs-card-reqs,
        .rs-box-droparea .rs-card-tooltip {
            display: none;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .rs-boxes-row {
                grid-template-columns: 1fr;
            }
            .rs-box-droparea {
                min-height: 80px;
            }
        }

        @media (max-width: 768px) {
            .rs-card {
                width: 150px;
                padding: 0.6rem 0.5rem;
            }
            .rs-card-icon-wrap {
                width: 38px;
                height: 38px;
                font-size: 1rem;
            }
            .rs-card-title {
                font-size: 0.82rem;
            }
            .rs-card-desc {
                font-size: 0.72rem;
            }
            .rs-req-badge {
                font-size: 0.68rem;
            }
            .rs-boxes-row {
                gap: 0.75rem;
            }
            .rs-controls-row {
                gap: 0.5rem;
            }
            .rs-btn {
                padding: 0.55rem 1.1rem;
                font-size: 0.84rem;
            }
        }

        @media (max-width: 480px) {
            .rs-card {
                width: 140px;
            }
            .rs-card-icon-wrap {
                width: 34px;
                height: 34px;
                font-size: 0.9rem;
            }
        }

        /* Disable animations for reduced motion preference */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .module-tab,
            .panel,
            .image-option,
            .render-panel {
                border-width: 2px;
            }
        }
    </style>
</head>
<body class="Frontier is-preload">
    <div id="page-wrapper">
        <!-- Header -->
        <section id="header">
            <div id="nav-placeholder"></div>
        </section>

        <!-- Main App -->
        <section id="main">
            <div class="frontier-app">
                <!-- App Header -->
                <div class="app-header">
                    <div class="header-nav">
                        <a href="../../E-Labs.html" class="back-btn">
                            <i class="fas fa-arrow-left"></i> Back to E-Labs
                        </a>
                        <div class="header-badges">
                            <span class="header-badge"><i class="fas fa-microchip"></i> 4 Modules</span>
                            <span class="header-badge"><i class="fas fa-code-branch"></i> v1.0</span>
                        </div>
                    </div>
                    <div class="header-content">
                        <h1>
                            <span class="frontier-icon"><i class="fas fa-server"></i></span><span class="highlight">Frontier</span>
                        </h1>
                        <p>A Hands-On High Performance Computing Intuition Engine</p>
                    </div>
                </div>

                <!-- Module Tabs -->
                <div class="module-tabs">
                    <div class="module-tab active" data-module="rightsizing">
                        <div class="icon"><i class="fas fa-balance-scale"></i></div>
                        <div class="info">
                            <h3>Rightsizing</h3>
                            <p>Match Tasks to Resources</p>
                        </div>
                    </div>
                    <div class="module-tab" data-module="workflow">
                        <div class="icon"><i class="fas fa-industry"></i></div>
                        <div class="info">
                            <h3>HPC Workflow</h3>
                            <p>From Click to Results</p>
                        </div>
                    </div>
                    <div class="module-tab" data-module="scaling">
                        <div class="icon"><i class="fas fa-users-cog"></i></div>
                        <div class="info">
                            <h3>Scaling</h3>
                            <p>Why Optimization Hits a Wall</p>
                        </div>
                    </div>
                    <div class="module-tab" data-module="cpugpu">
                        <div class="icon"><i class="fas fa-bolt"></i></div>
                        <div class="info">
                            <h3>CPU vs GPU</h3>
                            <p>Parallel Processing Power</p>
                        </div>
                    </div>
                </div>

                <!-- ==================== MODULE 0: RIGHTSIZING ==================== -->
                <div class="module-content active" id="module-rightsizing">
                    <div class="rightsizing-container">
                        <!-- Intro Panel -->
                        <div class="panel rs-intro-panel">
                            <h2><i class="fas fa-balance-scale"></i> Rightsizing: Match Tasks to Resources</h2>
                            <p>
                                Not every task needs a supercomputer, and not every task fits on a laptop. 
                                <strong>Rightsizing</strong> means choosing the computing resource that best matches each job's requirements â€” saving time, money, and energy.
                                Drag each task card onto the resource where it belongs best. Look at the <strong>CPU</strong>, <strong>memory</strong>, and <strong>GPU</strong> requirements to find the right match.
                            </p>
                        </div>

                        <!-- Resource Boxes -->
                        <div class="rs-boxes-row">
                            <!-- Laptop -->
                            <div class="rs-box rs-box-laptop" data-resource="laptop">
                                <div class="rs-box-header">
                                    <div class="rs-box-icon-wrap"><i class="fas fa-laptop"></i></div>
                                    <div class="rs-box-title">Laptop</div>
                                </div>
                                <div class="rs-box-description">Lightweight, interactive workloads that complete quickly on a single machine.</div>
                                <div class="rs-box-capacity">
                                    <span class="rs-cap-badge"><i class="fas fa-microchip"></i> 4-8 cores</span>
                                    <span class="rs-cap-badge"><i class="fas fa-memory"></i> 16-32 GB RAM</span>
                                    <span class="rs-cap-badge"><i class="fas fa-times-circle"></i> No GPU</span>
                                </div>
                                <div class="rs-box-droparea" data-resource="laptop">
                                    <div class="rs-box-droparea-placeholder">
                                        <i class="fas fa-arrow-down"></i>
                                        Drop tasks here
                                    </div>
                                </div>
                            </div>

                            <!-- Workstation -->
                            <div class="rs-box rs-box-workstation" data-resource="workstation">
                                <div class="rs-box-header">
                                    <div class="rs-box-icon-wrap"><i class="fas fa-desktop"></i></div>
                                    <div class="rs-box-title">Workstation</div>
                                </div>
                                <div class="rs-box-description">Heavy local compute with optional GPU acceleration for demanding tasks.</div>
                                <div class="rs-box-capacity">
                                    <span class="rs-cap-badge"><i class="fas fa-microchip"></i> 16-64 cores</span>
                                    <span class="rs-cap-badge"><i class="fas fa-memory"></i> 64-256 GB RAM</span>
                                    <span class="rs-cap-badge"><i class="fas fa-bolt"></i> GPU 12-24 GB</span>
                                </div>
                                <div class="rs-box-droparea" data-resource="workstation">
                                    <div class="rs-box-droparea-placeholder">
                                        <i class="fas fa-arrow-down"></i>
                                        Drop tasks here
                                    </div>
                                </div>
                            </div>

                            <!-- Cluster / Supercomputer -->
                            <div class="rs-box rs-box-cluster" data-resource="cluster">
                                <div class="rs-box-header">
                                    <div class="rs-box-icon-wrap"><i class="fas fa-server"></i></div>
                                    <div class="rs-box-title">Cluster / Supercomputer</div>
                                </div>
                                <div class="rs-box-description">Distributed memory, many nodes, job scheduler, ideal for massive long-running workloads.</div>
                                <div class="rs-box-capacity">
                                    <span class="rs-cap-badge"><i class="fas fa-microchip"></i> 100s-1000s cores</span>
                                    <span class="rs-cap-badge"><i class="fas fa-memory"></i> TBs RAM</span>
                                    <span class="rs-cap-badge"><i class="fas fa-bolt"></i> Multi-GPU</span>
                                </div>
                                <div class="rs-box-droparea" data-resource="cluster">
                                    <div class="rs-box-droparea-placeholder">
                                        <i class="fas fa-arrow-down"></i>
                                        Drop tasks here
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Task Deck -->
                        <div class="panel rs-deck-panel">
                            <h2><i class="fas fa-th-large"></i> Task Deck</h2>
                            <div class="rs-task-deck" id="rs-task-deck">
                                <!-- Cards injected by JS -->
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="rs-controls-row">
                            <button class="rs-btn rs-btn-check" id="rs-btn-check"><i class="fas fa-check-double"></i> Check</button>
                            <button class="rs-btn rs-btn-reset" id="rs-btn-reset"><i class="fas fa-undo-alt"></i> Reset</button>
                            <button class="rs-btn rs-btn-hint" id="rs-btn-hint"><i class="fas fa-lightbulb"></i> Hint</button>
                            <button class="rs-btn rs-btn-explain" id="rs-btn-explain"><i class="fas fa-book-open"></i> Explain</button>
                        </div>

                        <!-- Feedback -->
                        <div class="panel rs-feedback-panel" id="rs-feedback-panel"></div>
                    </div>
                </div>

                <!-- ==================== MODULE 1: HPC WORKFLOW ==================== -->
                <div class="module-content" id="module-workflow">
                    <div class="workflow-container">
                        <!-- Controls Panel -->
                        <div class="panel">
                            <h2><i class="fas fa-sliders-h"></i> Job Configuration</h2>
                            <p class="wf-panel-desc">Configure the resources your job will request from the cluster. Use the sliders below to set how much computing power, memory, and time you need.</p>

                            <div class="control-group">
                                <label>
                                    <span><i class="fas fa-microchip"></i> CPU Cores <i class="fas fa-info-circle wf-info-icon"></i></span>
                                    <span class="value" id="cores-value">16</span>
                                </label>
                                <div class="wf-info-text">Number of processor cores for your job. More cores speed up parallel work, but over-requesting increases queue wait time.</div>
                                <input type="range" id="cores-slider" min="1" max="128" value="16">
                            </div>

                            <div class="control-group">
                                <label>
                                    <span><i class="fas fa-memory"></i> Memory (GB) <i class="fas fa-info-circle wf-info-icon"></i></span>
                                    <span class="value" id="memory-value">64</span>
                                </label>
                                <div class="wf-info-text">RAM allocated to your job in gigabytes. Larger datasets and simulations need more memory. Over-allocating can delay scheduling.</div>
                                <input type="range" id="memory-slider" min="4" max="512" value="64" step="4">
                            </div>

                            <div class="control-group">
                                <label>
                                    <span><i class="fas fa-clock"></i> Walltime (hours) <i class="fas fa-info-circle wf-info-icon"></i></span>
                                    <span class="value" id="walltime-value">2</span>
                                </label>
                                <div class="wf-info-text">Maximum time your job is allowed to run. If it exceeds this limit, the scheduler terminates it. Shorter requests get scheduled faster.</div>
                                <input type="range" id="walltime-slider" min="1" max="48" value="2">
                            </div>

                            <div class="control-group">
                                <label>
                                    <span><i class="fas fa-cube"></i> Problem Size <i class="fas fa-info-circle wf-info-icon"></i></span>
                                    <span class="value" id="problem-value">Medium</span>
                                </label>
                                <div class="wf-info-text">Scale of the computation. Larger problems demand more cores and memory to finish in a reasonable time.</div>
                                <input type="range" id="problem-slider" min="1" max="3" value="2">
                            </div>

                            <div class="btn-group">
                                <button class="btn btn-primary" id="submit-job" style="flex: 1;">
                                    <i class="fas fa-play"></i> Submit Job
                                </button>
                                <button class="btn btn-danger" id="abort-job" style="display: none;">
                                    <i class="fas fa-stop"></i> Abort
                                </button>
                            </div>

                            <!-- Terminal Output (extends into space freed by moving stats to right panel) -->
                            <div class="terminal" id="job-terminal" style="display: none;">
                                <div class="terminal-header">
                                    <div class="dot red"></div>
                                    <div class="dot yellow"></div>
                                    <div class="dot green"></div>
                                    <span>frontier-login01</span>
                                </div>
                                <div class="terminal-body" id="terminal-output"></div>
                            </div>
                        </div>

                        <!-- Factory Visualization -->
                        <div class="panel" style="padding: 0; overflow: hidden;">
                            <div class="factory-viz" id="factory-viz">
                                <p class="factory-title"><i class="fas fa-industry"></i> HPC Job Pipeline</p>
                                <p class="factory-desc">HPC stands for <strong>High-Performance Computing</strong> â€” powerful clusters of interconnected computers that solve problems too large for a single machine. This pipeline shows how a job submitted from your local computer travels through the cluster: from submission and scheduling, through execution, all the way to collecting your results.</p>

                                <!-- Overall Workflow Progress -->
                                <div class="wf-progress" id="wf-progress">
                                    <div class="wf-progress-header">
                                        <span class="wf-progress-label" id="wf-progress-label">Ready to submit</span>
                                        <span class="wf-progress-pct" id="wf-progress-pct">0%</span>
                                    </div>
                                    <div class="wf-progress-track">
                                        <div class="wf-progress-fill" id="wf-progress-fill"></div>
                                    </div>
                                    <div class="wf-progress-steps" id="wf-progress-steps"></div>
                                </div>

                                <!-- Conveyor System -->
                                <div class="conveyor-system" id="conveyor-system">
                                    <svg class="conveyor-paths" id="conveyor-paths" viewBox="0 0 800 450" preserveAspectRatio="xMidYMid meet">
                                        <!-- Paths will be drawn dynamically -->
                                    </svg>
                                    
                                    <!-- Job Package (animated) -->
                                    <div class="job-package" id="job-package">
                                        <i class="fas fa-box"></i>
                                    </div>
                                    
                                    <!-- Stations will be added dynamically -->
                                </div>

                                <!-- Workflow metrics: Runtime/Efficiency/SU Cost + Cores/Memory/I-O/Network -->
                                <div class="workflow-metrics">
                                    <div class="stats-grid" id="job-stats" style="display: none;">
                                        <div class="stat-card">
                                            <div class="stat-icon" style="color: var(--frontier-primary)"><i class="fas fa-stopwatch"></i></div>
                                            <div class="stat-value" id="stat-runtime">--</div>
                                            <div class="stat-label">Runtime</div>
                                            <div class="stat-hint">Wall-clock time from job start to finish</div>
                                        </div>
                                        <div class="stat-card">
                                            <div class="stat-icon" style="color: var(--frontier-success)"><i class="fas fa-tachometer-alt"></i></div>
                                            <div class="stat-value" id="stat-efficiency">--</div>
                                            <div class="stat-label">Efficiency</div>
                                            <div class="stat-hint">How well the allocated resources were used â€” higher is better</div>
                                        </div>
                                        <div class="stat-card">
                                            <div class="stat-icon" style="color: var(--frontier-warning)"><i class="fas fa-coins"></i></div>
                                            <div class="stat-value" id="stat-cost">--</div>
                                            <div class="stat-label">SU Cost</div>
                                            <div class="stat-hint">Service Units â€” cores x hours, how HPC centers bill usage</div>
                                        </div>
                                    </div>
                                    <div class="resource-meters" id="resource-meters">
                                        <div class="resource-meter">
                                            <div class="meter-icon" style="color: var(--frontier-primary)"><i class="fas fa-microchip"></i></div>
                                            <div class="meter-content">
                                                <div class="meter-value" id="meter-cores">0</div>
                                                <div class="meter-label">Cores</div>
                                                <div class="meter-bar"><div class="meter-fill" id="meter-cores-fill" style="width: 0%; background: var(--frontier-primary);"></div></div>
                                                <div class="meter-hint">Active CPU cores running your computation</div>
                                            </div>
                                        </div>
                                        <div class="resource-meter">
                                            <div class="meter-icon" style="color: var(--frontier-success)"><i class="fas fa-memory"></i></div>
                                            <div class="meter-content">
                                                <div class="meter-value" id="meter-memory">0</div>
                                                <div class="meter-label">Memory</div>
                                                <div class="meter-bar"><div class="meter-fill" id="meter-memory-fill" style="width: 0%; background: var(--frontier-success);"></div></div>
                                                <div class="meter-hint">RAM in use by your running job</div>
                                            </div>
                                        </div>
                                        <div class="resource-meter">
                                            <div class="meter-icon" style="color: var(--frontier-warning)"><i class="fas fa-hdd"></i></div>
                                            <div class="meter-content">
                                                <div class="meter-value" id="meter-io">0</div>
                                                <div class="meter-label">I/O</div>
                                                <div class="meter-bar"><div class="meter-fill" id="meter-io-fill" style="width: 0%; background: var(--frontier-warning);"></div></div>
                                                <div class="meter-hint">Disk read/write activity â€” data going to and from storage</div>
                                            </div>
                                        </div>
                                        <div class="resource-meter">
                                            <div class="meter-icon" style="color: var(--frontier-secondary)"><i class="fas fa-network-wired"></i></div>
                                            <div class="meter-content">
                                                <div class="meter-value" id="meter-network">0</div>
                                                <div class="meter-label">Network</div>
                                                <div class="meter-bar"><div class="meter-fill" id="meter-network-fill" style="width: 0%; background: var(--frontier-secondary);"></div></div>
                                                <div class="meter-hint">Data exchanged between compute nodes</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- HPC Suggestions Callout -->
                                <div class="hpc-suggestions" id="hpc-suggestions">
                                    <h4 class="hpc-suggestions-title">
                                        <i class="fas fa-lightbulb"></i> Optimization Insights
                                    </h4>
                                    <ul class="suggestion-list" id="suggestion-list">
                                        <!-- Suggestions added dynamically -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ==================== MODULE 2: SCALING ==================== -->
                <div class="module-content" id="module-scaling">
                    <div class="scaling-container">
                        <!-- Controls Panel -->
                        <div class="panel">
                            <h2><i class="fas fa-sliders-h"></i> Experiment Setup</h2>
                            <p class="wf-panel-desc">Explore how adding more workers (processors) affects performance. Adjust the sliders to change the workload and see the limits of parallel scaling in action.</p>

                            <div class="control-group">
                                <label>
                                    <span><i class="fas fa-boxes"></i> Work Units <i class="fas fa-info-circle wf-info-icon"></i></span>
                                    <span class="value" id="work-units-value">100</span>
                                </label>
                                <div class="wf-info-text">Total number of tasks to complete. Think of it as a pile of assignments that need grading â€” more units means more total work.</div>
                                <input type="range" id="work-units-slider" min="50" max="500" value="100" step="10">
                            </div>

                            <div class="control-group">
                                <label>
                                    <span><i class="fas fa-users"></i> Workers <i class="fas fa-info-circle wf-info-icon"></i></span>
                                    <span class="value" id="workers-value">8</span>
                                </label>
                                <div class="wf-info-text">Number of processors working at the same time. More workers can finish faster, but only for the portion of work that can be split up.</div>
                                <input type="range" id="workers-slider" min="1" max="64" value="8">
                            </div>

                            <div class="control-group">
                                <label>
                                    <span><i class="fas fa-link"></i> Serial Portion <i class="fas fa-info-circle wf-info-icon"></i></span>
                                    <span class="value" id="serial-value">10%</span>
                                </label>
                                <div class="wf-info-text">Percentage of work that must be done one step at a time and cannot be split among workers. This is the bottleneck â€” it limits how much speedup you can ever achieve.</div>
                                <input type="range" id="serial-slider" min="1" max="50" value="10">
                            </div>

                            <button class="btn btn-primary" id="run-scaling" style="width: 100%; margin-top: 0.5rem;">
                                <i class="fas fa-play"></i> Run Experiment
                            </button>

                            <!-- Amdahl's Law Visual -->
                            <div class="amdahl-visual" id="amdahl-visual">
                                <div class="amdahl-title">
                                    <i class="fas fa-exclamation-triangle"></i> Your Code Breakdown
                                </div>
                                <div class="amdahl-bar">
                                    <div class="amdahl-parallel" id="amdahl-parallel" style="width: 90%;">
                                        <i class="fas fa-bolt"></i> 90% Parallel
                                    </div>
                                    <div class="amdahl-serial" id="amdahl-serial" style="width: 10%;">
                                        10%
                                    </div>
                                </div>
                                <p class="amdahl-explanation" id="amdahl-explanation">
                                    The <strong style="color: var(--frontier-danger);">serial portion</strong> cannot be parallelized. 
                                    No matter how many workers you add, this part takes the same time!
                                </p>
                            </div>

                            <!-- Insight -->
                            <div class="insight-card" id="scaling-insight" style="display: none;">
                                <i class="fas fa-lightbulb"></i>
                                <p id="insight-text">Run an experiment to see insights.</p>
                            </div>
                        </div>

                        <!-- Worker Visualization -->
                        <div class="panel" style="padding: 0; overflow: hidden;">
                            <div class="worker-visualization" id="worker-viz">
                                <p class="worker-viz-title"><i class="fas fa-users-cog"></i> Live Scaling Simulation</p>
                                <p class="factory-desc">In HPC, throwing more processors at a problem doesn't always make it faster â€” understanding <strong>scaling</strong> is key to using resources wisely. Watch below as work is distributed in real time: the <strong>serial portion</strong> runs on a single worker first, then the <strong>parallel portion</strong> is split among all available workers simultaneously.</p>

                                <!-- Work Pile -->
                                <div class="work-pile" id="work-pile">
                                    <div class="pile-icon"><i class="fas fa-layer-group"></i></div>
                                    <div class="pile-info">
                                        <h4>Work Queue</h4>
                                        <p>Tasks waiting to be processed</p>
                                    </div>
                                    <div class="pile-count" id="pile-count">100</div>
                                </div>

                                <!-- Workers -->
                                <div class="workers-container">
                                    <div class="workers-label">
                                        <span><i class="fas fa-users"></i> Worker Pool</span>
                                        <span id="active-workers">0 / 8 active</span>
                                    </div>
                                    <div class="workers-grid" id="workers-grid">
                                        <!-- Workers added dynamically -->
                                    </div>
                                </div>

                                <!-- Serial vs Parallel Workflow - MOVED UP -->
                                <div class="workflow-flow" id="workflow-flow">
                                    <p class="workflow-flow-title">
                                        <i class="fas fa-project-diagram"></i> How Your Work Flows
                                    </p>
                                    <div class="flow-diagram">
                                        <div class="flow-section serial">
                                            <div class="flow-section-label">
                                                <i class="fas fa-link"></i> Serial
                                            </div>
                                            <div class="flow-tasks" id="serial-flow-tasks">
                                                <!-- Serial tasks added dynamically -->
                                            </div>
                                        </div>
                                        <div class="flow-arrow">
                                            <i class="fas fa-chevron-right"></i>
                                        </div>
                                        <div class="flow-section parallel">
                                            <div class="flow-section-label">
                                                <i class="fas fa-code-branch"></i> Parallel
                                            </div>
                                            <div class="parallel-lanes" id="parallel-lanes">
                                                <!-- Parallel lanes added dynamically -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flow-legend">
                                        <div class="legend-item">
                                            <div class="legend-color serial"></div>
                                            <span>Must run one-by-one</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color parallel"></div>
                                            <span>Can run simultaneously</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color waiting"></div>
                                            <span>Waiting</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Results Section -->
                                <div class="results-section">
                                    <p class="results-title"><i class="fas fa-chart-line"></i> Results</p>
                                    
                                    <!-- Metrics -->
                                    <div class="scaling-metrics" id="scaling-metrics">
                                        <div class="metric-card highlight">
                                            <div class="metric-icon"><i class="fas fa-tachometer-alt"></i></div>
                                            <div class="metric-value" id="metric-speedup">1.0Ã—</div>
                                            <div class="metric-label">Speedup</div>
                                            <div class="metric-hint">How many times faster vs. a single worker</div>
                                        </div>
                                        <div class="metric-card success">
                                            <div class="metric-icon"><i class="fas fa-percentage"></i></div>
                                            <div class="metric-value" id="metric-efficiency">100%</div>
                                            <div class="metric-label">Efficiency</div>
                                            <div class="metric-hint">How well workers are utilized â€” 100% means zero waste</div>
                                        </div>
                                        <div class="metric-card warning">
                                            <div class="metric-icon"><i class="fas fa-clock"></i></div>
                                            <div class="metric-value" id="metric-time">--</div>
                                            <div class="metric-label">Time</div>
                                            <div class="metric-hint">Simulated total time to finish all work units</div>
                                        </div>
                                        <div class="metric-card danger">
                                            <div class="metric-icon"><i class="fas fa-ban"></i></div>
                                            <div class="metric-value" id="metric-limit">--</div>
                                            <div class="metric-label">Max Possible</div>
                                            <div class="metric-hint">Amdahl's Law limit â€” adding more workers can never exceed this</div>
                                        </div>
                                    </div>

                                    <!-- Efficiency Display -->
                                    <div class="efficiency-display">
                                        <div class="efficiency-header">
                                            <span><i class="fas fa-chart-bar"></i> Parallel Efficiency</span>
                                            <span class="efficiency-value" id="efficiency-percent">100%</span>
                                        </div>
                                        <div class="efficiency-bar">
                                            <div class="efficiency-fill good" id="efficiency-fill" style="width: 100%;"></div>
                                        </div>
                                        <div class="efficiency-hint">Ratio of actual speedup to ideal speedup. Green = great use of resources, yellow = some waste, red = most workers are idle.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ==================== MODULE 3: CPU vs GPU ==================== -->
                <div class="module-content" id="module-cpugpu">
                    <div class="cpugpu-container">
                        <!-- Controls Panel -->
                        <div class="panel">
                            <h2><i class="fas fa-sliders-h"></i> Render Settings</h2>
                            <p class="wf-panel-desc">CPUs and GPUs process pixels very differently. Pick an image, choose a resolution, and watch both processors race side by side to see why GPUs dominate graphics workloads.</p>

                            <!-- Image Selection -->
                            <div class="image-selection">
                                <span class="image-selection-label"><i class="fas fa-image"></i> Choose Image to Render <i class="fas fa-info-circle wf-info-icon"></i></span>
                                <div class="wf-info-text" style="margin-bottom:0.75rem;">Each image uses a different mathematical algorithm. More complex images require more computation per pixel, making the GPU advantage even more dramatic.</div>
                                <div class="image-options">
                                    <div class="image-option selected" data-image="plasma">
                                        <i class="fas fa-fire"></i>
                                        <span>Neon Plasma</span>
                                    </div>
                                    <div class="image-option" data-image="mandelbrot">
                                        <i class="fas fa-snowflake"></i>
                                        <span>Deep Fractal</span>
                                    </div>
                                    <div class="image-option" data-image="sphere3d">
                                        <i class="fas fa-globe"></i>
                                        <span>Glass Sphere</span>
                                    </div>
                                    <div class="image-option" data-image="raymarching">
                                        <i class="fas fa-cube"></i>
                                        <span>3D Scene</span>
                                    </div>
                                    <div class="image-option" data-image="galaxy">
                                        <i class="fas fa-star"></i>
                                        <span>Spiral Galaxy</span>
                                    </div>
                                    <div class="image-option" data-image="ocean">
                                        <i class="fas fa-water"></i>
                                        <span>Ocean Sunset</span>
                                    </div>
                                    <div class="image-option" data-image="tunnel">
                                        <i class="fas fa-circle-notch"></i>
                                        <span>Neon Tunnel</span>
                                    </div>
                                    <div class="image-option" data-image="terrain3d">
                                        <i class="fas fa-mountain"></i>
                                        <span>World Map</span>
                                    </div>
                                    <div class="image-option" data-image="particles">
                                        <i class="fas fa-atom"></i>
                                        <span>Nebula</span>
                                    </div>
                                </div>
                            </div>

                            <div class="control-group">
                                <label>
                                    <span><i class="fas fa-th"></i> Resolution <i class="fas fa-info-circle wf-info-icon"></i></span>
                                    <span class="value" id="render-size-value">64Ã—64</span>
                                </label>
                                <div class="wf-info-text">Number of pixels in each direction. Higher resolution means more pixels to compute â€” the GPU advantage grows dramatically with size.</div>
                                <input type="range" id="render-size-slider" min="1" max="5" value="2">
                            </div>

                            <div class="btn-group" style="margin-top: 1rem;">
                                <button class="btn btn-primary" id="start-render" style="flex: 1;">
                                    <i class="fas fa-play"></i> Start Render
                                </button>
                                <button class="btn btn-danger" id="abort-render" style="display: none;">
                                    <i class="fas fa-stop"></i> Abort
                                </button>
                            </div>

                            <!-- Why GPU Section -->
                            <div class="why-gpu">
                                <h4><i class="fas fa-question-circle"></i> Why is GPU faster? <i class="fas fa-info-circle wf-info-icon"></i></h4>
                                <div class="wf-info-text">A CPU has a few powerful cores optimized for complex sequential tasks. A GPU has thousands of simpler cores designed to handle many calculations at once â€” perfect for pixel-level operations.</div>
                                <div class="processor-comparison">
                                    <div class="processor-card cpu-card">
                                        <h5><i class="fas fa-microchip"></i> CPU</h5>
                                        <div class="core-viz">
                                            <div class="core"></div>
                                            <div class="core"></div>
                                            <div class="core"></div>
                                            <div class="core"></div>
                                            <div class="core"></div>
                                            <div class="core"></div>
                                            <div class="core"></div>
                                            <div class="core"></div>
                                        </div>
                                        <p>8 powerful cores<br>Sequential processing</p>
                                    </div>
                                    <div class="processor-card gpu-card">
                                        <h5><i class="fas fa-bolt"></i> GPU</h5>
                                        <div class="core-viz" id="gpu-cores-viz">
                                            <!-- Many small cores -->
                                        </div>
                                        <p>1000s of simple cores<br>Massive parallelism</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Render Panel -->
                        <div class="panel render-viz-panel">
                            <p class="render-viz-title"><i class="fas fa-images"></i> Live Render Comparison</p>
                            <p class="factory-desc">A Central Processing Unit <strong>(CPU)</strong> processes pixels one by one using a few powerful cores, while a Graphics Processing Unit <strong>(GPU)</strong> computes thousands of pixels simultaneously using massively parallel architecture.</p>

                            <div class="render-comparison">
                                <!-- CPU Render -->
                                <div class="render-panel cpu">
                                    <div class="render-header">
                                        <i class="fas fa-microchip"></i> CPU
                                    </div>
                                    <div class="render-progress">
                                        <div class="render-progress-fill" id="cpu-progress" style="width: 0%;"></div>
                                    </div>
                                    <div class="render-canvas-container">
                                        <canvas id="cpu-canvas" class="render-canvas"></canvas>
                                        <div class="render-overlay" id="cpu-overlay">
                                            <i class="fas fa-image"></i>
                                            <span>Ready to render</span>
                                        </div>
                                    </div>
                                    <div class="render-stats">
                                        <div class="render-stat">
                                            <div class="stat-value" id="cpu-time">0.00s</div>
                                            <div class="stat-label">Time</div>
                                            <div class="stat-hint">Elapsed wall-clock time since the render started.</div>
                                        </div>
                                        <div class="render-stat">
                                            <div class="stat-value" id="cpu-progress-pct">0%</div>
                                            <div class="stat-label">Progress</div>
                                            <div class="stat-hint">Percentage of total pixels computed so far.</div>
                                        </div>
                                        <div class="render-stat">
                                            <div class="stat-value" id="cpu-pixels">0</div>
                                            <div class="stat-label">Pixels/s</div>
                                            <div class="stat-hint">Throughput â€” how many pixels are computed each second.</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- GPU Render -->
                                <div class="render-panel gpu">
                                    <div class="render-header">
                                        <i class="fas fa-bolt"></i> GPU
                                    </div>
                                    <div class="render-progress">
                                        <div class="render-progress-fill" id="gpu-progress" style="width: 0%;"></div>
                                    </div>
                                    <div class="render-canvas-container">
                                        <canvas id="gpu-canvas" class="render-canvas"></canvas>
                                        <div class="render-overlay" id="gpu-overlay">
                                            <i class="fas fa-image"></i>
                                            <span>Ready to render</span>
                                        </div>
                                    </div>
                                    <div class="render-stats">
                                        <div class="render-stat">
                                            <div class="stat-value" id="gpu-time">0.00s</div>
                                            <div class="stat-label">Time</div>
                                            <div class="stat-hint">Elapsed wall-clock time since the render started.</div>
                                        </div>
                                        <div class="render-stat">
                                            <div class="stat-value" id="gpu-progress-pct">0%</div>
                                            <div class="stat-label">Progress</div>
                                            <div class="stat-hint">Percentage of total pixels computed so far.</div>
                                        </div>
                                        <div class="render-stat">
                                            <div class="stat-value" id="gpu-pixels">0</div>
                                            <div class="stat-label">Pixels/s</div>
                                            <div class="stat-hint">Throughput â€” how many pixels are computed each second.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- GPU Advantage & Time Savings: two cards below the render comparison -->
                            <div class="speed-comparison" id="speed-comparison" style="display: none;">
                                <div class="speed-card">
                                    <h3><i class="fas fa-trophy"></i> GPU Advantage</h3>
                                    <div class="speedup-value" id="gpu-speedup">--Ã—</div>
                                    <div class="speedup-label">faster than CPU</div>
                                    <div class="stat-hint">How many times faster the GPU completed the render compared to the CPU.</div>
                                </div>
                                <div class="speed-card">
                                    <h3><i class="fas fa-clock"></i> GPU Time Savings</h3>
                                    <div class="metric-value" id="gpu-time-saved">--</div>
                                    <div class="metric-label">faster than CPU</div>
                                    <div class="stat-hint">Absolute time saved by using the GPU instead of the CPU for this render.</div>
                                </div>
                            </div>

                            <!-- Insight -->
                            <div class="insight-card" id="gpu-insight" style="display: none;">
                                <i class="fas fa-lightbulb"></i>
                                <p id="gpu-insight-text"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Animation Comparison Section - Full Width -->
                    <div class="panel animation-comparison-section" style="margin-top: 2rem;">
                        <h2><i class="fas fa-film"></i> Now Imagine: Animating Your <span id="anim-image-name">Neon Plasma</span></h2>
                        <p style="color: var(--frontier-text-secondary); margin-bottom: 1.5rem;">
                            You just rendered a single <strong><span id="anim-image-type">Neon Plasma</span></strong> image. But what if you wanted to create an animated GIF or video? 
                            Each frame requires the same computation. <strong>The CPU vs GPU gap becomes catastrophic.</strong>
                        </p>

                        <!-- Animation Preview showing selected image -->
                        <div class="animation-preview-row">
                            <div class="animation-preview-card">
                                <div class="preview-icon" id="anim-preview-icon">
                                    <i class="fas fa-fire"></i>
                                </div>
                                <div class="preview-info">
                                    <div class="preview-title">Selected: <span id="anim-selected-type">Neon Plasma</span></div>
                                    <div class="preview-desc">Each frame = full recalculation of every pixel</div>
                                </div>
                                <div class="preview-arrow">
                                    <i class="fas fa-arrow-right"></i>
                                </div>
                                <div class="preview-output">
                                    <i class="fas fa-film"></i>
                                    <span id="anim-frame-preview">24 frames</span>
                                </div>
                            </div>
                        </div>

                        <div class="animation-scenario">
                            <div class="animation-header">
                                <div class="animation-title">
                                    <i class="fas fa-video"></i>
                                    <span>Animated <span id="anim-title-type">Neon Plasma</span> Render</span>
                                </div>
                                <div class="animation-header-controls">
                                    <div class="frame-count-selector">
                                        <label for="frame-count">Frames:</label>
                                        <select id="frame-count">
                                            <option value="12">12 frames (0.5s GIF)</option>
                                            <option value="24" selected>24 frames (1s GIF)</option>
                                            <option value="60">60 frames (2s video)</option>
                                            <option value="120">120 frames (4s video)</option>
                                        </select>
                                    </div>
                                    <div class="animation-buttons">
                                        <button class="btn primary" id="start-animation-render">
                                            <i class="fas fa-play"></i> Start
                                        </button>
                                        <button class="btn secondary" id="reset-animation-render">
                                            <i class="fas fa-redo"></i> Reset
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- CPU Filmstrip -->
                            <div class="filmstrip-container">
                                <div class="filmstrip-label cpu">
                                    <i class="fas fa-microchip"></i> CPU - Sequential Processing (1 frame at a time)
                                </div>
                                <div class="filmstrip" id="cpu-filmstrip"></div>
                            </div>

                            <!-- GPU Filmstrip -->
                            <div class="filmstrip-container">
                                <div class="filmstrip-label gpu">
                                    <i class="fas fa-bolt"></i> GPU - Parallel Processing (8 frames at once)
                                </div>
                                <div class="filmstrip" id="gpu-filmstrip"></div>
                            </div>

                            <!-- Timeline Visualization -->
                            <div class="timeline-viz">
                                <h4><i class="fas fa-clock"></i> Time Comparison</h4>
                                <div class="timeline-row">
                                    <div class="timeline-label cpu">CPU</div>
                                    <div class="timeline-bar-container">
                                        <div class="timeline-bar cpu" id="cpu-timeline-bar" style="width: 0%;">
                                            <span id="cpu-timeline-text">0s</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="timeline-row">
                                    <div class="timeline-label gpu">GPU</div>
                                    <div class="timeline-bar-container">
                                        <div class="timeline-bar gpu" id="gpu-timeline-bar" style="width: 0%;">
                                            <span id="gpu-timeline-text">0s</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Animation Stats -->
                            <div class="animation-stats-grid">
                                <div class="animation-stat-card cpu">
                                    <div class="stat-icon"><i class="fas fa-microchip"></i></div>
                                    <div class="stat-value" id="anim-cpu-time">--</div>
                                    <div class="stat-label">CPU Total Time</div>
                                </div>
                                <div class="animation-stat-card gpu">
                                    <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                                    <div class="stat-value" id="anim-gpu-time">--</div>
                                    <div class="stat-label">GPU Total Time</div>
                                </div>
                                <div class="animation-stat-card highlight">
                                    <div class="stat-icon"><i class="fas fa-rocket"></i></div>
                                    <div class="stat-value" id="anim-speedup">--</div>
                                    <div class="stat-label">Total Speedup</div>
                                </div>
                                <div class="animation-stat-card highlight">
                                    <div class="stat-icon"><i class="fas fa-hourglass-half"></i></div>
                                    <div class="stat-value" id="anim-time-saved">--</div>
                                    <div class="stat-label">Time Saved</div>
                                </div>
                            </div>
                        </div>

                        <!-- Insight Card for Animation -->
                        <div class="insight-card" id="animation-insight" style="display: none; margin-top: 1.5rem;">
                            <i class="fas fa-exclamation-triangle" style="color: var(--frontier-accent);"></i>
                            <p id="animation-insight-text"></p>
                        </div>
                    </div>
                </div>
        </section>

        <!-- Footer -->
        <div id="footer-placeholder"></div>
    </div>

    <!-- Scripts -->
    <script src="../../assets/js/components.js"></script>
    <script src="../../assets/js/jquery.min.js"></script>
    <script src="../../assets/js/jquery.dropotron.min.js"></script>
    <script src="../../assets/js/browser.min.js"></script>
    <script src="../../assets/js/breakpoints.min.js"></script>
    <script src="../../assets/js/util.js"></script>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/theme-toggle.js"></script>
    <script>
        // Override theme toggle for Frontier app - use separate storage key and default to dark
        (function() {
            const FRONTIER_STORAGE_KEY = 'frontier-theme';
            
            // Override the toggle button's click behavior
            document.addEventListener('DOMContentLoaded', function() {
                const toggleBtn = document.querySelector('.theme-toggle-btn, [data-theme-toggle]');
                if (toggleBtn) {
                    toggleBtn.addEventListener('click', function() {
                        const currentTheme = document.documentElement.getAttribute('data-theme');
                        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                        localStorage.setItem(FRONTIER_STORAGE_KEY, newTheme);
                        localStorage.setItem('theme-preference', newTheme);
                    }, true); // Use capture to run before the default handler
                }
            });
        })();
    </script>

    <script>
        // ==================== GLOBAL UTILITIES ====================
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // ==================== TAB NAVIGATION ====================
        document.querySelectorAll('.module-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.module-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                const moduleId = tab.dataset.module;
                document.querySelectorAll('.module-content').forEach(c => c.classList.remove('active'));
                document.getElementById(`module-${moduleId}`).classList.add('active');
            });
        });

        // ==================== MODULE 0: RIGHTSIZING ====================
        (function initRightsizing() {

            /* ---- Data Model ---- */
            const RS_RESOURCES = {
                laptop: {
                    id: 'laptop', name: 'Laptop',
                    cpuCores: 8, ramGb: 32, gpuVramGb: 0,
                    runtimeClass: 'short', parallelizable: false
                },
                workstation: {
                    id: 'workstation', name: 'Workstation',
                    cpuCores: 64, ramGb: 256, gpuVramGb: 24,
                    runtimeClass: 'medium', parallelizable: true
                },
                cluster: {
                    id: 'cluster', name: 'Cluster / Supercomputer',
                    cpuCores: 4096, ramGb: 4096, gpuVramGb: 512,
                    runtimeClass: 'long', parallelizable: true
                }
            };

            const RS_TASKS = [
                // Laptop (best fit)
                { id: 'task-slides', icon: 'fa-file-powerpoint', title: 'Presentation Slides', description: 'Creating a slide deck with images and animations.', cpuCores: 2, ramGb: 4, gpuVramGb: 0, runtimeClass: 'short', parallelizable: false, ioHeavy: false, bestFit: 'laptop', why: 'Small CPU/RAM needs, highly interactive â€” a laptop is ideal.' },
                { id: 'task-spreadsheet', icon: 'fa-table', title: 'Spreadsheet Analysis', description: 'Thousands of rows with formulas and pivot tables.', cpuCores: 2, ramGb: 8, gpuVramGb: 0, runtimeClass: 'short', parallelizable: false, ioHeavy: false, bestFit: 'laptop', why: 'Fits easily in laptop memory and runs quickly.' },
                { id: 'task-lectures', icon: 'fa-graduation-cap', title: 'Online Lectures', description: 'Streaming lecture videos through a browser.', cpuCores: 2, ramGb: 8, gpuVramGb: 0, runtimeClass: 'short', parallelizable: false, ioHeavy: true, bestFit: 'laptop', why: 'Network & IO heavy but computationally trivial.' },
                { id: 'task-social', icon: 'fa-hashtag', title: 'Social Media Browsing', description: 'Multiple browser tabs with rich media feeds.', cpuCores: 4, ramGb: 16, gpuVramGb: 0, runtimeClass: 'short', parallelizable: false, ioHeavy: true, bestFit: 'laptop', why: 'Comfortably fits on a typical laptop â€” no specialized hardware needed.' },
                // Workstation (best fit)
                { id: 'task-ml', icon: 'fa-brain', title: 'ML Model Training', description: 'Millions of parameters, single GPU, hours of training.', cpuCores: 16, ramGb: 64, gpuVramGb: 16, runtimeClass: 'medium', parallelizable: true, ioHeavy: false, bestFit: 'workstation', why: 'Needs a strong GPU and more RAM than a laptop, but not a full cluster.' },
                { id: 'task-building', icon: 'fa-drafting-compass', title: 'Building Design (CAD)', description: '3D modeling and rendering of a residential building.', cpuCores: 16, ramGb: 64, gpuVramGb: 12, runtimeClass: 'medium', parallelizable: false, ioHeavy: true, bestFit: 'workstation', why: 'Graphics-intensive, local workloads are perfect for a workstation.' },
                { id: 'task-gta6', icon: 'fa-gamepad', title: 'AAA Gaming (GTA 6)', description: 'Running a high-end game at ultra resolution.', cpuCores: 12, ramGb: 32, gpuVramGb: 12, runtimeClass: 'medium', parallelizable: false, ioHeavy: true, bestFit: 'workstation', why: 'Needs a powerful GPU with low latency; overkill to use a cluster.' },
                { id: 'task-video', icon: 'fa-film', title: 'Video Editing (4K)', description: '4K timeline with effects, color grading, and exports.', cpuCores: 16, ramGb: 64, gpuVramGb: 12, runtimeClass: 'medium', parallelizable: true, ioHeavy: true, bestFit: 'workstation', why: 'High-bandwidth local workflow with GPU acceleration suits a workstation.' },
                // Cluster (best fit)
                { id: 'task-fea', icon: 'fa-cubes', title: 'Large Engineering Simulation', description: 'Large meshes, non-linear materials, many load cases.', cpuCores: 256, ramGb: 512, gpuVramGb: 0, runtimeClass: 'long', parallelizable: true, ioHeavy: false, bestFit: 'cluster', why: 'Requires huge CPU and RAM, and parallelization across many nodes.' },
                { id: 'task-spaceship', icon: 'fa-rocket', title: 'Spacecraft Trajectory', description: 'High-precision orbital simulations over long horizons.', cpuCores: 128, ramGb: 256, gpuVramGb: 0, runtimeClass: 'long', parallelizable: true, ioHeavy: false, bestFit: 'cluster', why: 'Massively parallel simulations over long durations suit a cluster.' },
                { id: 'task-autocar', icon: 'fa-car', title: 'Self-Driving Car AI', description: 'Multi-sensor deep learning across a huge dataset.', cpuCores: 512, ramGb: 1024, gpuVramGb: 256, runtimeClass: 'long', parallelizable: true, ioHeavy: true, bestFit: 'cluster', why: 'Needs multiple GPUs, huge RAM, and distributed training.' },
                { id: 'task-weather', icon: 'fa-cloud-sun-rain', title: 'National Weather Model', description: 'Continental-scale grids, data assimilation, days of runtime.', cpuCores: 2048, ramGb: 2048, gpuVramGb: 512, runtimeClass: 'long', parallelizable: true, ioHeavy: true, bestFit: 'cluster', why: 'Classic supercomputing workload needing thousands of cores.' }
            ];

            /* ---- Pure logic ---- */
            function rsFits(task, resource) {
                const reasons = [];
                if (task.cpuCores > resource.cpuCores) reasons.push('Needs ' + task.cpuCores + ' CPU cores (resource has ' + resource.cpuCores + ').');
                if (task.ramGb > resource.ramGb) reasons.push('Needs ' + task.ramGb + ' GB RAM (resource has ' + resource.ramGb + ' GB).');
                if (task.gpuVramGb > 0 && resource.gpuVramGb === 0) reasons.push('Requires a GPU â€” this resource has none.');
                else if (task.gpuVramGb > resource.gpuVramGb) reasons.push('Needs ' + task.gpuVramGb + ' GB GPU VRAM (resource has ' + resource.gpuVramGb + ' GB).');
                const order = { short: 0, medium: 1, long: 2 };
                if (order[task.runtimeClass] > order[resource.runtimeClass]) reasons.push('Runtime too long for this resource class.');
                if (task.parallelizable && !resource.parallelizable) reasons.push('This task benefits from parallelism unavailable on this resource.');
                return { ok: reasons.length === 0, reasons: reasons };
            }

            function rsScore(assignments) {
                let correct = 0, incorrect = 0;
                const breakdown = [];
                RS_TASKS.forEach(function(task) {
                    const resId = assignments[task.id] || null;
                    if (!resId) {
                        incorrect++;
                        breakdown.push({ taskId: task.id, resourceId: null, correct: false, reason: 'Not assigned.', bestFit: task.bestFit });
                        return;
                    }
                    const resource = RS_RESOURCES[resId];
                    const fit = rsFits(task, resource);
                    const isBest = resId === task.bestFit;
                    if (fit.ok && isBest) {
                        correct++;
                        breakdown.push({ taskId: task.id, resourceId: resId, correct: true, reason: 'Great match!', bestFit: task.bestFit });
                    } else {
                        incorrect++;
                        const reason = !fit.ok
                            ? 'Does not fit: ' + fit.reasons.join(' ')
                            : 'It fits here, but the best fit is ' + RS_RESOURCES[task.bestFit].name + '.';
                        breakdown.push({ taskId: task.id, resourceId: resId, correct: false, reason: reason, bestFit: task.bestFit });
                    }
                });
                return { correct: correct, incorrect: incorrect, breakdown: breakdown };
            }

            /* ---- State ---- */
            const rsState = {
                assignments: {},
                draggingTaskId: null,
                ghostEl: null,
                originCardEl: null,
                dragOffset: { x: 0, y: 0 }
            };
            RS_TASKS.forEach(function(t) { rsState.assignments[t.id] = null; });

            /* ---- DOM references ---- */
            const deck = document.getElementById('rs-task-deck');
            const feedbackPanel = document.getElementById('rs-feedback-panel');
            const dropAreas = document.querySelectorAll('.rs-box-droparea');
            const boxes = document.querySelectorAll('.rs-box');

            /* ---- Shuffle helper ---- */
            function shuffle(arr) {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    const tmp = arr[i]; arr[i] = arr[j]; arr[j] = tmp;
                }
                return arr;
            }

            /* ---- Card creation ---- */
            const cardEls = {};

            function buildCard(task) {
                const card = document.createElement('div');
                card.className = 'rs-card hover-lift';
                card.dataset.taskId = task.id;
                // Unified visual accent â€” no tier-based colour hints
                card.dataset.tier = 'neutral';

                // Build compact req badges
                var reqParts = [];
                reqParts.push('<span class="rs-req-badge"><i class="fas fa-microchip"></i> ' + task.cpuCores + '</span>');
                reqParts.push('<span class="rs-req-badge"><i class="fas fa-memory"></i> ' + task.ramGb + ' GB</span>');
                if (task.gpuVramGb > 0) {
                    reqParts.push('<span class="rs-req-badge"><i class="fas fa-bolt"></i> ' + task.gpuVramGb + ' GB</span>');
                }

                card.innerHTML =
                    '<div class="rs-card-icon-wrap"><i class="fas ' + task.icon + '"></i></div>' +
                    '<div class="rs-card-title">' + task.title + '</div>' +
                    '<div class="rs-card-desc">' + task.description + '</div>' +
                    '<div class="rs-card-reqs">' + reqParts.join('') + '</div>' +
                    '<div class="rs-card-tooltip"></div>';
                cardEls[task.id] = card;
                return card;
            }

            /* ---- Layout ---- */
            function layoutAll() {
                deck.innerHTML = '';
                var unassigned = [];
                RS_TASKS.forEach(function(t) {
                    if (!rsState.assignments[t.id]) unassigned.push(t);
                });
                shuffle(unassigned);
                unassigned.forEach(function(t) { deck.appendChild(cardEls[t.id]); });

                dropAreas.forEach(function(da) {
                    var resId = da.dataset.resource;
                    // Keep placeholder, remove cards
                    var existingCards = da.querySelectorAll('.rs-card');
                    existingCards.forEach(function(c) { c.remove(); });
                    RS_TASKS.forEach(function(t) {
                        if (rsState.assignments[t.id] === resId) {
                            da.appendChild(cardEls[t.id]);
                        }
                    });
                    // Toggle placeholder visibility
                    var placeholder = da.querySelector('.rs-box-droparea-placeholder');
                    if (placeholder) {
                        var hasCards = da.querySelectorAll('.rs-card').length > 0;
                        placeholder.style.display = hasCards ? 'none' : '';
                    }
                });
            }

            /* ---- Build cards initially ---- */
            var shuffledTasks = shuffle(RS_TASKS.slice());
            shuffledTasks.forEach(function(t) { buildCard(t); });
            layoutAll();

            /* ---- Drag & Drop ---- */
            function startDrag(cardEl, taskId, clientX, clientY) {
                rsState.draggingTaskId = taskId;
                rsState.originCardEl = cardEl;

                // Create ghost
                var ghost = cardEl.cloneNode(true);
                ghost.className = 'rs-card rs-card-ghost';
                ghost.style.width = cardEl.offsetWidth + 'px';
                document.body.appendChild(ghost);
                rsState.ghostEl = ghost;

                var rect = cardEl.getBoundingClientRect();
                rsState.dragOffset.x = clientX - rect.left;
                rsState.dragOffset.y = clientY - rect.top;

                ghost.style.left = '0px';
                ghost.style.top = '0px';
                ghost.style.transform = 'translate(' + (clientX - rsState.dragOffset.x) + 'px,' + (clientY - rsState.dragOffset.y) + 'px) scale(1.05) rotate(2deg)';

                cardEl.classList.add('rs-origin-dragging');
                document.body.classList.add('rs-grabbing');
            }

            function moveDrag(clientX, clientY) {
                if (!rsState.ghostEl) return;
                rsState.ghostEl.style.transform = 'translate(' + (clientX - rsState.dragOffset.x) + 'px,' + (clientY - rsState.dragOffset.y) + 'px) scale(1.05) rotate(2deg)';

                // Highlight drop zones
                dropAreas.forEach(function(da) {
                    var rect = da.getBoundingClientRect();
                    if (clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom) {
                        da.classList.add('rs-drop-hover');
                    } else {
                        da.classList.remove('rs-drop-hover');
                    }
                });
            }

            function endDrag(clientX, clientY) {
                if (!rsState.draggingTaskId || !rsState.ghostEl) return;

                var taskId = rsState.draggingTaskId;
                var ghost = rsState.ghostEl;
                var originCard = rsState.originCardEl;

                // Find drop target
                var droppedOn = null;
                dropAreas.forEach(function(da) {
                    var rect = da.getBoundingClientRect();
                    if (clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom) {
                        droppedOn = da.dataset.resource;
                    }
                    da.classList.remove('rs-drop-hover');
                });

                // Also check if dropped on the deck area (to unassign)
                var deckRect = deck.getBoundingClientRect();
                var droppedOnDeck = (clientX >= deckRect.left && clientX <= deckRect.right && clientY >= deckRect.top && clientY <= deckRect.bottom);

                // Cleanup
                ghost.remove();
                rsState.ghostEl = null;
                rsState.draggingTaskId = null;
                rsState.originCardEl = null;
                document.body.classList.remove('rs-grabbing');
                if (originCard) originCard.classList.remove('rs-origin-dragging');

                // Clear any previous check states
                clearCheckStates();

                if (droppedOnDeck) {
                    rsState.assignments[taskId] = null;
                    layoutAll();
                    return;
                }

                if (!droppedOn) {
                    // Bounce back
                    var card = cardEls[taskId];
                    if (card) {
                        card.classList.add('rs-bounce-back');
                        setTimeout(function() { card.classList.remove('rs-bounce-back'); }, 300);
                    }
                    return;
                }

                // Assign
                rsState.assignments[taskId] = droppedOn;
                layoutAll();

                // Box animation feedback
                var task = RS_TASKS.find(function(t) { return t.id === taskId; });
                var box = document.querySelector('.rs-box[data-resource="' + droppedOn + '"]');
                if (box && task) {
                    var fit = rsFits(task, RS_RESOURCES[droppedOn]);
                    box.classList.remove('rs-accept-anim', 'rs-reject-anim');
                    void box.offsetWidth; // force reflow
                    box.classList.add(fit.ok ? 'rs-accept-anim' : 'rs-reject-anim');
                    setTimeout(function() { box.classList.remove('rs-accept-anim', 'rs-reject-anim'); }, 600);
                }
            }

            /* ---- Mouse events ---- */
            var rsRoot = document.getElementById('module-rightsizing');
            rsRoot.addEventListener('mousedown', function(e) {
                var card = e.target.closest('.rs-card');
                if (!card || card.classList.contains('rs-card-ghost')) return;
                var taskId = card.dataset.taskId;
                if (!taskId) return;
                e.preventDefault();
                startDrag(card, taskId, e.clientX, e.clientY);
            });

            rsRoot.addEventListener('touchstart', function(e) {
                var card = e.target.closest('.rs-card');
                if (!card || card.classList.contains('rs-card-ghost')) return;
                var taskId = card.dataset.taskId;
                if (!taskId) return;
                e.preventDefault();
                var touch = e.touches[0];
                startDrag(card, taskId, touch.clientX, touch.clientY);
            }, { passive: false });

            window.addEventListener('mousemove', function(e) {
                if (!rsState.ghostEl) return;
                e.preventDefault();
                moveDrag(e.clientX, e.clientY);
            });

            window.addEventListener('touchmove', function(e) {
                if (!rsState.ghostEl) return;
                e.preventDefault();
                var touch = e.touches[0];
                moveDrag(touch.clientX, touch.clientY);
            }, { passive: false });

            window.addEventListener('mouseup', function(e) {
                if (!rsState.ghostEl) return;
                endDrag(e.clientX, e.clientY);
            });

            window.addEventListener('touchend', function(e) {
                if (!rsState.ghostEl) return;
                var touch = e.changedTouches[0];
                endDrag(touch.clientX, touch.clientY);
            });

            /* ---- Clear check visual states ---- */
            function clearCheckStates() {
                RS_TASKS.forEach(function(t) {
                    var card = cardEls[t.id];
                    if (!card) return;
                    card.classList.remove('rs-correct', 'rs-incorrect', 'rs-shake-anim', 'rs-hint-pulse');
                    var tip = card.querySelector('.rs-card-tooltip');
                    if (tip) tip.textContent = '';
                });
                feedbackPanel.innerHTML = '';
            }

            /* ---- Check ---- */
            document.getElementById('rs-btn-check').addEventListener('click', function() {
                clearCheckStates();
                var results = rsScore(rsState.assignments);

                results.breakdown.forEach(function(item) {
                    var card = cardEls[item.taskId];
                    if (!card) return;
                    if (item.correct) {
                        card.classList.add('rs-correct');
                    } else {
                        card.classList.add('rs-incorrect', 'rs-shake-anim');
                        var tip = card.querySelector('.rs-card-tooltip');
                        if (tip) tip.textContent = item.reason;
                        setTimeout(function() { card.classList.remove('rs-shake-anim'); }, 550);
                    }
                });

                var total = RS_TASKS.length;
                var pct = Math.round((results.correct / total) * 100);
                var concept = results.correct === total
                    ? '<i class="fas fa-trophy"></i> Perfect! You matched every task to its best computing resource.'
                    : results.correct >= total * 0.75
                    ? '<i class="fas fa-star-half-alt"></i> Great work! Check the red cards â€” look at their requirements to spot the mismatch.'
                    : '<i class="fas fa-lightbulb"></i> Compare each card\'s requirements (cores, RAM, GPU) with the resource capacities. Focus on the dominant bottleneck.';

                feedbackPanel.innerHTML =
                    '<div class="rs-feedback-inner">' +
                        '<div class="rs-score-display">' +
                            '<span class="rs-score-number">' + results.correct + ' / ' + total + '</span>' +
                            '<div class="rs-score-bar"><div class="rs-score-fill" style="width: ' + pct + '%"></div></div>' +
                        '</div>' +
                        '<div class="rs-concept-text">' + concept + '</div>' +
                    '</div>';
            });

            /* ---- Reset ---- */
            document.getElementById('rs-btn-reset').addEventListener('click', function() {
                RS_TASKS.forEach(function(t) { rsState.assignments[t.id] = null; });
                clearCheckStates();
                layoutAll();
            });

            /* ---- Hint ---- */
            document.getElementById('rs-btn-hint').addEventListener('click', function() {
                clearCheckStates();
                var results = rsScore(rsState.assignments);
                var target = results.breakdown.find(function(b) { return !b.correct; });
                if (!target) {
                    feedbackPanel.innerHTML =
                        '<div class="rs-feedback-inner"><div class="rs-hint-text"><i class="fas fa-check-circle" style="color:var(--frontier-success);margin-right:0.4rem;"></i>All current assignments look correct!</div></div>';
                    return;
                }

                var task = RS_TASKS.find(function(t) { return t.id === target.taskId; });
                var resource = target.resourceId ? RS_RESOURCES[target.resourceId] : null;
                var limiting = 'its requirements';

                if (!resource) {
                    limiting = task.gpuVramGb > 0 ? 'GPU' : task.ramGb > 64 ? 'RAM' : task.cpuCores > 16 ? 'CPU cores' : 'runtime class';
                } else {
                    var fit = rsFits(task, resource);
                    var txt = fit.reasons.join(' ');
                    if (/GPU/.test(txt)) limiting = 'GPU';
                    else if (/RAM/.test(txt)) limiting = 'RAM';
                    else if (/cores/.test(txt) || /CPU/.test(txt)) limiting = 'CPU cores';
                    else if (/Runtime/.test(txt) || /long/.test(txt)) limiting = 'runtime';
                    else if (/parallelism/.test(txt)) limiting = 'parallelism';
                    else limiting = 'the best fit resource';
                }

                feedbackPanel.innerHTML =
                    '<div class="rs-feedback-inner"><div class="rs-hint-text">' +
                    '<i class="fas fa-lightbulb" style="color:var(--frontier-accent);margin-right:0.4rem;"></i>' +
                    'Focus on <strong>' + limiting.toUpperCase() + '</strong> for: <em>' + task.title + '</em>. ' +
                    'Compare the card\'s requirements with each resource\'s capacity.' +
                    '</div></div>';

                var card = cardEls[task.id];
                if (card) {
                    card.classList.add('rs-hint-pulse');
                    setTimeout(function() { card.classList.remove('rs-hint-pulse'); }, 1000);
                }
            });

            /* ---- Explain ---- */
            document.getElementById('rs-btn-explain').addEventListener('click', function() {
                clearCheckStates();
                var items = RS_TASKS.map(function(t) {
                    var res = RS_RESOURCES[t.bestFit];
                    return '<li class="rs-explain-item">' +
                        '<div class="rs-explain-task"><i class="fas ' + t.icon + '" style="margin-right:0.3rem;color:var(--frontier-primary);"></i>' + t.title + '</div>' +
                        '<div class="rs-explain-resource"><i class="fas fa-arrow-right" style="margin-right:0.3rem;"></i>' + res.name + '</div>' +
                        '<div class="rs-explain-reason">' + t.why + '</div>' +
                    '</li>';
                }).join('');

                feedbackPanel.innerHTML =
                    '<div class="rs-feedback-inner">' +
                        '<h3 style="text-align:center;color:var(--frontier-text);margin:0 0 1rem;font-size:1.1rem;">' +
                        '<i class="fas fa-book-open" style="color:var(--frontier-info);margin-right:0.4rem;"></i>Why Each Task Belongs Where It Does</h3>' +
                        '<ul class="rs-explain-list">' + items + '</ul>' +
                    '</div>';
            });

        })();

        // ==================== MODULE 1: HPC WORKFLOW ====================

        /* Info-icon tap/click toggle for slider hints */
        const _infoParents = '.control-group, .image-selection, .why-gpu';
        document.querySelectorAll('.wf-info-icon').forEach(function(icon) {
            icon.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                var group = icon.closest(_infoParents);
                if (group) group.classList.toggle('wf-info-active');
            });
        });
        /* Close open hints when clicking elsewhere */
        document.addEventListener('click', function(e) {
            if (!e.target.closest(_infoParents)) {
                document.querySelectorAll(_infoParents.split(', ').map(s => s + '.wf-info-active').join(', ')).forEach(function(g) {
                    g.classList.remove('wf-info-active');
                });
            }
        });

        const workflowStations = [
            { id: 'submit', icon: 'fa-paper-plane', label: 'Submit', color: '#18a9a8', x: 50, y: 30, tip: 'Your job script is sent to the HPC scheduler for processing.' },
            { id: 'validate', icon: 'fa-check-circle', label: 'Validate', color: '#3b82f6', x: 200, y: 30, tip: 'The scheduler checks that your resource request and script are valid.' },
            { id: 'queue', icon: 'fa-clock', label: 'Queue', color: '#f59e0b', x: 350, y: 30, tip: 'Your job waits in line until the requested resources become available.' },
            { id: 'schedule', icon: 'fa-calendar-check', label: 'Schedule', color: '#8b5cf6', x: 500, y: 30, tip: 'The scheduler picks a time slot and a set of nodes for your job.' },
            { id: 'allocate', icon: 'fa-server', label: 'Allocate', color: '#ec4899', x: 650, y: 30, tip: 'Compute nodes are reserved and configured with the cores and memory you requested.' },
            { id: 'transfer', icon: 'fa-exchange-alt', label: 'Transfer', color: '#14b8a6', x: 650, y: 180, tip: 'Input files and data are copied from storage to the compute nodes.' },
            { id: 'execute', icon: 'fa-cogs', label: 'Execute', color: '#10b981', x: 350, y: 180, tip: 'Your code runs on the allocated nodes â€” this is where the actual computation happens.' },
            { id: 'collect', icon: 'fa-download', label: 'Collect', color: '#06b6d4', x: 50, y: 180, tip: 'Output files and results are gathered back to shared storage.' },
            { id: 'complete', icon: 'fa-flag-checkered', label: 'Complete', color: '#22c55e', x: 50, y: 330, tip: 'The job is finished. Resources are released and your results are ready.' }
        ];

        let workflowAborted = false;
        let workflowRunning = false;

        // Initialize factory visualization
        function initFactory() {
            const container = document.getElementById('conveyor-system');
            const svg = document.getElementById('conveyor-paths');
            
            // Clear existing stations
            container.querySelectorAll('.conveyor-station').forEach(s => s.remove());
            
            // Create stations â€” match CSS breakpoints so path centers align with icon centers
            const w = window.innerWidth;
            const iconSize = w >= 1024 ? 88 : (w > 768 ? 62 : 48);
            workflowStations.forEach(station => {
                const stationEl = document.createElement('div');
                stationEl.className = 'conveyor-station';
                stationEl.id = `station-${station.id}`;
                stationEl.style.left = `${station.x}px`;
                stationEl.style.top = `${station.y}px`;
                stationEl.innerHTML = `
                    <div class="station-icon waiting" style="background: ${station.color}; width: ${iconSize}px; height: ${iconSize}px;">
                        <i class="fas ${station.icon}"></i>
                    </div>
                    <div class="station-label">${station.label}</div>
                    <div class="station-status" id="status-${station.id}">Waiting</div>
                    <div class="station-tooltip">${station.tip}</div>
                `;
                container.appendChild(stationEl);
            });
            // Draw conveyor paths
            const paths = [
                { from: 0, to: 1 }, { from: 1, to: 2 }, { from: 2, to: 3 }, { from: 3, to: 4 },
                { from: 4, to: 5 }, { from: 5, to: 6 }, { from: 6, to: 7 }, { from: 7, to: 8 }
            ];
            let pathsHTML = '';
            // Offset line up so it aligns with visual center of icon (icons often sit slightly high in box)
            const lineYOffset = -8;
            paths.forEach((path, idx) => {
                const from = workflowStations[path.from];
                const to = workflowStations[path.to];
                const x1 = from.x + iconSize/2;
                const y1 = from.y + iconSize/2 + lineYOffset;
                const x2 = to.x + iconSize/2;
                const y2 = to.y + iconSize/2 + lineYOffset;
                pathsHTML += `
                    <path class="conveyor-path" d="M${x1},${y1} L${x2},${y2}" />
                    <path class="conveyor-path-active" id="path-${idx}" d="M${x1},${y1} L${x2},${y2}" />
                `;
            });
            svg.innerHTML = pathsHTML;
        }

        // Slider updates
        document.getElementById('cores-slider').addEventListener('input', (e) => {
            document.getElementById('cores-value').textContent = e.target.value;
        });

        document.getElementById('memory-slider').addEventListener('input', (e) => {
            document.getElementById('memory-value').textContent = e.target.value;
        });

        document.getElementById('walltime-slider').addEventListener('input', (e) => {
            document.getElementById('walltime-value').textContent = e.target.value;
        });

        document.getElementById('problem-slider').addEventListener('input', (e) => {
            const sizes = ['Small', 'Medium', 'Large'];
            document.getElementById('problem-value').textContent = sizes[e.target.value - 1];
        });

        // Abort job
        document.getElementById('abort-job').addEventListener('click', () => {
            workflowAborted = true;
        });

        // Submit job
        document.getElementById('submit-job').addEventListener('click', async () => {
            if (workflowRunning) return;
            workflowRunning = true;
            workflowAborted = false;
            
            const btn = document.getElementById('submit-job');
            const abortBtn = document.getElementById('abort-job');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Running...';
            abortBtn.style.display = 'flex';
            
            // Get values
            const cores = parseInt(document.getElementById('cores-slider').value);
            const memory = parseInt(document.getElementById('memory-slider').value);
            const problemSize = parseInt(document.getElementById('problem-slider').value);
            
            // Reset visualization
            initFactory();
            document.getElementById('job-terminal').style.display = 'flex';
            document.getElementById('terminal-output').innerHTML = '';
            document.getElementById('job-stats').style.display = 'none';

            // Reset progress bar
            const progRoot = document.getElementById('wf-progress');
            const progFill = document.getElementById('wf-progress-fill');
            const progLabel = document.getElementById('wf-progress-label');
            const progPct = document.getElementById('wf-progress-pct');
            const progSteps = document.getElementById('wf-progress-steps');
            progRoot.className = 'wf-progress running';
            progFill.style.width = '0%';
            progLabel.textContent = 'Starting\u2026';
            progPct.textContent = '0%';
            progSteps.innerHTML = workflowStations.map(() => '<span class="wf-progress-dot"></span>').join('');
            
            const pkg = document.getElementById('job-package');
            pkg.classList.add('visible');
            
            // Reset meters
            updateMeter('cores', 0, 128);
            updateMeter('memory', 0, 512);
            updateMeter('io', 0, 100);
            updateMeter('network', 0, 100);
            
            const stepsData = [
                { station: 'submit', msg: 'Submitting job to scheduler...', delay: 500 },
                { station: 'validate', msg: 'Validating job script...', delay: 400 },
                { station: 'queue', msg: 'Job queued. Waiting for resources...', delay: 1500 },
                { station: 'schedule', msg: 'Job scheduled for execution', delay: 600 },
                { station: 'allocate', msg: `Allocating ${cores} cores and ${memory}GB RAM...`, delay: 800 },
                { station: 'transfer', msg: 'Transferring input data to compute nodes...', delay: 700 },
                { station: 'execute', msg: 'Executing computation...', delay: 2000, isExecution: true },
                { station: 'collect', msg: 'Collecting output files...', delay: 600 },
                { station: 'complete', msg: 'Job completed successfully!', delay: 300 }
            ];
            
            for (let i = 0; i < stepsData.length; i++) {
                if (workflowAborted) break;
                const step = stepsData[i];
                const stationIdx = workflowStations.findIndex(s => s.id === step.station);
                const station = workflowStations[stationIdx];
                const stationEl = document.getElementById(`station-${station.id}`);
                // Mobile: move job-package outside highlighted section
                if (window.innerWidth <= 768) {
                    const conveyor = document.getElementById('conveyor-system');
                    conveyor.parentNode.insertBefore(pkg, conveyor.nextSibling);
                    pkg.style.position = 'static';
                    pkg.style.left = '';
                    pkg.style.top = '';
                } else {
                    // Desktop: animate package movement
                    await animatePackage(pkg, station.x + 15, station.y + 15);
                }
                // Update progress bar
                const pctDone = Math.round(((i + 1) / stepsData.length) * 100);
                progFill.style.width = pctDone + '%';
                progPct.textContent = pctDone + '%';
                progLabel.textContent = step.msg.replace('...', '').replace(/\.$/, '');
                const dots = progSteps.querySelectorAll('.wf-progress-dot');
                if (dots[i]) dots[i].classList.add('reached');

                // Activate station
                const stationIcon = document.querySelector(`#station-${step.station} .station-icon`);
                stationIcon.classList.remove('waiting');
                stationIcon.classList.add('active');
                document.getElementById(`status-${step.station}`).textContent = 'Processing...';
                
                // Activate path
                if (i > 0) {
                    const pathEl = document.getElementById(`path-${i - 1}`);
                    pathEl.style.strokeDashoffset = '0';
                    pathEl.style.transition = 'stroke-dashoffset 0.5s ease';
                }
                
                // Add terminal line
                addTerminalLine(step.msg, step.station === 'complete' ? 'success' : '');
                
                // Update meters during execution
                if (step.isExecution) {
                    updateMeter('cores', cores, 128);
                    updateMeter('memory', memory, 512);
                    
                    for (let p = 0; p <= 100 && !workflowAborted; p += 10) {
                        updateMeter('io', 30 + Math.random() * 40, 100);
                        updateMeter('network', 20 + Math.random() * 30, 100);
                        addTerminalLine(`  Progress: ${p}%`, 'comment');
                        await sleep(step.delay / 10);
                    }
                } else {
                    await sleep(step.delay);
                }
                
                // Complete station
                stationIcon.classList.remove('active');
                stationIcon.classList.add('completed');
                document.getElementById(`status-${step.station}`).textContent = 'Done';
            }
            
            if (workflowAborted) {
                addTerminalLine('Job aborted by user', 'error');
                pkg.classList.remove('visible');
                document.getElementById('hpc-suggestions').classList.remove('visible');
                progRoot.className = 'wf-progress aborted';
                progLabel.textContent = 'Job aborted';
            } else {
                // Mark progress complete
                progRoot.className = 'wf-progress done';
                progLabel.textContent = 'Job completed';
                progPct.textContent = '100%';
                progFill.style.width = '100%';
                // Show stats
                document.getElementById('job-stats').style.display = 'grid';
                const runtime = (5 + Math.random() * 3).toFixed(1);
                const efficiency = Math.max(60, 100 - cores * 0.4 + Math.random() * 10).toFixed(0);
                const suCost = (cores * parseFloat(runtime) / 60).toFixed(1);
                
                document.getElementById('stat-runtime').textContent = runtime + 's';
                document.getElementById('stat-efficiency').textContent = efficiency + '%';
                document.getElementById('stat-cost').textContent = suCost + ' SU';
                
                // Generate and show suggestions
                showHPCSuggestions(cores, memory, problemSize, parseFloat(efficiency), parseFloat(runtime), parseFloat(suCost));
            }
            
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-play"></i> Submit Job';
            abortBtn.style.display = 'none';
            workflowRunning = false;
        });

        async function animatePackage(pkg, x, y) {
            pkg.style.transition = 'left 0.4s ease, top 0.4s ease';
            pkg.style.left = x + 'px';
            pkg.style.top = y + 'px';
            await sleep(400);
        }

        function updateMeter(type, value, max) {
            document.getElementById(`meter-${type}`).textContent = Math.round(value);
            document.getElementById(`meter-${type}-fill`).style.width = (value / max * 100) + '%';
        }

        function addTerminalLine(text, type = '') {
            const output = document.getElementById('terminal-output');
            const line = document.createElement('div');
            line.className = 'terminal-line';
            line.innerHTML = type ? `<span class="${type}">${text}</span>` : text;
            output.appendChild(line);
            // Scroll only inside the terminal so the new line is visible; do not move the page (focus stays on HPC Job Pipeline)
            output.scrollTop = output.scrollHeight;
        }

        function showHPCSuggestions(cores, memory, problemSize, efficiency, runtime, suCost) {
            const suggestions = [];
            const sizes = ['Small', 'Medium', 'Large'];
            const problemName = sizes[problemSize - 1];
            
            // Efficiency-based suggestions
            if (efficiency < 70) {
                suggestions.push({
                    type: 'warning',
                    icon: 'fa-exclamation-circle',
                    text: `Efficiency is ${efficiency.toFixed(0)}%. Consider reducing cores to ${Math.ceil(cores * 0.6)} - you may get similar runtime at lower cost.`
                });
            } else if (efficiency > 85) {
                suggestions.push({
                    type: 'good',
                    icon: 'fa-check-circle',
                    text: `Great efficiency at ${efficiency.toFixed(0)}%! Your job is making good use of allocated resources.`
                });
            }
            
            // Core count suggestions
            if (cores > 64 && problemSize < 3) {
                suggestions.push({
                    type: 'tip',
                    icon: 'fa-lightbulb',
                    text: `${cores} cores for a ${problemName} problem may be overkill. Try 32-64 cores first to find the sweet spot.`
                });
            }
            
            if (cores < 8 && problemSize === 3) {
                suggestions.push({
                    type: 'tip',
                    icon: 'fa-rocket',
                    text: `Large problems benefit from more parallelism. Consider increasing to 32+ cores for faster completion.`
                });
            }
            
            // Memory suggestions
            if (memory > 256 && problemSize < 3) {
                suggestions.push({
                    type: 'warning',
                    icon: 'fa-memory',
                    text: `${memory}GB RAM allocated but likely not fully used. Right-sizing memory can reduce queue wait times.`
                });
            }
            
            // Cost suggestions
            if (suCost > 5) {
                suggestions.push({
                    type: 'tip',
                    icon: 'fa-coins',
                    text: `Job costs ${suCost} SU. Consider running a smaller test first, then scale up once you've validated your approach.`
                });
            }
            
            // General best practices
            if (suggestions.length < 2) {
                suggestions.push({
                    type: 'tip',
                    icon: 'fa-info-circle',
                    text: 'Pro tip: Always start with smaller resource requests and scale up. It\'s easier to get allocations for smaller jobs!'
                });
            }
            
            // Render suggestions
            const list = document.getElementById('suggestion-list');
            list.innerHTML = suggestions.map(s => 
                `<li class="${s.type}"><i class="fas ${s.icon}"></i><span>${s.text}</span></li>`
            ).join('');
            
            document.getElementById('hpc-suggestions').classList.add('visible');
            // Keep focus on the diagram: scroll pipeline + insights into view, not the terminal
            document.getElementById('factory-viz').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Initialize factory on load
        initFactory();

        // ==================== MODULE 2: SCALING ====================
        let scalingRunning = false;

        // Initialize workers grid
        function initWorkersGrid(count) {
            const grid = document.getElementById('workers-grid');
            grid.innerHTML = '';
            for (let i = 0; i < count; i++) {
                const worker = document.createElement('div');
                worker.className = 'worker idle';
                worker.id = `worker-${i}`;
                worker.innerHTML = '<i class="fas fa-user"></i>';
                grid.appendChild(worker);
            }
        }

        // Slider updates
        document.getElementById('workers-slider').addEventListener('input', (e) => {
            const count = parseInt(e.target.value);
            document.getElementById('workers-value').textContent = count;
            document.getElementById('active-workers').textContent = `0 / ${count} active`;
            initWorkersGrid(count);
            updateAmdahlLimit();
            initWorkflowFlow(
                parseInt(document.getElementById('work-units-slider').value),
                count,
                parseInt(document.getElementById('serial-slider').value) / 100
            );
        });

        document.getElementById('serial-slider').addEventListener('input', (e) => {
            const serial = parseInt(e.target.value);
            document.getElementById('serial-value').textContent = serial + '%';
            
            // Update Amdahl visual
            document.getElementById('amdahl-parallel').style.width = (100 - serial) + '%';
            document.getElementById('amdahl-parallel').innerHTML = `<i class="fas fa-bolt"></i> ${100 - serial}% Parallel`;
            document.getElementById('amdahl-serial').style.width = serial + '%';
            document.getElementById('amdahl-serial').textContent = serial + '%';
            
            updateAmdahlLimit();
            initWorkflowFlow(
                parseInt(document.getElementById('work-units-slider').value),
                parseInt(document.getElementById('workers-slider').value),
                serial / 100
            );
        });

        document.getElementById('work-units-slider').addEventListener('input', (e) => {
            document.getElementById('work-units-value').textContent = e.target.value;
            document.getElementById('pile-count').textContent = e.target.value;
            initWorkflowFlow(
                parseInt(e.target.value),
                parseInt(document.getElementById('workers-slider').value),
                parseInt(document.getElementById('serial-slider').value) / 100
            );
        });

        function updateAmdahlLimit() {
            const serial = parseInt(document.getElementById('serial-slider').value) / 100;
            const limit = 1 / serial;
            document.getElementById('metric-limit').textContent = limit.toFixed(1) + 'Ã—';
        }

        // Run scaling experiment
        document.getElementById('run-scaling').addEventListener('click', async () => {
            if (scalingRunning) return;
            scalingRunning = true;
            
            const btn = document.getElementById('run-scaling');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Running...';
            
            const workUnits = parseInt(document.getElementById('work-units-slider').value);
            const workers = parseInt(document.getElementById('workers-slider').value);
            const serialFraction = parseInt(document.getElementById('serial-slider').value) / 100;
            
            // Reset
            document.getElementById('pile-count').textContent = workUnits;
            initWorkersGrid(workers);
            initWorkflowFlow(workUnits, workers, serialFraction);
            
            // Calculate times
            const serialWork = Math.ceil(workUnits * serialFraction);
            const parallelWork = workUnits - serialWork;
            const serialTime = serialWork * 20; // 20ms per unit
            const parallelTime = Math.ceil(parallelWork / workers) * 20;
            const totalTime = serialTime + parallelTime;
            const baseTime = workUnits * 20; // Time with 1 worker
            const tasksPerLane = Math.ceil(parallelWork / workers);
            
            // Theoretical values
            const speedup = baseTime / totalTime;
            const efficiency = (speedup / workers) * 100;
            const amdahlLimit = 1 / serialFraction;
            
            // Animate serial portion first
            let remaining = workUnits;
            
            document.getElementById('active-workers').textContent = `1 / ${workers} active (serial)`;
            document.getElementById('worker-0').classList.remove('idle');
            document.getElementById('worker-0').classList.add('working');
            
            // Process serial work
            for (let i = 0; i < serialWork && remaining > 0; i++) {
                remaining--;
                document.getElementById('pile-count').textContent = remaining;
                const pct = ((workUnits - remaining) / workUnits) * 100;
                updateScalingMetrics(1, 100, pct * baseTime / 100);
                animateSerialFlow(i, serialWork);
                await sleep(15);
            }
            
            // Now parallel portion - all workers active
            document.getElementById('active-workers').textContent = `${workers} / ${workers} active (parallel)`;
            document.querySelectorAll('.worker').forEach(w => {
                w.classList.remove('idle');
                w.classList.add('working');
            });
            
            // Mark overhead workers if efficiency is low
            if (efficiency < 50) {
                const overheadCount = Math.floor(workers * (1 - efficiency / 100));
                for (let i = workers - overheadCount; i < workers; i++) {
                    document.getElementById(`worker-${i}`).classList.remove('working');
                    document.getElementById(`worker-${i}`).classList.add('overhead');
                }
            }
            
            // Process parallel work
            let parallelProgress = 0;
            const unitsPerWorker = Math.ceil(parallelWork / workers);
            for (let i = 0; i < unitsPerWorker && remaining > 0; i++) {
                const processed = Math.min(workers, remaining);
                remaining -= processed;
                parallelProgress += processed;
                document.getElementById('pile-count').textContent = remaining;
                
                const elapsed = serialTime + (i + 1) * 20;
                const currentSpeedup = (baseTime * ((workUnits - remaining) / workUnits)) / elapsed;
                const currentEfficiency = (currentSpeedup / workers) * 100;
                
                updateScalingMetrics(currentSpeedup, currentEfficiency, elapsed);
                animateParallelFlow(parallelProgress, parallelWork, workers, tasksPerLane);
                await sleep(15);
            }
            
            // Complete the workflow flow visualization
            completeWorkflowFlow();
            
            // Final state
            document.querySelectorAll('.worker').forEach(w => {
                w.classList.remove('working', 'overhead');
                w.classList.add('idle');
            });
            
            document.getElementById('active-workers').textContent = `0 / ${workers} active`;
            document.getElementById('metric-speedup').textContent = speedup.toFixed(1) + 'Ã—';
            document.getElementById('metric-efficiency').textContent = efficiency.toFixed(0) + '%';
            document.getElementById('metric-time').textContent = (totalTime / 1000).toFixed(2) + 's';
            document.getElementById('metric-limit').textContent = amdahlLimit.toFixed(1) + 'Ã—';
            
            // Update efficiency bar
            const effFill = document.getElementById('efficiency-fill');
            effFill.style.width = efficiency + '%';
            effFill.className = 'efficiency-fill ' + (efficiency > 70 ? 'good' : efficiency > 40 ? 'medium' : 'poor');
            document.getElementById('efficiency-percent').textContent = efficiency.toFixed(0) + '%';
            
            // Show insight
            const insight = document.getElementById('scaling-insight');
            insight.style.display = 'flex';
            
            let insightText = '';
            if (efficiency > 80) {
                insightText = `Excellent efficiency! With ${workers} workers, you achieved ${speedup.toFixed(1)}Ã— speedup. Your ${serialFraction * 100}% serial code isn't a bottleneck yet.`;
            } else if (efficiency > 50) {
                insightText = `Decent scaling, but ${(100 - efficiency).toFixed(0)}% of your computing power is wasted. The ${serialFraction * 100}% serial portion limits your maximum speedup to ${amdahlLimit.toFixed(1)}Ã—.`;
            } else {
                insightText = `Poor scaling! Adding more workers beyond ${Math.ceil(workers * efficiency / 100)} doesn't help much. The ${serialFraction * 100}% serial code is your bottleneck. Focus on parallelizing that portion!`;
            }
            document.getElementById('insight-text').textContent = insightText;
            
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-play"></i> Run Experiment';
            scalingRunning = false;
        });

        function updateScalingMetrics(speedup, efficiency, time) {
            document.getElementById('metric-speedup').textContent = speedup.toFixed(1) + 'Ã—';
            document.getElementById('metric-efficiency').textContent = efficiency.toFixed(0) + '%';
            document.getElementById('metric-time').textContent = (time / 1000).toFixed(2) + 's';
            document.getElementById('efficiency-percent').textContent = efficiency.toFixed(0) + '%';
            document.getElementById('efficiency-fill').style.width = efficiency + '%';
        }

        // Initialize and update workflow flow visualization
        function initWorkflowFlow(workUnits, workers, serialFraction) {
            const serialTasks = Math.ceil(workUnits * serialFraction);
            const parallelTasks = workUnits - serialTasks;
            const tasksPerLane = Math.ceil(parallelTasks / workers);
            
            // Size Serial and Parallel blocks by Serial Portion (desktop: width ratio; mobile: height ratio)
            const serialSection = document.getElementById('serial-flow-tasks').closest('.flow-section.serial');
            const parallelSection = document.getElementById('parallel-lanes').closest('.flow-section.parallel');
            if (serialSection && parallelSection) {
                const s = Math.max(0.05, Math.min(0.95, serialFraction));
                serialSection.style.flex = `${s} 1 0`;
                serialSection.style.minWidth = '100px';
                parallelSection.style.flex = `${1 - s} 1 0`;
                parallelSection.style.minWidth = '100px';
            }
            
            // Create serial tasks container
            const serialContainer = document.getElementById('serial-flow-tasks');
            serialContainer.innerHTML = '';
            const serialDisplayCount = Math.min(serialTasks, 8);
            for (let i = 0; i < serialDisplayCount; i++) {
                const task = document.createElement('div');
                task.className = 'flow-task serial-task';
                task.id = `serial-task-${i}`;
                task.style.opacity = '0.3';
                serialContainer.appendChild(task);
            }
            if (serialTasks > serialDisplayCount) {
                const more = document.createElement('div');
                more.className = 'flow-task serial-task';
                more.style.opacity = '0.15';
                more.style.height = '6px';
                serialContainer.appendChild(more);
            }
            
            // Create parallel lanes
            const parallelContainer = document.getElementById('parallel-lanes');
            parallelContainer.innerHTML = '';
            const displayWorkers = Math.min(workers, 8);
            parallelContainer.style.gridTemplateRows = `repeat(${displayWorkers}, 1fr)`;
            
            for (let w = 0; w < displayWorkers; w++) {
                const lane = document.createElement('div');
                lane.className = 'parallel-lane';
                lane.id = `parallel-lane-${w}`;
                
                const displayTasks = Math.min(tasksPerLane, 10);
                for (let t = 0; t < displayTasks; t++) {
                    const task = document.createElement('div');
                    task.className = 'parallel-task';
                    task.id = `parallel-task-${w}-${t}`;
                    lane.appendChild(task);
                }
                parallelContainer.appendChild(lane);
            }
        }

        function animateSerialFlow(taskIndex, totalSerial) {
            const displayCount = Math.min(totalSerial, 8);
            const mappedIndex = Math.floor(taskIndex / totalSerial * displayCount);
            
            for (let i = 0; i < displayCount; i++) {
                const task = document.getElementById(`serial-task-${i}`);
                if (task) {
                    if (i < mappedIndex) {
                        task.style.opacity = '1';
                        task.classList.remove('processing');
                    } else if (i === mappedIndex) {
                        task.style.opacity = '1';
                        task.classList.add('processing');
                    } else {
                        task.style.opacity = '0.3';
                        task.classList.remove('processing');
                    }
                }
            }
        }

        function animateParallelFlow(taskIndex, parallelWork, workers, tasksPerLane) {
            const displayWorkers = Math.min(workers, 8);
            const displayTasks = Math.min(tasksPerLane, 10);
            
            for (let w = 0; w < displayWorkers; w++) {
                const workerProgress = Math.floor(taskIndex / workers);
                const mappedProgress = Math.floor(workerProgress / tasksPerLane * displayTasks);
                
                for (let t = 0; t < displayTasks; t++) {
                    const task = document.getElementById(`parallel-task-${w}-${t}`);
                    if (task) {
                        if (t < mappedProgress) {
                            task.classList.add('active');
                            task.classList.remove('processing');
                        } else if (t === mappedProgress) {
                            task.classList.add('processing');
                        } else {
                            task.classList.remove('active', 'processing');
                        }
                    }
                }
            }
        }

        function completeWorkflowFlow() {
            document.querySelectorAll('.serial-task').forEach(t => {
                t.style.opacity = '1';
                t.classList.remove('processing');
            });
            document.querySelectorAll('.parallel-task').forEach(t => {
                t.classList.add('active');
                t.classList.remove('processing');
            });
        }

        // Initialize
        initWorkersGrid(8);
        updateAmdahlLimit();
        initWorkflowFlow(100, 8, 0.1);

        // ==================== MODULE 3: CPU vs GPU ====================
        const renderSizes = [32, 64, 128, 256, 512];
        let selectedImage = 'plasma';
        let renderAborted = false;
        let renderRunning = false;

        // Generate GPU cores visualization
        const gpuCoresViz = document.getElementById('gpu-cores-viz');
        for (let i = 0; i < 80; i++) {
            const core = document.createElement('div');
            core.className = 'core';
            gpuCoresViz.appendChild(core);
        }

        // Image selection
        const imageDisplayNames = {
            plasma: { name: 'Neon Plasma', icon: 'fa-fire' },
            mandelbrot: { name: 'Deep Fractal', icon: 'fa-snowflake' },
            sphere3d: { name: 'Glass Sphere', icon: 'fa-globe' },
            raymarching: { name: '3D Scene', icon: 'fa-cube' },
            galaxy: { name: 'Spiral Galaxy', icon: 'fa-star' },
            ocean: { name: 'Ocean Sunset', icon: 'fa-water' },
            tunnel: { name: 'Neon Tunnel', icon: 'fa-circle-notch' },
            terrain3d: { name: 'World Map', icon: 'fa-mountain' },
            particles: { name: 'Nebula', icon: 'fa-atom' }
        };

        function updateAnimationSectionForImage(imageType) {
            const displayInfo = imageDisplayNames[imageType] || { name: imageType, icon: 'fa-image' };
            
            // Update all animation section references
            document.getElementById('anim-image-name').textContent = displayInfo.name;
            document.getElementById('anim-image-type').textContent = displayInfo.name;
            document.getElementById('anim-selected-type').textContent = displayInfo.name;
            document.getElementById('anim-title-type').textContent = displayInfo.name;
            
            // Update the preview icon
            const previewIcon = document.getElementById('anim-preview-icon');
            previewIcon.innerHTML = `<i class="fas ${displayInfo.icon}"></i>`;
        }

        document.querySelectorAll('.image-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.image-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                selectedImage = option.dataset.image;
                
                // Update animation section to reflect selected image
                updateAnimationSectionForImage(selectedImage);
            });
        });

        // Size slider
        document.getElementById('render-size-slider').addEventListener('input', (e) => {
            const size = renderSizes[e.target.value - 1];
            document.getElementById('render-size-value').textContent = `${size}Ã—${size}`;
        });

        // Abort render
        document.getElementById('abort-render').addEventListener('click', () => {
            renderAborted = true;
        });

        // Pseudo-random hash for deterministic noise
        function _hash(n) { let s = Math.sin(n) * 43758.5453; return s - Math.floor(s); }
        function _noise2d(x, y) {
            const ix = Math.floor(x), iy = Math.floor(y);
            const fx = x - ix, fy = y - iy;
            const ux = fx * fx * (3 - 2 * fx), uy = fy * fy * (3 - 2 * fy);
            const a = _hash(ix + iy * 57.0);
            const b = _hash(ix + 1 + iy * 57.0);
            const c = _hash(ix + (iy + 1) * 57.0);
            const d = _hash(ix + 1 + (iy + 1) * 57.0);
            return a + (b - a) * ux + (c - a) * uy + (a - b - c + d) * ux * uy;
        }
        function _fbm(x, y, octaves) {
            let v = 0, amp = 0.5, freq = 1;
            for (let i = 0; i < octaves; i++) { v += amp * _noise2d(x * freq, y * freq); amp *= 0.5; freq *= 2.0; }
            return v;
        }
        function _clamp(v, lo, hi) { return v < lo ? lo : v > hi ? hi : v; }
        function _mix(a, b, t) { return a + (b - a) * t; }
        function _smoothstep(a, b, t) { const x = _clamp((t - a) / (b - a), 0, 1); return x * x * (3 - 2 * x); }

        // Image generators â€” upgraded for visual complexity
        const imageGenerators = {
            // â”€â”€â”€ Plasma: multi-octave turbulence with vivid HSL cycling â”€â”€â”€
            plasma: (x, y, size, t) => {
                const nx = x / size, ny = y / size;
                const v1 = Math.sin(nx * 12.0 + t) + Math.sin(ny * 12.0 + t * 0.7);
                const v2 = Math.sin(Math.sqrt((nx - 0.5) * (nx - 0.5) + (ny - 0.5) * (ny - 0.5)) * 14.0);
                const v3 = Math.sin(nx * 8.0 + ny * 6.0 + t * 1.3);
                const turb = _fbm(nx * 6.0 + t * 0.3, ny * 6.0 - t * 0.2, 4);
                const val = (v1 + v2 + v3 + turb * 2.0 + 5.0) / 10.0;
                const hue = (val * 360 + t * 60) % 360 / 360;
                return hslToRgb(hue, 0.85, 0.35 + val * 0.3);
            },

            // â”€â”€â”€ Mandelbrot: deep zoom with smooth iteration coloring â”€â”€â”€
            mandelbrot: (x, y, size) => {
                // Zoom into the Seahorse Valley
                const cx = -0.745 + (x / size - 0.5) * 0.015;
                const cy = 0.186 + (y / size - 0.5) * 0.015;
                let zx = 0, zy = 0, iter = 0;
                const maxIter = 200;
                while (zx * zx + zy * zy < 256 && iter < maxIter) {
                    const tmp = zx * zx - zy * zy + cx;
                    zy = 2 * zx * zy + cy;
                    zx = tmp;
                    iter++;
                }
                if (iter === maxIter) return { r: 0, g: 0, b: 0 };
                // Smooth iteration count
                const logZn = Math.log(zx * zx + zy * zy) / 2;
                const nu = Math.log(logZn / Math.log(2)) / Math.log(2);
                const smooth = iter + 1 - nu;
                const t = smooth / maxIter;
                // Rich palette: deep blue â†’ cyan â†’ gold â†’ magenta â†’ deep blue
                const r = Math.floor(255 * (0.5 + 0.5 * Math.cos(6.2832 * (t + 0.0))));
                const g = Math.floor(255 * (0.5 + 0.5 * Math.cos(6.2832 * (t + 0.33))));
                const b = Math.floor(255 * (0.5 + 0.5 * Math.cos(6.2832 * (t + 0.67))));
                return { r, g, b };
            },

            // â”€â”€â”€ 3D Sphere: glass sphere with environment reflection + checker floor â”€â”€â”€
            sphere3d: (x, y, size) => {
                const u = (x / size - 0.5) * 2.4;
                const v = (y / size - 0.5) * 2.4;
                const scx = 0.0, scy = -0.1;
                const rad = 0.75;
                const ddx = u - scx, ddy = v - scy;
                const dist2 = ddx * ddx + ddy * ddy;

                // Checker floor behind sphere
                function checkerFloor(uu, vv) {
                    const floorY = 0.65;
                    if (vv < floorY) return null;
                    const fz = 1.0 / (vv - floorY + 0.001);
                    const fx = uu * fz;
                    const check = ((Math.floor(fx * 1.5) + Math.floor(fz * 0.5)) & 1) === 0;
                    const fade = Math.min(1.0, 1.0 / (fz * 0.15 + 1));
                    const c = check ? 0.85 : 0.25;
                    return { r: Math.floor(c * fade * 200), g: Math.floor(c * fade * 210), b: Math.floor(c * fade * 230) };
                }

                if (dist2 > rad * rad) {
                    // Outside sphere â€” sky gradient or floor
                    const floor = checkerFloor(u, v);
                    if (floor) return floor;
                    const skyT = _clamp(0.5 - v * 0.6, 0, 1);
                    return { r: Math.floor(_mix(15, 70, skyT)), g: Math.floor(_mix(15, 50, skyT)), b: Math.floor(_mix(40, 130, skyT)) };
                }

                const nz = Math.sqrt(rad * rad - dist2);
                const nx = ddx / rad, ny = ddy / rad, nnz = nz / rad;
                const lx = 0.5, ly = -0.6, lz = 0.65;
                const ll = Math.sqrt(lx * lx + ly * ly + lz * lz);
                const diffuse = Math.max(0, (nx * lx + ny * ly + nnz * lz) / ll);
                // Reflection vector for environment mapping
                const dotNL = (nx * lx + ny * ly + nnz * lz) / ll;
                const rx = 2 * dotNL * nx - lx / ll;
                const ry = 2 * dotNL * ny - ly / ll;
                const specular = Math.pow(Math.max(0, nnz * 0.4 + ry * -0.3 + rx * 0.2), 48);
                // Fresnel rim
                const fresnel = Math.pow(1 - nnz, 3) * 0.7;
                // Tinted glass
                const baseR = 40 + diffuse * 100, baseG = 120 + diffuse * 80, baseB = 200 + diffuse * 40;
                const r = _clamp(Math.floor(baseR + specular * 220 + fresnel * 120), 0, 255);
                const g = _clamp(Math.floor(baseG + specular * 230 + fresnel * 180), 0, 255);
                const b = _clamp(Math.floor(baseB + specular * 255 + fresnel * 220), 0, 255);
                return { r, g, b };
            },

            // â”€â”€â”€ Raymarching: multi-object scene with soft shadows & AO â”€â”€â”€
            raymarching: (x, y, size) => {
                const u = (x / size - 0.5) * 2.2;
                const v = (y / size - 0.5) * 2.2;
                const ox = 0, oy = 0.4, oz = -3.5;
                const len = Math.sqrt(u * u + v * v + 1);
                const dx = u / len, dy = -v / len, dz = 1 / len;

                function sdSphere(px, py, pz, cx, cy, cz, r) {
                    const a = px - cx, b = py - cy, c = pz - cz;
                    return Math.sqrt(a * a + b * b + c * c) - r;
                }
                function sdBox(px, py, pz, bx, by, bz) {
                    const qx = Math.abs(px) - bx, qy = Math.abs(py) - by, qz = Math.abs(pz) - bz;
                    const mx = Math.max(qx, 0), my = Math.max(qy, 0), mz = Math.max(qz, 0);
                    return Math.sqrt(mx * mx + my * my + mz * mz) + Math.min(Math.max(qx, Math.max(qy, qz)), 0);
                }
                function sdTorus(px, py, pz, R, r) {
                    const qxz = Math.sqrt(px * px + pz * pz) - R;
                    return Math.sqrt(qxz * qxz + py * py) - r;
                }
                function scene(px, py, pz) {
                    const s = sdSphere(px, py, pz, -0.8, 0.35, 0.5, 0.55);
                    const b = sdBox(px - 0.7, py + 0.1, pz - 0.3, 0.4, 0.4, 0.4);
                    const t = sdTorus(px, py - 0.9, pz + 0.2, 0.6, 0.15);
                    const floor = py + 0.5;
                    return { d: Math.min(s, Math.min(b, Math.min(t, floor))), id: s < b && s < t && s < floor ? 1 : b < t && b < floor ? 2 : t < floor ? 3 : 0 };
                }

                let t = 0, hitId = -1;
                for (let i = 0; i < 80; i++) {
                    const px = ox + t * dx, py = oy + t * dy, pz = oz + t * dz;
                    const res = scene(px, py, pz);
                    if (res.d < 0.005) { hitId = res.id; break; }
                    t += res.d;
                    if (t > 15) break;
                }

                if (hitId < 0) {
                    const sky = _clamp(0.5 - v * 0.5, 0, 1);
                    return { r: Math.floor(_mix(10, 50, sky)), g: Math.floor(_mix(8, 30, sky)), b: Math.floor(_mix(25, 90, sky)) };
                }

                const hp = { x: ox + t * dx, y: oy + t * dy, z: oz + t * dz };
                const e = 0.001;
                const nx2 = scene(hp.x + e, hp.y, hp.z).d - scene(hp.x - e, hp.y, hp.z).d;
                const ny2 = scene(hp.x, hp.y + e, hp.z).d - scene(hp.x, hp.y - e, hp.z).d;
                const nz2 = scene(hp.x, hp.y, hp.z + e).d - scene(hp.x, hp.y, hp.z - e).d;
                const nl = Math.sqrt(nx2 * nx2 + ny2 * ny2 + nz2 * nz2) || 1;
                const nnx = nx2 / nl, nny = ny2 / nl, nnz = nz2 / nl;

                const llx = 1.5, lly = 2.0, llz = -1.0;
                const ldx = llx - hp.x, ldy = lly - hp.y, ldz = llz - hp.z;
                const ldl = Math.sqrt(ldx * ldx + ldy * ldy + ldz * ldz);
                const diff = Math.max(0, (nnx * ldx + nny * ldy + nnz * ldz) / ldl);
                const spec = Math.pow(Math.max(0, diff), 32);
                const ao = 0.6 + 0.4 * _clamp(scene(hp.x + nnx * 0.15, hp.y + nny * 0.15, hp.z + nnz * 0.15).d / 0.15, 0, 1);
                const fog = Math.exp(-t * 0.08);

                let cr, cg, cb;
                if (hitId === 0) { // floor checker
                    const ch = ((Math.floor(hp.x + 100) + Math.floor(hp.z + 100)) & 1) === 0;
                    cr = ch ? 200 : 60; cg = ch ? 200 : 60; cb = ch ? 210 : 65;
                } else if (hitId === 1) { cr = 220; cg = 80; cb = 80; }
                else if (hitId === 2) { cr = 80; cg = 180; cb = 220; }
                else { cr = 240; cg = 200; cb = 80; }

                const shade = (0.15 + diff * 0.65 + spec * 0.3) * ao * fog;
                return { r: _clamp(Math.floor(cr * shade), 0, 255), g: _clamp(Math.floor(cg * shade), 0, 255), b: _clamp(Math.floor(cb * shade), 0, 255) };
            },

            // â”€â”€â”€ Galaxy: multi-arm spiral with nebula clouds, dust & stars â”€â”€â”€
            galaxy: (x, y, size) => {
                const cx = size / 2, cy = size / 2;
                const ddx = (x - cx) / (size / 2), ddy = (y - cy) / (size / 2);
                const dist = Math.sqrt(ddx * ddx + ddy * ddy);
                const angle = Math.atan2(ddy, ddx);

                // Deterministic star field using hash
                const starSeed = _hash(x * 13.731 + y * 7.319);
                if (starSeed > 0.997) {
                    const bright = 180 + starSeed * 75;
                    return { r: Math.floor(bright), g: Math.floor(bright * 0.95), b: Math.floor(bright) };
                }

                // Multiple spiral arms
                let armBrightness = 0;
                for (let arm = 0; arm < 4; arm++) {
                    const armAngle = arm * Math.PI / 2;
                    const spiralAngle = angle - armAngle + dist * 4.0;
                    const wrap = ((spiralAngle % (Math.PI * 2)) + Math.PI * 2) % (Math.PI * 2) - Math.PI;
                    const armWidth = 0.45 + dist * 0.25;
                    const armVal = Math.exp(-(wrap * wrap) / (armWidth * armWidth));
                    armBrightness += armVal;
                }

                // Core glow
                const coreGlow = Math.exp(-dist * dist * 6.0) * 1.5;
                // Nebula clouds
                const nebula = _fbm(ddx * 3.0 + 1.7, ddy * 3.0 + 2.3, 5) * 0.6;
                // Dust lanes (dark)
                const dust = _fbm(ddx * 5.0, ddy * 5.0 + 3.1, 4);
                const dustMask = _smoothstep(0.3, 0.55, dust) * 0.6;

                const falloff = Math.max(0, 1 - dist * 0.85);
                let brightness = (armBrightness * falloff + coreGlow + nebula * falloff * 0.5) * (1 - dustMask);
                brightness = _clamp(brightness, 0, 1);

                // Color: warm core â†’ blue-purple arms
                const coreT = _clamp(coreGlow * 2, 0, 1);
                const r = _clamp(Math.floor(brightness * _mix(100, 255, coreT) + nebula * 40), 0, 255);
                const g = _clamp(Math.floor(brightness * _mix(70, 200, coreT) + nebula * 15), 0, 255);
                const b = _clamp(Math.floor(brightness * _mix(180, 180, coreT) + nebula * 60), 0, 255);
                return { r, g, b };
            },

            // â”€â”€â”€ Ocean: realistic waves with sun reflection and atmospheric fog â”€â”€â”€
            ocean: (x, y, size) => {
                const nx = x / size, ny = y / size;

                // Multi-layer waves
                const w1 = Math.sin(nx * 25 + ny * 3.5) * 0.35;
                const w2 = Math.sin(nx * 12 - ny * 18 + 1.2) * 0.25;
                const w3 = Math.sin((nx * 1.5 + ny) * 35 + 0.5) * 0.15;
                const w4 = _fbm(nx * 8.0, ny * 6.0, 4) * 0.25;
                const height = (w1 + w2 + w3 + w4 + 1) / 2;

                // Depth gradient (horizon at top)
                const depth = _clamp(ny, 0, 1);
                const fog = _smoothstep(0.0, 0.4, ny);

                // Foam on wave crests
                const foam = _smoothstep(0.68, 0.78, height) * (1 - depth * 0.5);

                // Sun reflection (sun at top-center)
                const sunX = 0.5, sunY = 0.05;
                const sunDist = Math.sqrt((nx - sunX) * (nx - sunX) + (ny - sunY) * (ny - sunY));
                const sunReflect = Math.exp(-sunDist * sunDist * 12) * (0.4 + height * 0.6) * _smoothstep(0.5, 0.0, ny);

                // Base water color
                const deepR = 10, deepG = 40, deepB = 90;
                const shallowR = 30, shallowG = 120, shallowB = 170;
                const t = _clamp(depth * 0.8 + height * 0.2, 0, 1);
                let r = _mix(shallowR, deepR, t) + height * 20 + foam * 200 + sunReflect * 250;
                let g = _mix(shallowG, deepG, t) + height * 30 + foam * 210 + sunReflect * 230;
                let b = _mix(shallowB, deepB, t) + height * 15 + foam * 180 + sunReflect * 180;

                // Horizon fog
                const fogR = 140, fogG = 160, fogB = 190;
                const fogAmt = 1 - fog;
                r = _mix(r, fogR, fogAmt * 0.7);
                g = _mix(g, fogG, fogAmt * 0.7);
                b = _mix(b, fogB, fogAmt * 0.7);

                return { r: _clamp(Math.floor(r), 0, 255), g: _clamp(Math.floor(g), 0, 255), b: _clamp(Math.floor(b), 0, 255) };
            },

            // â”€â”€â”€ Tunnel: neon-lit infinite tunnel with smooth color transitions â”€â”€â”€
            tunnel: (x, y, size) => {
                const cx = size / 2, cy = size / 2;
                const ddx = (x - cx) / cx, ddy = (y - cy) / cy;
                const dist = Math.sqrt(ddx * ddx + ddy * ddy);
                const angle = Math.atan2(ddy, ddx);

                if (dist < 0.005) return { r: 0, g: 0, b: 0 };

                const depth = 1.0 / dist;
                const twist = angle + depth * 0.4;

                // Hexagonal pattern
                const ringFreq = depth * 5.0;
                const segFreq = twist * 4.0 / Math.PI;
                const rings = Math.sin(ringFreq * Math.PI) * 0.5 + 0.5;
                const segs = Math.sin(segFreq * Math.PI) * 0.5 + 0.5;
                const pattern = rings * 0.6 + segs * 0.4;

                // Neon glow lines
                const neonRing = Math.exp(-Math.pow(Math.sin(ringFreq * Math.PI * 2) * 3, 2));
                const neonSeg = Math.exp(-Math.pow(Math.sin(segFreq * Math.PI * 2) * 3, 2));
                const neon = Math.max(neonRing * 0.8, neonSeg * 0.5);

                const fadeIn = _smoothstep(0.0, 0.3, dist);
                const fadeOut = _clamp(3.0 / (depth + 1), 0, 1);
                const brightness = fadeIn * fadeOut;

                // Color cycling by depth
                const hue = ((depth * 0.3 + angle * 0.15) % 1 + 1) % 1;
                const base = hslToRgb(hue, 0.7, pattern * 0.15 * brightness);
                const glow = hslToRgb((hue + 0.5) % 1, 1.0, 0.5);

                const r = _clamp(Math.floor(base.r + glow.r * neon * brightness * 1.4), 0, 255);
                const g = _clamp(Math.floor(base.g + glow.g * neon * brightness * 1.4), 0, 255);
                const b = _clamp(Math.floor(base.b + glow.b * neon * brightness * 1.4), 0, 255);
                return { r, g, b };
            },

            // â”€â”€â”€ Terrain: 6-octave heightmap with biomes, lighting & atmosphere â”€â”€â”€
            terrain3d: (x, y, size) => {
                const nx = x / size, ny = y / size;

                // 6-octave fractal terrain
                const height = _fbm(nx * 5.0 + 0.3, ny * 5.0 + 0.7, 6);

                // Normal for lighting via central differences
                const eps = 0.005;
                const hL = _fbm((nx - eps) * 5.0 + 0.3, ny * 5.0 + 0.7, 6);
                const hR = _fbm((nx + eps) * 5.0 + 0.3, ny * 5.0 + 0.7, 6);
                const hU = _fbm(nx * 5.0 + 0.3, (ny - eps) * 5.0 + 0.7, 6);
                const hD = _fbm(nx * 5.0 + 0.3, (ny + eps) * 5.0 + 0.7, 6);
                const dhdx = (hR - hL) / (2 * eps * 5);
                const dhdy = (hD - hU) / (2 * eps * 5);
                const nLen = Math.sqrt(dhdx * dhdx + dhdy * dhdy + 1);
                const shade = Math.max(0, (-dhdx * 0.5 + -dhdy * 0.6 + 1) / nLen);
                const lighting = 0.25 + shade * 0.75;

                // Biome coloring by height
                let r, g, b;
                if (height < 0.28) { // Deep water
                    r = 20; g = 50; b = 130;
                } else if (height < 0.35) { // Shallow water
                    const t = (height - 0.28) / 0.07;
                    r = _mix(20, 40, t); g = _mix(50, 90, t); b = _mix(130, 150, t);
                } else if (height < 0.38) { // Sand / beach
                    r = 190; g = 175; b = 130;
                } else if (height < 0.58) { // Grass / forest
                    const t = (height - 0.38) / 0.20;
                    r = _mix(60, 35, t); g = _mix(145, 110, t); b = _mix(50, 35, t);
                } else if (height < 0.72) { // Rock / mountain
                    const t = (height - 0.58) / 0.14;
                    r = _mix(95, 130, t); g = _mix(80, 125, t); b = _mix(65, 115, t);
                } else { // Snow caps
                    const t = _smoothstep(0.72, 0.82, height);
                    r = _mix(130, 245, t); g = _mix(125, 245, t); b = _mix(115, 255, t);
                }

                // Atmospheric perspective
                const atmo = _smoothstep(0.0, 1.0, ny) * 0.15;
                r = _mix(r, 160, atmo); g = _mix(g, 180, atmo); b = _mix(b, 210, atmo);

                return { r: _clamp(Math.floor(r * lighting), 0, 255), g: _clamp(Math.floor(g * lighting), 0, 255), b: _clamp(Math.floor(b * lighting), 0, 255) };
            },

            // â”€â”€â”€ Particles: nebula-style with 120 particles, glow & connections â”€â”€â”€
            particles: (x, y, size) => {
                const numParticles = 120;
                let totalR = 0, totalG = 0, totalB = 0;

                for (let i = 0; i < numParticles; i++) {
                    const seed1 = _hash(i * 17.31);
                    const seed2 = _hash(i * 31.17 + 7);
                    const seed3 = _hash(i * 53.71 + 13);
                    const px = seed1 * size;
                    const py = seed2 * size;
                    const psize = 4 + seed3 * 22;
                    const ddx = x - px, ddy = y - py;
                    const dist = Math.sqrt(ddx * ddx + ddy * ddy);

                    if (dist < psize) {
                        const falloff = 1 - dist / psize;
                        const glow = falloff * falloff * falloff; // cubic falloff for soft glow
                        const hue = (seed1 + seed2 * 0.3) % 1;
                        const c = hslToRgb(hue, 0.85, 0.5);
                        totalR += c.r * glow * 0.9;
                        totalG += c.g * glow * 0.9;
                        totalB += c.b * glow * 0.9;
                    }
                }

                // Background nebula fog
                const fogVal = _fbm(x / size * 4.0 + 2.1, y / size * 4.0 + 3.7, 5);
                const fogBright = fogVal * 0.12;
                totalR += fogBright * 80;
                totalG += fogBright * 40;
                totalB += fogBright * 120;

                if (totalR < 2 && totalG < 2 && totalB < 2) {
                    // Faint star
                    const s = _hash(x * 7.13 + y * 13.37);
                    if (s > 0.998) return { r: 200, g: 200, b: 220 };
                    return { r: 3, g: 5, b: 15 };
                }

                return { r: _clamp(Math.floor(totalR), 0, 255), g: _clamp(Math.floor(totalG), 0, 255), b: _clamp(Math.floor(totalB), 0, 255) };
            }
        };

        // Start render
        document.getElementById('start-render').addEventListener('click', async () => {
            if (renderRunning) return;
            renderRunning = true;
            renderAborted = false;
            
            const btn = document.getElementById('start-render');
            const abortBtn = document.getElementById('abort-render');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Rendering...';
            abortBtn.style.display = 'flex';
            
            const sizeIndex = parseInt(document.getElementById('render-size-slider').value) - 1;
            const size = renderSizes[sizeIndex];
            const totalPixels = size * size;
            
            // Setup canvases
            const cpuCanvas = document.getElementById('cpu-canvas');
            const gpuCanvas = document.getElementById('gpu-canvas');
            cpuCanvas.width = size;
            cpuCanvas.height = size;
            gpuCanvas.width = size;
            gpuCanvas.height = size;
            
            const cpuCtx = cpuCanvas.getContext('2d');
            const gpuCtx = gpuCanvas.getContext('2d');
            cpuCtx.fillStyle = '#0a0f1a';
            cpuCtx.fillRect(0, 0, size, size);
            gpuCtx.fillStyle = '#0a0f1a';
            gpuCtx.fillRect(0, 0, size, size);
            
            // Reset displays
            document.getElementById('cpu-overlay').innerHTML = '<div class="spinner"></div><span>Rendering...</span>';
            document.getElementById('gpu-overlay').innerHTML = '<div class="spinner"></div><span>Rendering...</span>';
            document.getElementById('cpu-overlay').classList.remove('hidden');
            document.getElementById('gpu-overlay').classList.remove('hidden');
            document.getElementById('cpu-progress').style.width = '0%';
            document.getElementById('gpu-progress').style.width = '0%';
            document.getElementById('speed-comparison').style.display = 'none';
            document.getElementById('gpu-insight').style.display = 'none';
            
            // Calculate times
            const gpuSpeedup = 10 + sizeIndex * 8;
            const cpuTotalTime = totalPixels * 0.3; // ms
            const gpuTotalTime = cpuTotalTime / gpuSpeedup;
            
            // Start both renders
            const cpuPromise = renderCPU(cpuCtx, size, cpuTotalTime);
            const gpuPromise = renderGPU(gpuCtx, size, gpuTotalTime);
            
            await Promise.all([cpuPromise, gpuPromise]);
            
            if (!renderAborted) {
                // Show results
                const timeSavedSec = (cpuTotalTime - gpuTotalTime) / 1000;
                document.getElementById('speed-comparison').style.display = 'grid';
                document.getElementById('gpu-speedup').textContent = gpuSpeedup.toFixed(0) + 'Ã—';
                document.getElementById('gpu-time-saved').textContent = timeSavedSec >= 1
                    ? timeSavedSec.toFixed(1) + 's'
                    : (timeSavedSec * 1000).toFixed(0) + 'ms';
                
                document.getElementById('gpu-insight').style.display = 'flex';
                document.getElementById('gpu-insight-text').textContent = 
                    `The GPU rendered ${totalPixels.toLocaleString()} pixels ${gpuSpeedup.toFixed(0)}Ã— faster! ` +
                    `While the CPU processed pixels one-by-one, the GPU computed ${Math.min(totalPixels, 1024).toLocaleString()} pixels simultaneously. ` +
                    `This is why GPUs excel at graphics, AI training, and scientific simulations!`;
            }
            
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-play"></i> Start Render';
            abortBtn.style.display = 'none';
            renderRunning = false;
        });

        async function renderCPU(ctx, size, totalTime) {
            const overlay = document.getElementById('cpu-overlay');
            const totalPixels = size * size;
            const pixelsPerFrame = Math.max(1, Math.floor(totalPixels / (totalTime / 33)));
            
            let rendered = 0;
            const startTime = performance.now();
            const generator = imageGenerators[selectedImage];
            
            while (rendered < totalPixels && !renderAborted) {
                const batchEnd = Math.min(rendered + pixelsPerFrame, totalPixels);
                
                for (let i = rendered; i < batchEnd; i++) {
                    const x = i % size;
                    const y = Math.floor(i / size);
                    const color = generator(x, y, size, 0);
                    ctx.fillStyle = `rgb(${color.r},${color.g},${color.b})`;
                    ctx.fillRect(x, y, 1, 1);
                }
                
                rendered = batchEnd;
                const elapsed = performance.now() - startTime;
                const progress = (rendered / totalPixels * 100);
                const pixelsPerSec = Math.floor(rendered / (elapsed / 1000));
                
                document.getElementById('cpu-time').textContent = (elapsed / 1000).toFixed(2) + 's';
                document.getElementById('cpu-progress-pct').textContent = progress.toFixed(0) + '%';
                document.getElementById('cpu-pixels').textContent = pixelsPerSec.toLocaleString();
                document.getElementById('cpu-progress').style.width = progress + '%';
                
                await sleep(33);
            }
            
            if (!renderAborted) {
                overlay.classList.add('hidden');
            }
        }

        async function renderGPU(ctx, size, totalTime) {
            const overlay = document.getElementById('gpu-overlay');
            const totalPixels = size * size;
            const steps = 15;
            const stepDelay = totalTime / steps;
            const generator = imageGenerators[selectedImage];
            
            const startTime = performance.now();
            
            for (let step = 0; step < steps && !renderAborted; step++) {
                const endPixel = Math.floor((step + 1) / steps * totalPixels);
                
                const imageData = ctx.createImageData(size, size);
                for (let i = 0; i < endPixel; i++) {
                    const x = i % size;
                    const y = Math.floor(i / size);
                    const color = generator(x, y, size, 0);
                    const idx = i * 4;
                    imageData.data[idx] = color.r;
                    imageData.data[idx + 1] = color.g;
                    imageData.data[idx + 2] = color.b;
                    imageData.data[idx + 3] = 255;
                }
                ctx.putImageData(imageData, 0, 0);
                
                const elapsed = performance.now() - startTime;
                const progress = ((step + 1) / steps * 100);
                const pixelsPerSec = Math.floor(endPixel / (elapsed / 1000));
                
                document.getElementById('gpu-time').textContent = (elapsed / 1000).toFixed(2) + 's';
                document.getElementById('gpu-progress-pct').textContent = progress.toFixed(0) + '%';
                document.getElementById('gpu-pixels').textContent = pixelsPerSec.toLocaleString();
                document.getElementById('gpu-progress').style.width = progress + '%';
                
                await sleep(stepDelay);
            }
            
            if (!renderAborted) {
                overlay.classList.add('hidden');
            }
        }

        // ==================== ANIMATION COMPARISON ====================
        let animationRenderRunning = false;
        let animationAborted = false;

        // Initialize filmstrips
        function initializeFilmstrips() {
            const frameCount = parseInt(document.getElementById('frame-count').value);
            const cpuFilmstrip = document.getElementById('cpu-filmstrip');
            const gpuFilmstrip = document.getElementById('gpu-filmstrip');
            
            cpuFilmstrip.innerHTML = '';
            gpuFilmstrip.innerHTML = '';
            
            for (let i = 1; i <= frameCount; i++) {
                const cpuFrame = document.createElement('div');
                cpuFrame.className = 'frame';
                cpuFrame.innerHTML = `<span>${i}</span>`;
                cpuFrame.id = `cpu-frame-${i}`;
                cpuFilmstrip.appendChild(cpuFrame);
                
                const gpuFrame = document.createElement('div');
                gpuFrame.className = 'frame';
                gpuFrame.innerHTML = `<span>${i}</span>`;
                gpuFrame.id = `gpu-frame-${i}`;
                gpuFilmstrip.appendChild(gpuFrame);
            }
            
            // Update frame count preview
            document.getElementById('anim-frame-preview').textContent = `${frameCount} frames`;
            
            // Reset stats
            document.getElementById('anim-cpu-time').textContent = '--';
            document.getElementById('anim-gpu-time').textContent = '--';
            document.getElementById('anim-speedup').textContent = '--';
            document.getElementById('anim-time-saved').textContent = '--';
            document.getElementById('cpu-timeline-bar').style.width = '0%';
            document.getElementById('gpu-timeline-bar').style.width = '0%';
            document.getElementById('cpu-timeline-text').textContent = '0s';
            document.getElementById('gpu-timeline-text').textContent = '0s';
            document.getElementById('animation-insight').style.display = 'none';
            
            // Make sure animation section shows correct image type
            if (typeof selectedImage !== 'undefined' && typeof updateAnimationSectionForImage === 'function') {
                updateAnimationSectionForImage(selectedImage);
            }
        }

        // Frame count selector
        document.getElementById('frame-count').addEventListener('change', initializeFilmstrips);

        // Start animation render
        document.getElementById('start-animation-render').addEventListener('click', async function() {
            if (animationRenderRunning) return;
            animationRenderRunning = true;
            animationAborted = false;
            
            const frameCount = parseInt(document.getElementById('frame-count').value);
            const cpuTimePerFrame = 2.5; // seconds
            const gpuTimePerFrame = 0.15; // seconds
            const gpuBatchSize = 8; // frames processed in parallel
            
            // Reset frames
            for (let i = 1; i <= frameCount; i++) {
                document.getElementById(`cpu-frame-${i}`).className = 'frame';
                document.getElementById(`gpu-frame-${i}`).className = 'frame';
            }
            
            // Simulate rendering in parallel
            const cpuPromise = simulateCPURender(frameCount, cpuTimePerFrame);
            const gpuPromise = simulateGPURender(frameCount, gpuTimePerFrame, gpuBatchSize);
            
            await Promise.all([cpuPromise, gpuPromise]);
            
            // Calculate final stats
            if (!animationAborted) {
                const cpuTotal = frameCount * cpuTimePerFrame;
                const gpuBatches = Math.ceil(frameCount / gpuBatchSize);
                const gpuTotal = gpuBatches * gpuTimePerFrame * gpuBatchSize / gpuBatchSize + (frameCount * gpuTimePerFrame * 0.1);
                const gpuActual = gpuBatches * 0.5; // More realistic timing
                
                document.getElementById('anim-cpu-time').textContent = cpuTotal.toFixed(1) + 's';
                document.getElementById('anim-gpu-time').textContent = gpuActual.toFixed(1) + 's';
                document.getElementById('anim-speedup').textContent = (cpuTotal / gpuActual).toFixed(0) + 'x';
                document.getElementById('anim-time-saved').textContent = formatTimeSaved(cpuTotal - gpuActual);
                
                // Show insight
                showAnimationInsight(frameCount, cpuTotal, gpuActual);
            }
            
            animationRenderRunning = false;
        });

        async function simulateCPURender(frameCount, timePerFrame) {
            const simulatedTimeScale = 50; // Speed up simulation
            const delayPerFrame = (timePerFrame * 1000) / simulatedTimeScale;
            
            let elapsed = 0;
            for (let i = 1; i <= frameCount && !animationAborted; i++) {
                const frame = document.getElementById(`cpu-frame-${i}`);
                frame.className = 'frame rendering';
                // Auto-scroll filmstrip to keep current frame visible
                const strip = frame.parentElement;
                const scrollTarget = frame.offsetLeft - strip.clientWidth / 2 + frame.offsetWidth / 2;
                strip.scrollTo({ left: scrollTarget, behavior: 'smooth' });
                
                await sleep(delayPerFrame);
                
                frame.className = 'frame complete';
                elapsed += timePerFrame;
                
                // Update timeline
                const cpuTotal = frameCount * timePerFrame;
                const progress = (elapsed / cpuTotal) * 100;
                document.getElementById('cpu-timeline-bar').style.width = progress + '%';
                document.getElementById('cpu-timeline-text').textContent = elapsed.toFixed(1) + 's';
            }
        }

        async function simulateGPURender(frameCount, timePerFrame, batchSize) {
            const simulatedTimeScale = 50;
            const delayPerBatch = (timePerFrame * batchSize * 1000) / simulatedTimeScale / 4; // GPU is faster
            
            let elapsed = 0;
            let framesCompleted = 0;
            const totalBatches = Math.ceil(frameCount / batchSize);
            
            for (let batch = 0; batch < totalBatches && !animationAborted; batch++) {
                const startFrame = batch * batchSize + 1;
                const endFrame = Math.min(startFrame + batchSize - 1, frameCount);
                
                // Mark batch as rendering
                for (let i = startFrame; i <= endFrame; i++) {
                    document.getElementById(`gpu-frame-${i}`).className = 'frame rendering';
                }
                // Auto-scroll filmstrip to keep current batch visible
                const gpuLast = document.getElementById(`gpu-frame-${endFrame}`);
                const gpuStrip = gpuLast.parentElement;
                const gpuTarget = gpuLast.offsetLeft - gpuStrip.clientWidth / 2 + gpuLast.offsetWidth / 2;
                gpuStrip.scrollTo({ left: gpuTarget, behavior: 'smooth' });
                
                await sleep(delayPerBatch);
                
                // Mark batch as complete
                for (let i = startFrame; i <= endFrame; i++) {
                    document.getElementById(`gpu-frame-${i}`).className = 'frame complete';
                    framesCompleted++;
                }
                
                elapsed += 0.5; // Batch time
                
                // Update timeline (GPU finishes much faster)
                const gpuTotal = totalBatches * 0.5;
                const progress = Math.min((elapsed / gpuTotal) * 100, 100);
                document.getElementById('gpu-timeline-bar').style.width = progress + '%';
                document.getElementById('gpu-timeline-text').textContent = elapsed.toFixed(1) + 's';
            }
        }

        function formatTimeSaved(seconds) {
            if (seconds < 60) {
                return seconds.toFixed(0) + 's';
            } else if (seconds < 3600) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}m ${secs}s`;
            } else {
                const hours = Math.floor(seconds / 3600);
                const mins = Math.floor((seconds % 3600) / 60);
                return `${hours}h ${mins}m`;
            }
        }

        function showAnimationInsight(frameCount, cpuTime, gpuTime) {
            const insight = document.getElementById('animation-insight');
            const text = document.getElementById('animation-insight-text');
            const imageName = document.getElementById('anim-selected-type').textContent || 'image';
            
            let message = '';
            if (frameCount <= 24) {
                message = `For a simple ${frameCount}-frame animated ${imageName}, the CPU would take ${cpuTime.toFixed(0)} seconds while the GPU finishes in just ${gpuTime.toFixed(1)} seconds. `;
                message += `Imagine rendering a full movie at 24fps â€” that's 86,400 frames for just one hour of content!`;
            } else if (frameCount <= 60) {
                message = `Rendering ${frameCount} ${imageName} frames shows the power of parallelism. The GPU processes ${Math.ceil(frameCount/8)} batches simultaneously, `;
                message += `while the CPU trudges through one frame at a time. At movie scale (millions of frames), this difference means days vs hours.`;
            } else {
                message = `At ${frameCount} ${imageName} frames, the GPU's ${(cpuTime/gpuTime).toFixed(0)}x speedup saves ${formatTimeSaved(cpuTime - gpuTime)}. `;
                message += `Professional animation studios render millions of frames â€” GPUs turn weeks of CPU time into overnight jobs. `;
                message += `This is why Pixar and Disney invest heavily in GPU render farms!`;
            }
            
            text.textContent = message;
            insight.style.display = 'flex';
        }

        // Reset animation
        document.getElementById('reset-animation-render').addEventListener('click', function() {
            animationAborted = true;
            animationRenderRunning = false;
            initializeFilmstrips();
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeFilmstrips();
        });

        // Also initialize when switching to the GPU tab
        document.querySelectorAll('.module-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                if (this.dataset.module === 'cpugpu') {
                    setTimeout(initializeFilmstrips, 100);
                }
            });
        });

        function hslToRgb(h, s, l) {
            let r, g, b;
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }
    // ===== Move back-btn into #titleBar on mobile (single instance, no clone) =====
    (function() {
        var restoreParent = null;
        function moveBackBtn() {
            var titleBar = document.getElementById('titleBar');
            var btnInHeader = document.querySelector('.header-nav .back-btn');
            var btnInTitleBar = titleBar ? titleBar.querySelector('.back-btn') : null;
            if (window.innerWidth <= 980 && titleBar) {
                if (btnInTitleBar) { /* already in titleBar */ return; }
                if (btnInHeader) {
                    restoreParent = btnInHeader.parentElement;
                    titleBar.insertBefore(btnInHeader, titleBar.firstChild);
                }
            } else {
                if (btnInTitleBar && restoreParent) {
                    restoreParent.appendChild(btnInTitleBar);
                    restoreParent = null;
                }
            }
        }
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() { setTimeout(moveBackBtn, 100); });
        } else {
            setTimeout(moveBackBtn, 100);
        }
        window.addEventListener('resize', moveBackBtn);
    })();
    </script>
</body>
</html>
